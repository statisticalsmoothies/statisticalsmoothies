[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Statistica Applicata alla Ricerca Biomedica - R",
    "section": "",
    "text": "Ciao a tutti!\nIn questa pagina web troverete le slides che sono state presentate durante il modulo di Statistica Descrittiva e Basi di R al corso di Statistica Applicata alla Ricerca Biomedica.\nOgni grafico e calcolo che trovate nelle slides è stato eseguito con R, trovate il codice, nascosto di default, nelle sottosezioni code. Alcuni pezzi di codice non sono stati trattati durante la lezione, ma potrebbe comunque tornarvi utile per il futuro.\nSe avete qualche domanda Vi ricordo che il canale Teams è ancora attivo. In alternativa, potete scrivere all’inidirizzo email:\n📧 giacomo.biganzoli@unimi.it"
  },
  {
    "objectID": "STAT DESCRITTIVA AP/Stat descrittiva.html",
    "href": "STAT DESCRITTIVA AP/Stat descrittiva.html",
    "title": "Statistica descrittiva e basi di R",
    "section": "",
    "text": "Dopo aver definito gli obiettivi dello studio si deve pianificare la raccolta delle variabili in modo tale da valutare correttamente il raggiungimento degli obiettivi e di caratterizzare il campione in studio.\nVariabili legate alla valutazione dello stato di salute del soggetto.\nSe è prevista una terapia: variabili legate alle modalità di somministrazione, eventuali modifiche di dosaggio, rilevazione di effetti collaterali, efficacia.\nVariabili che potenzialmente potrebbero influenzare lo stato di salute e/o l’efficacia della terapia.\nAltre variabili che caratterizzano il soggetto ‘’clinicamente’’ e ‘’demograficamente’’."
  },
  {
    "objectID": "STAT DESCRITTIVA AP/Stat descrittiva.html#la-rilevazione-delle-variabili",
    "href": "STAT DESCRITTIVA AP/Stat descrittiva.html#la-rilevazione-delle-variabili",
    "title": "Statistica descrittiva e basi di R",
    "section": "",
    "text": "Dopo aver definito gli obiettivi dello studio si deve pianificare la raccolta delle variabili in modo tale da valutare correttamente il raggiungimento degli obiettivi e di caratterizzare il campione in studio.\nVariabili legate alla valutazione dello stato di salute del soggetto.\nSe è prevista una terapia: variabili legate alle modalità di somministrazione, eventuali modifiche di dosaggio, rilevazione di effetti collaterali, efficacia.\nVariabili che potenzialmente potrebbero influenzare lo stato di salute e/o l’efficacia della terapia.\nAltre variabili che caratterizzano il soggetto ‘’clinicamente’’ e ‘’demograficamente’’."
  },
  {
    "objectID": "STAT DESCRITTIVA AP/Stat descrittiva.html#lo-studio-clinico",
    "href": "STAT DESCRITTIVA AP/Stat descrittiva.html#lo-studio-clinico",
    "title": "Statistica descrittiva e basi di R",
    "section": "Lo studio clinico",
    "text": "Lo studio clinico\nDati dall’articolo Associations of vitamin D status with markers of metabolic health: A community-based study in Shanghai, China\n\nVitamin D is a hormone that has long been related to bone metabolism. Recent evidence, however, has suggested links between lower vitamin D status and higher susceptibility for type 2 diabetes (T2DM) dyslipidemia, hypertension and obesity, all of which are major components of metabolic syndrome (MS).\nAims: To investigated the associations of vitamin D status (i.e., serum 25(OH)D concentration) with markers of metabolic health and metabolic syndrome (MS), as well as possible gender differences in these associations, with metabolic syndrome (MS) for a sample from Shanghai, China.\nMethods: Demographic and anthropometric data, as well as 25-hydroxyvitamin D (serum 25(OH)D), blood glucose, and lipid concentrations were obtained for 508 urban residents aged 19–70 years.\n\nQuali tra le seguenti caratteristiche sono associate alla presenza di sindrome metabolica?\n\nVitamin D status : (ng/mL)\nAge (years)\nGender (M/F)\nlifestyle: current smokers(yes/no); Alcohol use (yes/no); Sleep Duration (hours/day); Outdoor PA (hours/week)"
  },
  {
    "objectID": "STAT DESCRITTIVA AP/Stat descrittiva.html#tipologia-delle-variabili",
    "href": "STAT DESCRITTIVA AP/Stat descrittiva.html#tipologia-delle-variabili",
    "title": "Statistica descrittiva e basi di R",
    "section": "Tipologia delle variabili",
    "text": "Tipologia delle variabili\nLa modalità di rilevazione delle variabili indicate definisce la loro tipologia\n\nSindrome metabolica, Genere, abitudine al fumo, consumo abituale di alcool sono variabili che necessitano della definizione a priori di «categorie» entro le quali classificare la rilevazionead ogni soggetto nel momento della rilevazione è associata una ed una sola categoria\n\n\nGenere: M/F abitudine al fumo (si/no); consumo abituale di alcool (si/no); Presenza di sindrome metabolica (si/no).\n\n\nOre di sonno, ore di attività fisica, vitamina D Sono variabili numeriche che richiedono una «misura», una unità di misura e un livello di approssimazione:\n\n\nOre di sonno per notte: come calcolarle? Riportate con approssimazione a numeri interi o con decimali? E quanti? Ore di attività fisica all’aria aperta: come calcolarle? Riportate con approssimazione a numeri interi o con decimali? E quanti?"
  },
  {
    "objectID": "STAT DESCRITTIVA AP/Stat descrittiva.html#utilità-della-statistica-descrittiva",
    "href": "STAT DESCRITTIVA AP/Stat descrittiva.html#utilità-della-statistica-descrittiva",
    "title": "Statistica descrittiva e basi di R",
    "section": "Utilità della statistica descrittiva",
    "text": "Utilità della statistica descrittiva\n\nIdentificare le caratteristiche del campione di soggetti studiati.\nConfrontare le casistiche di diversi studi: se i risultati di diversi studi differiscono una delle cause potrebbe essere la differente composizione dei campioni per variabili clinico/biologiche rilevanti.\nIdentificare le caratteristiche delle distribuzioni delle variabili nella fase preliminare al test statistico.\nUna serie completa di dati non fornisce necessariamente informazioni facilmente interpretabili → trovare un compromesso tra sintesi ed informazioni rilevanti."
  },
  {
    "objectID": "STAT DESCRITTIVA AP/Stat descrittiva.html#utilità-della-statistica-descrittiva-1",
    "href": "STAT DESCRITTIVA AP/Stat descrittiva.html#utilità-della-statistica-descrittiva-1",
    "title": "Statistica descrittiva e basi di R",
    "section": "Utilità della statistica descrittiva",
    "text": "Utilità della statistica descrittiva\n1) fornire indicazioni sulla forma della distribuzione di frequenza delle variabili rilevate\n• Per le variabili categoriche e ordinali si può utilizzare una tabella di frequenza e/o una rappresentazione grafica.\n• Per le variabili numeriche discrete o continue si ricorre a rappresentazioni grafiche.\n2) sintetizzare la distribuzione mediante indici di tendenza centrale e dispersione (utilizzate nel caso di variabili su scala numerica).\n• Indici di tendenza centrale: un valore della variabile che dovrebbe essere ‘’rappresentativo’’ della distribuzione \n• Indici di dispersione: quanto sono dispersi i valori della variabile attorno alla tendenza centrale maggiore è la dispersione e minore è la ‘’rappresentatività’’ dell’indice di tendenza centrale.\n• La scelta degli indici di sintesi dipende dalla scala di misura della variabile e dalla forma della distribuzione di frequenza"
  },
  {
    "objectID": "STAT DESCRITTIVA AP/Stat descrittiva.html#table-1",
    "href": "STAT DESCRITTIVA AP/Stat descrittiva.html#table-1",
    "title": "Statistica descrittiva e basi di R",
    "section": "Table 1",
    "text": "Table 1\nLa prima parte di ogni articolo fornisce una sintesi dei dati per la descrizione della casistica \n\n\nCode\npkgs &lt;- c('tableone', 'dplyr', 'data.table', 'gt')\n\nlapply(pkgs, library, character.only = T)\n\ndata &lt;- read.csv2('/Users/giacomobiganzoli/Desktop/Statistica Applicata alla Ricerca Biomedica - R/STAT DESCRITTIVA AP/zhu.csv', na = '.')\n\n\n\n\nCode\ntbl1 &lt;- data%&gt;%dplyr::select(Gender, Age, Smoking, Alcohol, Sleep, OutdoorPA, MS)%&gt;%\n  mutate(across(c(Gender, Smoking, Alcohol, MS), as.factor))\n\ncolnames(tbl1) &lt;- c('Gender', 'Age', 'Current Smoker', 'Alcohol', 'Sleep Duration (hours/day)', 'Outdoor PA (hours/week)', 'Metabolic Syndrome')\n\ntbl1 &lt;- CreateTableOne(data = tbl1)%&gt;%print(., showAllLevels = T)\n\n\n                                        \n                                         level Overall      \n  n                                              546        \n  Gender (%)                             1       164 (32.3) \n                                         2       344 (67.7) \n  Age (mean (SD))                              50.15 (13.23)\n  Current Smoker (%)                     0       409 (85.6) \n                                         1        69 (14.4) \n  Alcohol (%)                            0       443 (92.7) \n                                         1        35 ( 7.3) \n  Sleep Duration (hours/day) (mean (SD))        7.03 (1.03) \n  Outdoor PA (hours/week) (mean (SD))           9.16 (4.78) \n  Metabolic Syndrome (%)                 0       367 (76.3) \n                                         1       114 (23.7) \n\n\nPer le variabili categoriche il numero di soggetti in ogni categoria con le %\nPer le variabili numeriche la sintesi è fornita come media +/- deviazione standard\n\nCome si interpreta questo dato? Se la distribuzione è simmetrica (e bene approssimata da una Gaussiana) il 68% dei valori è compreso nell’intervallo media +/- deviazione standard\n\nMa se la variabile non ha distribuzione simmetrica e/o non è bene approssimata da una Gaussiana questa proprietà non vale. Perché scrivere allora media +/- deviazione standard?"
  },
  {
    "objectID": "STAT DESCRITTIVA AP/Stat descrittiva.html#indici-di-tendenza-centrale",
    "href": "STAT DESCRITTIVA AP/Stat descrittiva.html#indici-di-tendenza-centrale",
    "title": "Statistica descrittiva e basi di R",
    "section": "Indici di tendenza centrale",
    "text": "Indici di tendenza centrale\nLa media aritmetica: è sempre un buon indice di tendenza centrale?\nMedia aritmetica (scala numerica continua, numerica discreta): è calcolata sommando tutte le osservazioni e dividendo per il totale.\nutilizzando una notazione sintetica: per N osservazioni convalori \\(X_1, X_2,..,X_N, \\ media = \\frac{(X_1+X_2+...X_N)}{N} = \\sum_{i}^{N}\\frac{X_i}{N}\\)\nÈ la misura più utilizzata ma è influenzata dai valori estremi: quei valori della distribuzione che sono ‘’distanti’’ dagli altri in quanto sono decisamente maggiori (spostano la media verso valori più elevati) o decisamente minori (spostano la media verso valori più bassi).\n⚠️ Quando le distribuzioni non sono simmetriche la media non è un indice appropriato di tendenza centrale.\n\n\nCode\n# Carica le librerie necessarie\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# Numero di campioni per ogni distribuzione\nn_samples &lt;- 1000000\n\n# Parametri per la distribuzione Beta asimmetrica a destra (alpha &lt; beta)\nalpha_destra &lt;- 2\nbeta_destra &lt;- 5\n\n# Parametri per la distribuzione Beta asimmetrica a sinistra (alpha &gt; beta)\nalpha_sinistra &lt;- 5\nbeta_sinistra &lt;- 2\n\n# Genera campioni Beta asimmetrici\nbeta_asimmetrica_destra &lt;- rbeta(n_samples, shape1 = alpha_destra, shape2 = beta_destra)\nbeta_asimmetrica_sinistra &lt;- rbeta(n_samples, shape1 = alpha_sinistra, shape2 = beta_sinistra)\n\n# Crea un data frame per entrambe le distribuzioni\ndati &lt;- data.frame(\n  valore = c(beta_asimmetrica_destra, beta_asimmetrica_sinistra, rnorm(n_samples, 0.5, .5)),\n  tipo = rep(c(\"Asimmetrica a Destra\", \"Asimmetrica a Sinistra\", 'Normale'), each = n_samples)\n)\n\n# Traccia i grafici delle distribuzioni\nggplot(dati, aes(x = valore, fill = tipo)) +\n  geom_density(alpha = 0.6) +\n  facet_wrap(~tipo, scales = \"free\") +\n  labs(title = \"Distribuzioni Beta Asimmetriche a Destra e a Sinistra\",\n       x = \"Valore\", y = \"Densità\") +\n  theme_minimal()+\n  theme(legend.position = 'none')"
  },
  {
    "objectID": "STAT DESCRITTIVA AP/Stat descrittiva.html#le-misure-di-dispersione-attorno-alla-media",
    "href": "STAT DESCRITTIVA AP/Stat descrittiva.html#le-misure-di-dispersione-attorno-alla-media",
    "title": "Statistica descrittiva e basi di R",
    "section": "Le misure di dispersione attorno alla media",
    "text": "Le misure di dispersione attorno alla media\nDevianza, Varianza e deviazione standard\n\nutilizzano come misura di distanza dalla media lo scarto quadratico\nconsiderando le osservazioni \\(x_1,x_2...x_n\\) , la cui media è \\(\\overline{x}\\)\nLa devianza è:: \\((x_1-\\overline{x})^2 + (x_2-\\overline{x})^2 + (x_3-\\overline{x})^2+...+(x_n-\\overline{x})^2 = \\sum_i^N(x_i-\\overline{x})^2\\)\nLa varianza è ottenuta dividendo la devianza per N-1, ovvero i ‘gradi di libertà’: \\(s^2 = \\frac{(x_1-\\overline{x})^2 + (x_2-\\overline{x})^2 + (x_3-\\overline{x})^2+...+(x_n-\\overline{x})^2 }{N-1}= \\frac{\\sum_i^N(x_i-\\overline{x})^2}{N-1}\\)\nvarianza: l’unità di misura coincide con quella delle osservazioni (al quadrato), quindi non bene interpretabile, per questo si usa la deviazione standard: \\(s = \\sqrt{s^2}\\)\n\nQuando le distribuzioni non sono simmetriche la varianza non è un indice appropriato di tendenza centrale. Come la media è influenzata dai valori estemi, anche la deviazione standard è influenzata dai valori estremi (ancora più della media). In caso di asimmetria accentuata la deviazione standard è più elevata della media → Media +/- deviazione standard non ha senso dal momento che media – deviazione standard è un numero &lt; 0!"
  },
  {
    "objectID": "STAT DESCRITTIVA AP/Stat descrittiva.html#per-valutare-se-le-distribuzioni-sono-asimmeriche-è-necessario-analizzarle-ad-esempio-rappresentarle-graficamente",
    "href": "STAT DESCRITTIVA AP/Stat descrittiva.html#per-valutare-se-le-distribuzioni-sono-asimmeriche-è-necessario-analizzarle-ad-esempio-rappresentarle-graficamente",
    "title": "Statistica descrittiva e basi di R",
    "section": "Per valutare se le distribuzioni sono asimmeriche è necessario analizzarle, ad esempio rappresentarle graficamente",
    "text": "Per valutare se le distribuzioni sono asimmeriche è necessario analizzarle, ad esempio rappresentarle graficamente\nEtà: variabile numerica su scala discreta: infatti è misurata in «anni compiuti». Non sono possibili valori con cifre decimali ma solo interi 18,19,20,21,…..\n\n\nCode\nplot(table(data$Age), ylab  = '# times', xlab = 'Age (yrs)')\n\n\n\n\n\nOre di sonno variabile numerica su scala discreta : infatti la variabile è riportata in ore e quindi sono possibili solo valori interi, 5,6,7,8,9\n\n\nCode\nplot(table(data$Sleep), ylab  = '# times', xlab = 'Sleep (hours/day)')\n\n\n\n\n\nOre di attività fisica per settimana : è calcolata come media e quindi «in teoria» potrebbero assumere tutti i possibili valori e considerare la misura su scala continua ma in realtà sono presenti solo 4 possibili valori 1.8, 3.5, 7 e 14 quindi trattata come variabili numerica discreta.\n\n\nCode\nplot(table(data$Sleep), ylab  = '# times', xlab = 'Sleep (hours/day)')\n\n\n\n\n\nVitamina D: variabile numerica continua (assume valori decimali)\n\n\nCode\nplot(table(data$VD), ylab  = '# times', xlab = 'vitD (u/L)')\n\n\n\n\n\nCode\nhist(data$VD, breaks = 30)\n\n\n\n\n\nCode\nfor(b in seq(10,110,20)){\n   hist(data$VD, breaks = b, main = paste('# bins', b), \n        xlab = 'vitD (u/L)')\n}"
  },
  {
    "objectID": "STAT DESCRITTIVA AP/Stat descrittiva.html#altre-misure-di-tendenza-centrale",
    "href": "STAT DESCRITTIVA AP/Stat descrittiva.html#altre-misure-di-tendenza-centrale",
    "title": "Statistica descrittiva e basi di R",
    "section": "Altre misure di tendenza centrale",
    "text": "Altre misure di tendenza centrale\nLa media non è l’unico indice di tendenza centra le che si può considerare. In presenza di valori estremi nella distribuzione è preferibile ricorrere adun indice di tendenza centrale che sia meno influenzato dalla presenzadi valori estremi rispetto alla media (più robusto) in presenza di distribuzioni asimmetriche è preferibili ricorrere adun indice di tendenza centrale che meglio rappresenti il «centro» delladistribuzione.\nUn indice che ha tale caratteristica è la mediana"
  },
  {
    "objectID": "STAT DESCRITTIVA AP/Stat descrittiva.html#altre-misure-di-tendenza-centrale-1",
    "href": "STAT DESCRITTIVA AP/Stat descrittiva.html#altre-misure-di-tendenza-centrale-1",
    "title": "Statistica descrittiva e basi di R",
    "section": "Altre misure di tendenza centrale",
    "text": "Altre misure di tendenza centrale\nLa mediana (m) di un insieme finito di osservazioni è quel valore della variabile che divide l’insieme ordinato delle osservazioni in due parti in modo tale che il numero delle osservazioni che precede la mediana sia uguale al numero di osservazioni successive alla mediana. Una percentuale ≤ al 50% delle osservazioni ha valore della variabile minore della mediana e una percentuale ≤ al 50% ha valore della variabile maggiore della mediana\nper calcolarla occorre:\n\nordinare le N osservazioni in senso crescente:\n\n\nCode\nage2 &lt;- data$Age[!is.na(data$Age)]\nage2 &lt;- sort(age2)\n\n\nidentificare la posizione della mediana:\n\nse N è dispari la mediana si trova in corrispondenza della osservazione xq dove q=(N + 1)/2 → m\nse N è pari la mediana si trova al centro tra xq ed xq+1 dove q=N/2 e q+1=(N/2) + 1\n\n\n\nCode\nlength(age2) # PARI\n\n\n[1] 476\n\n\nCode\nq = length(age2)/2\nq\n\n\n[1] 238\n\n\nCode\nq1 = (length(age2)/2) +1\nq1\n\n\n[1] 239\n\n\nCalcolare la mediana m = 0.5 ∗ (xq+1 + xq)\n\n\nCode\nm = 0.5 * (age2[q] + age2[q1])\nm\n\n\n[1] 53\n\n\n\nCon R la funzione ‘median’ velocizza notevolmente il processo\n\n\nCode\nmedian(data$Age, na.rm = TRUE)\n\n\n[1] 53\n\n\nCode\nplot(table(data$Age), ylab = 'Frequency', xlab = 'Age (yrs)', main = 'In rosso la mediana della distribuzione')\nabline(v = as.character(median( data$Age, na.rm = T)), lwd = 2, col = 'red')\n\n\n\n\n\nCode\nplot(table(data$Age), ylab = 'Frequency', xlab = 'Age (yrs)', main = 'In rosso la mediana della distribuzione \\n in blu la media della distribiuzione') \nabline(v = as.character(median( data$Age, na.rm = T)), lwd = 2, col = 'red')\nabline(v = as.character(mean( data$Age, na.rm = T)), lwd = 2, col = 'blue')"
  },
  {
    "objectID": "STAT DESCRITTIVA AP/Stat descrittiva.html#sintesi-numerica-dei-dati-le-misure-di-dispersione-attorno-alla-mediana-campo-di-variazione-interquartile",
    "href": "STAT DESCRITTIVA AP/Stat descrittiva.html#sintesi-numerica-dei-dati-le-misure-di-dispersione-attorno-alla-mediana-campo-di-variazione-interquartile",
    "title": "Statistica descrittiva e basi di R",
    "section": "Sintesi numerica dei dati: le misure di dispersione attorno alla mediana campo di variazione interquartile",
    "text": "Sintesi numerica dei dati: le misure di dispersione attorno alla mediana campo di variazione interquartile\n• differenza tra il 3° quartile (Q3) e il 1° quartile (Q1).\nIn una situazione «ideale»\n\nQ3 è il valore che suddivide la distribuzione in modo tale che il 75% delle osservazioni è &lt; di Q3 e il 25% è maggiore di Q3\nQ1 è il valore che suddivide la distribuzione in modo tale che il 25% delle osservazioni è &lt; di Q1 e il 75% delle osservazioni è &gt; Q1\nTra Q3 e Q1 è compresa una percentuale pari al 50% delle osservazioni\n\n\n\nCode\nq1 = quantile(data$VD, probs = c(.25), na.rm = T)\nq1\n\n\n    25% \n25.7625 \n\n\nCode\nq3 = quantile(data$VD, probs = c(.75), na.rm = T)\nq3\n\n\n    75% \n34.0125 \n\n\nCode\nhist(data$VD, breaks = 30, axes = F)\naxis(1, at = round(seq(min(data$VD, na.rm = T), max(data$VD, na.rm = T), length.out = 10),2))\naxis(2)\nabline(v = q1, lwd =2, col = 'red')\nabline(v = q3, lwd =2, col = 'blue')\nabline(v = median(data$VD, na.rm = T), lwd =2, col = 'purple')"
  },
  {
    "objectID": "STAT DESCRITTIVA AP/Stat descrittiva.html#mediana-e-quartili-per-descrivere-graficamente-le-distribuzioni-il-box-plot",
    "href": "STAT DESCRITTIVA AP/Stat descrittiva.html#mediana-e-quartili-per-descrivere-graficamente-le-distribuzioni-il-box-plot",
    "title": "Statistica descrittiva e basi di R",
    "section": "Mediana e quartili per descrivere graficamente le distribuzioni: il ‘’box-plot’’",
    "text": "Mediana e quartili per descrivere graficamente le distribuzioni: il ‘’box-plot’’\n\n\nCode\nboxplot(data$VD, ylab = 'Vitamin D (U/L)')\n\n\n\n\n\n• è costruito dalle seguenti caratteristiche della distribuzione: il minimo, Q1, mediana, Q3, il massimo\n• la riga all’interno del box è la mediana.\n• i lati del box sono Q1 (basso) e Q3 (alto);\n• l’altezza del box è il range interquartile (Q3-Q1)\n• le linee che si estendono oltre il box (wiskers) contengono il 25% delle osservazioni e sono calcolate come segue: wb: Q1-1.5(Q3-Q1) e wa: Q3+1.5(Q3-Q1)se wb è &lt; del minimo dei dati si pone wb = al minimo dei datise wa è &gt; del massimo dei dati si pone wa = al massimo dei dati\n• i valori che si estendono oltre gli wiskers sono definiti «outliers»\nMa che utilità può avere il box-plot?\n\nevidenziare osservazioni outliers: sono dati «atipici» rispetto agli altri quindi è opportuno controllarli, potrebbero essere errori di rilevazione oppure soggetti con particolari condizioni che devono essere valutati a parte\nevidenziare se la distribuzione è simmetrica o asimmetrica: se la distribuzione è asimmetrica non è opportuno usare la media come indice di tendenza centrale, invece la mediana è comunque corretta!\nquando si confrontano due distribuzioni fornisce una indicazione sulla differenza di tendenza centrale, di dispersione e sul grado di sovrapposizione dei valori della variabile nelle due distribuzioni\n\n\nCode\ndata$MS &lt;- as.character(data$MS)\n\nboxplot(data$VD~data$MS, ylab = 'Vitamin D (U/L)', xlab = 'MetS')\n\n\n\n\n\nCode\nboxplot(data$Age~data$MS, ylab = 'Age (yrs)', xlab = 'MetS')"
  },
  {
    "objectID": "STAT DESCRITTIVA AP/Stat descrittiva.html#le-funzioni-di-distribuzione-cumulata-per-il-confronto-tra-distribuzioni",
    "href": "STAT DESCRITTIVA AP/Stat descrittiva.html#le-funzioni-di-distribuzione-cumulata-per-il-confronto-tra-distribuzioni",
    "title": "Statistica descrittiva e basi di R",
    "section": "Le funzioni di distribuzione cumulata per il confronto tra distribuzioni",
    "text": "Le funzioni di distribuzione cumulata per il confronto tra distribuzioni\nLa distribuzione cumulata: per ogni valore X di vit.D è la frequenza di soggetti che hanno valori di vit. D &lt;= X.\n\n\nCode\necdfDIBIC &lt;- function(x){\n  \n  x &lt;- as.data.frame(table(x))\n  x$cum.freq &lt;- cumsum(x$Freq)\n  x$perc &lt;- round(x$cum.freq/sum(x$Freq),2)\n  colnames(x)[1] &lt;- 'val'\n  x$val &lt;- as.numeric(as.character(x$val))\n  \n  x\n  \n}\n\n\necdf.age.si &lt;- ecdfDIBIC(data$Age[data$MS == 1])\necdf.age.no &lt;- ecdfDIBIC(data$Age[data$MS == 0])\n\n\nplot(ecdf.age.si$val, ecdf.age.si$perc, type = 's', lwd = 2, main = 'ECDFs of Age', \n     xlab = 'Age (yrs)',ylab = 'P(X &lt;=x)')\nlines(ecdf.age.no$val, ecdf.age.no$perc, type = 's', col = 'purple', lwd = 2)\nabline(h = c(.25, .5, .75), lty = 3)\nlegend('bottomright', c('MetS', 'No MetS'), lty = 1, col = c('black', 'purple'), \n       lwd = 2)\n\n\n\n\n\nCode\nfind.values &lt;- function(ecdf, p){\n  \n max(ecdf$val[ecdf$perc &lt;= p])\n  \n}\n\nfind.values(ecdf = ecdf.age.si, p = .75)\n\n\n[1] 63\n\n\n\n\nCode\nall &lt;- ecdfDIBIC(data$VD)\nms.si &lt;- ecdfDIBIC(data$VD[data$MS == 1])\nms.no &lt;- ecdfDIBIC(data$VD[data$MS == 0])\n\n\nplot(all$val, all$perc, type = 's', xlab = 'Vitamin D (U/L)', ylab = 'P(X &lt;= x)', lwd = 2, main = 'ECDFs of Vitamin D', axes = F)\nlines(ms.si$val, ms.si$perc, type = 's', xlab = 'Vitamin D (U/L)', ylab = '%', lwd = 2, col = 2)\nlines(ms.no$val, ms.no$perc, type = 's', xlab = 'Vitamin D (U/L)', ylab = '%', lwd = 2, col = 3)\nabline(h = c(.25, .5, .75), lty = 3)\naxis(1, at = seq(5,45,1))\naxis(2, at = seq(0,1,.05))\nlegend('bottomright', c('All', 'MetS', 'No Mets'),lty = 1, col = c(1,2,3), lwd = 2 )\n\n\n\n\n\nCode\npar(mfrow = c(1,3))\nhist(data$VD[data$MS == 1], breaks  = 30, main = 'MetS', xlab = 'Vitamin D (U/L)', axes = F)\naxis(1, at = seq(5,50,5))\naxis(2)\n\nhist(data$VD[data$MS == 0], breaks = 30, main = 'No MetS', xlab = 'Vitamin D (U/L)', axes = F)\naxis(1, at = seq(5,50,5))\naxis(2)\n\nhist(data$VD, breaks = 30, main = 'All', xlab = 'Vitamin D (U/L)', axes = F)\naxis(1, at = seq(5,50,5))\naxis(2)\n\n\n\n\n\nGrafici vietati:\nhttps://biostat.app.vumc.org/wiki/pub/Main/TatsukiRcode/Poster3.pdf"
  },
  {
    "objectID": "STAT DESCRITTIVA AP/Stat descrittiva.html#installazione-di-r",
    "href": "STAT DESCRITTIVA AP/Stat descrittiva.html#installazione-di-r",
    "title": "Statistica descrittiva e basi di R",
    "section": "Installazione di R",
    "text": "Installazione di R\nR è un linguaggio di programmazione open source ampiamente utilizzato per l’analisi statistica e la creazione di grafici. È stato creato da Ross Ihaka e Robert Gentleman e la sua prima versione è stata rilasciata nel 1995.\nR è diventato uno degli strumenti più popolari tra i data scientist e gli analisti dei dati, grazie alla sua vasta libreria di pacchetti che consentono di manipolare, visualizzare e analizzare grandi quantità di dati. Inoltre, la sua sintassi intuitiva e flessibile lo rende facile da imparare anche per coloro che non hanno una formazione di programmazione formale.\nOltre alla sua capacità di analisi statistica, R è anche utilizzato in diverse applicazioni come la creazione di dashboard interattivi, la creazione di report automatizzati e la costruzione di modelli di apprendimento automatico.\nInoltre, R è supportato da una vasta comunità di sviluppatori e utenti che contribuiscono alla sua crescita, alla sua manutenzione e alla creazione di nuovi pacchetti e funzionalità. Grazie a tutto questo, R è diventato uno strumento essenziale per chiunque lavori con i dati.\n\nSe non avete ancora installato R\nSe non avete ancora installato R, potete seguire questi semplici step per poterlo installare velocemente:\nCliccate su questo link\nAccederete ad una pagina come questa:\n\n\nUtilizzi Windows?\n\n\n\nAccedi al link cerchiato in rosso\n\n\n\n\n\nAccedi al link cerchiato in rosso\n\n\n\n\n\nAccedi al link cerchiato in rosso. Il download del file .exe dovrebbe partire automaticamente. Una volta scaricato, apri il file, per iniziare ad installare R sul tuo PC\n\n\n\n\nUtilizzi macOS?\n\n\n\nAccedi al link cerchiato in rosso.\n\n\n\n\n\nSe hai un Mac con processore M1 o M2 accedi al link cerchiato in rosso. Altrimenti, accedi al link cerchiato in blu\n\n\n\n\n\nAvete installato R\nUna volta installato correttamente R, apritelo. Vi si aprirà una finestra, definita console, di questo tipo:\n\nProvate a digitare nella console, dopo il simbolo ‘&gt;’, questo codice:\n\n\nCode\nplot(c(1,2,3,4))\n\n\n\n\n\nSe vi appare un grafico come quello sopra riportato, allora avete installato R in modo corretto e siete pronti per poterlo utilizzare in classe! 🤘"
  },
  {
    "objectID": "STAT DESCRITTIVA AP/Stat descrittiva.html#installare-rstudio",
    "href": "STAT DESCRITTIVA AP/Stat descrittiva.html#installare-rstudio",
    "title": "Statistica descrittiva e basi di R",
    "section": "Installare RStudio",
    "text": "Installare RStudio\nUn altro programma molto utile per interfacciarsi con R è RStudio.\n\nRStudio is an integrated development environment for R, a programming language for statistical computing and graphics. It is available in two formats: RStudio Desktop is a regular desktop application while RStudio Server runs on a remote server and allows accessing RStudio using a web browser.\n\nPer installare R Studio in modo semplice cliccate questo link e seguite le istruzioni che sono descritte nella pagina.\n❗ Se avete già installato R, non dovete far altro che seguire lo step 2 ed installe RStudio.\n\nUna volta scaricato ed installato, se aprirete RStudio accederete ad una pagina di questo tipo:"
  },
  {
    "objectID": "STAT DESCRITTIVA AP/Stat descrittiva.html#non-esitare-a-contattarmi-per-evenutali-domande-eo-problemi-di-installazione",
    "href": "STAT DESCRITTIVA AP/Stat descrittiva.html#non-esitare-a-contattarmi-per-evenutali-domande-eo-problemi-di-installazione",
    "title": "Statistica descrittiva e basi di R",
    "section": "📧 Non esitare a contattarmi per evenutali domande e/o problemi di installazione!📧",
    "text": "📧 Non esitare a contattarmi per evenutali domande e/o problemi di installazione!📧\nGiacomo: giacomo.biganzoli@unimi.it"
  },
  {
    "objectID": "STAT DESCRITTIVA AP/Stat descrittiva.html#introduzione-al-linguaggio-di-r",
    "href": "STAT DESCRITTIVA AP/Stat descrittiva.html#introduzione-al-linguaggio-di-r",
    "title": "Statistica descrittiva e basi di R",
    "section": "Introduzione al linguaggio di R",
    "text": "Introduzione al linguaggio di R\n\n\nScript: oggetti e funzioni\nGeneralmente, per poter importare ed analizzare i dati che avete accuratamente raccolto, scriverete un ‘programma’ in uno script. Un programma non è altro che un elenco di oggetti e funzioni che devono essere eseguite per ottenere i risultati desiderati. Lo script viene successivamente eseguito ed interpretato da R in modo tale da ottenere i risultati richiesti.\nI principali tipi di oggetti in R sono:\n\nstringhe di caratteri\nvettori\nmatrici\nliste\ndata.frames\n\nL’oggetto che più utilizzeremo sarà il data.frame. Pensate al data.frame come la forma di dati tabulati che trovereste se apriste un comunissimo file .xlsx o .csv in Excel.\nIn R, le funzioni servono a ‘trasformare’ un oggetto in un altro oggetto all’interno dell’ambiente R. R è ricco di funzioni di base e funzioni scritte da esperti per poter fare una miriade di cose. Inolte, in R è possibile scrivere le proprie funzioni (solo per utilizzatori avanzati!).\nAd esempio, digitando nello script il seguente codice, assegno ad un oggetto che chiamo boomer la stringa di caratteri ‘I am smiling because i am using R’. Se successivamente applico la funzione print() all’oggetto boomer, R stampa cosa è assegnato a boomer.\n\n\nCode\nboomer &lt;- \"I am smiling because i am using R\" # assegno all'oggetto boomer una stringa di caratteri\n\nprint(boomer) # eseguo il print dell'oggetto per vedere cosa riporta\n\n\n[1] \"I am smiling because i am using R\"\n\n\nSe invece consideriamo un vettore, inteso come una sequenza di valori numerici o di caratteri, possono essere utili altre funzioni. Ad esempio, pensate di intervistare cinque vostri colleghi per chiedere loro quante visite ospedaliere hanno eseguito negli ultimi 5 anni. I cinque colleghi vi rispondono nel seguente modo:\n\n5 visite\n3 visite\n2 visite\n1 visita\n0 visite\n\nAllora possiamo assegnare all’oggetto visite un vettore definito in questo modo:\n\n\nCode\nvisite = c(5,3,2,1,0) # genero un nuovo vettore 'visite'\nprint(visite) # guardo cosa contiene il vettore 'visite'\n\n\n[1] 5 3 2 1 0\n\n\nSe ad esempio sono interessato al totale delle visite dei cinque colleghi intervistati, posso applicare al vettore visite la funzione sum()\n\n\nCode\nsum(visite) # applico la funzione sum() per calcolare il totale delle visite dei cinque colleghi\n\n\n[1] 11\n\n\nSe invece fossi interessato alla media del numero di visite dei cinque colleghi intervistati, posso applicare a visite la funzione mean()\n\n\nCode\nmean(visite) # applico la funzione mean() per calcolare il totale delle visite dei cinque colleghi\n\n\n[1] 2.2\n\n\n❗ questi ultimi due calcoli (totale con la funzione sum() e media con la funzione mean() ) non sono stati assegnati ad alcun oggetto. Se nella nostra sessione di analisi volessimo utilizzare nuovamente la media e il totale delle visite, possiamo assegnare a due nuovi oggetti, rispettivamente mean_visite e tot_visite, il calcolo della media e del totale del numero di visite.\n\n\nCode\nmean_visite &lt;- mean(visite) # assegno all'oggetto mean_visite il calcolo della media del vettore visite\ntot_visite = sum(visite) # assegno all'oggetto tot_visite il calcolo del totale del vettore visite\n\nprint(mean_visite)\n\n\n[1] 2.2\n\n\nCode\nprint(tot_visite)\n\n\n[1] 11\n\n\nSe fossi interessato, per qualche motivo particolare, a calcolare la differenza tra tot_visite e mean_visite, allora, semplicemente, potrei digitare il codice:\n\n\nCode\ntot_visite - mean_visite # faccio la differenza tra totale e media\n\n\n[1] 8.8\n\n\ne assegnare a diff_visite questo calcolo:\n\n\nCode\ndiff_visite = tot_visite - mean_visite # assego ad un oggetto diff_visite la differenza tra totale e media. \nprint(diff_visite)\n\n\n[1] 8.8\n\n\n⚠️ Probabilmente avrete notato che per assegnare vettori o stringhe di caratteri ad oggetti utilizzo indistintamente il simbolo ‘=’ o il simbolo ‘&lt;-’. Nonostante l’utilizzo di uno o dell’altro simbolo abbia generato grande dibattito fra i vari R nerds nel mondo:\n\nNoi d’ora in poi, per comodità, utilizzeremo il simbolo ‘=’.\n⚠️ Inoltre, avrete notato che dopo ogni codice scritto, segue quasi sempre un commento al codice preceduto da un #. E buona norma commentare il codice scritto. Questo perché, se in futuro vorrete riprendere il codice per le analisi oppure inviarlo ad un collega per farlgielo utilizzare, saprete perché era stata utilizzata tale funzione, o perché era stato creato tale oggetto etc etc…\n\nbonus!\nIn R le funzioni, come in matematica, si possono concatenare! Questo vuol dire che se volessi applicare ad uno stesso oggetto (A) più di una funzione (f() e g() ), al posto di creare e salvare due o più oggetti per applicare in sequenza le funzioni, potrei concatenarle in questo modo:\ng( f(A) )\nEsempio:\nSupponiamo di aver misurato e raccolto i dati della massa corporea in kg di 5 soggetti in un vettore weight così definito c(64.679, 78.943, 60.321, 90.453, 112.765). Se volessi arrotondare i valori della massa corporea alla sola cifra intera (considerando solo i kg) e poi volessi calcolare la media dei valori, allora potrei fare in questo modo:\n\n\nCode\nweight = c(64.679, 78.943, 60.321, 90.453, 112.765) # assegno al vettore weight i valori di massa corporea\n\nmean(round(weight)) # arrotondo a numeri interi e poi eseguo la media \n\n\n[1] 81.4\n\n\n❗ L’ordine in cui applichiamo le funzioni conta. Se invertissimo l’ordine delle funzioni, il valore ottenuto è diverso:\n\n\nCode\nround(mean(weight)) # eseguo la media e poi arrotondo a numeri interi \n\n\n[1] 81\n\n\n\n\nAlcune funzioni essenziali:\nLe funzioni help(), ls(), install.packages() e library(), sono quattro funzioni essenziali. La prima serve per interrogare R sul tipo di funzioni che stiamo utilizzando. Ad esempio, se trovo la funzione mean() ma non riesco a capire cosa voglia dire e/o cosa serva, allora posso utilizzare la funzione help() al cui interno digito il nome della funzione a me sconosciuta (senza le due parentesi).\n\n\nCode\nhelp(\"mean\")\n\n\nLa funzione ls() invece mi serve per vedere quali sono gli oggetti che ho salvato nella workspace di R. Sopratutto in caso di codici molto lunghi, non possiamo memorizzare tutto quello che abbiamo creato!\nSe utilizzo la funzione ls(), R mi stamperà tutti gli oggetti salvati nella workspace\n\n\nCode\nls()\n\n\n [1] \"age2\"                      \"all\"                      \n [3] \"alpha_destra\"              \"alpha_sinistra\"           \n [5] \"b\"                         \"beta_asimmetrica_destra\"  \n [7] \"beta_asimmetrica_sinistra\" \"beta_destra\"              \n [9] \"beta_sinistra\"             \"boomer\"                   \n[11] \"data\"                      \"dati\"                     \n[13] \"diff_visite\"               \"ecdf.age.no\"              \n[15] \"ecdf.age.si\"               \"ecdfDIBIC\"                \n[17] \"find.values\"               \"has_annotations\"          \n[19] \"m\"                         \"mean_visite\"              \n[21] \"ms.no\"                     \"ms.si\"                    \n[23] \"n_samples\"                 \"pkgs\"                     \n[25] \"q\"                         \"q1\"                       \n[27] \"q3\"                        \"tbl1\"                     \n[29] \"tot_visite\"                \"visite\"                   \n[31] \"weight\"                   \n\n\nLa funzione install.packages() mi permette di installare pacchetti di funzioni in aggiunta a quelli pre-installati, così da poter utilizzare qualsiasi tipo di funzione non di base. La funzione library() invece mi serve per caricare i nuovi pacchetti installati.\nAd esempio, voglio installare il pacchetto dplyr e caricarlo nella workspace.\n\n\nCode\n#install.packages('dplyr') #installo il pacchetto dplyr\nlibrary(dplyr) # carico il pacchetto dplyr nella workspace cosi che è pronto per poter essere utilizzato\n\n\nIn questa piccola sezione, vi abbiamo mostrato poche delle migliaia funzioni disponibili in R. Nel corso della Sessione 1, e nella prossima sessione, avremo modo di indicarvi ulteriori funzioni utili per l’analisi dei dati. Lungi da noi riuscire ad esaurire in poche ore tutte le funzioni disponibili per poter analizzare i vostri dati. Ma uno strumento fondamentale che potete utilizzare gratuitamente sul web è:\n\nUn website dove vengono raccolte domande e risposte degli users di R (e non solo), cui potete fare riferimento qualora aveste dei problemi con il vostro codice, ma sopratutto voleste informazioni sull’esistenza di una data funzione. Molto spesso, le domande e/o i problemi sopraggiunti, sono già capitati ad altri users come voi!"
  },
  {
    "objectID": "STAT DESCRITTIVA AP/Stat descrittiva.html#caricare-i-dati-su-r",
    "href": "STAT DESCRITTIVA AP/Stat descrittiva.html#caricare-i-dati-su-r",
    "title": "Statistica descrittiva e basi di R",
    "section": "Caricare i dati su R",
    "text": "Caricare i dati su R\nOra passiamo all’aspetto più importante e per alcuni il più tedioso: caricare in maniera pulita e veloce i dati che avete raccolto. Da REDCap avrete modo di scaricare i dati in forma tabulata in formato .csv, .xls, .xlsx, o txt. Il consiglio che vi diamo è di preferire il formato .txt per leggere i dati.\nCome potete immaginare, in R esistono numerose funzioni per leggere i dati in ogni formato. Tra queste si annovera una funzione principale che è quella universalmente più performante, proveniente dal pacchetto utils, chiamata read.table(). La funzione legge un file in formato tabulato e ne crea un frame di dati, con i casi corrispondenti alle righe e le variabili alle colonne del file. La funzione ha i seguenti parametri:\n\nLa compilazione di questi parametri è obbligatoria, di altri è solo facoltativa.\n\n\n\n\n\n\n\nParametro\nUtilizzo\n\n\n\n\nfile\nIl percorso e il nome del file da cui leggere i dati. Ogni riga della tabella appare come una riga del file.\n\n\nheader\nun valore logico che indica se il file contiene i nomi delle variabili come prima riga. Se manca, il valore è determinato dal formato del file: header è impostato su TRUE se e solo se la prima riga contiene una colonna in meno rispetto al numero di colonne per le altre righe.\n\n\nsep\nIl carattere di separazione delle colonne. I valori su ogni riga del file sono separati da questo carattere. Se sep = “” (l’impostazione predefinita per read.table) il separatore è uno “spazio bianco”, cioè uno o più spazi, tabulazioni, newline o ritorni a capo.\n\n\ndec\nil carattere utilizzato nel file per i punti decimali.\n\n\nrow.names\nun vettore di nomi di righe. Può essere un vettore con i nomi effettivi delle righe, oppure un numero singolo con la colonna della tabella che contiene i nomi delle righe, o una stringa di caratteri con il nome della colonna della tabella che contiene i nomi delle righe.\nSe esiste un’intestazione e la prima riga contiene un campo in meno rispetto al numero di colonne, per i nomi delle righe viene utilizzata la prima colonna dell’input. Altrimenti, se row.names manca, le righe vengono numerate.\n\n\ncol.names\nun vettore di nomi opzionali per le variabili. L’impostazione predefinita prevede l’uso di “V” seguito dal numero della colonna.\n\n\nskip\nil numero di righe da ‘saltare’ prima che il programma legga i dati\n\n\ncolClasses\ncarattere. Un vettore di classi da assumere per le colonne. Se non ha nome, viene riciclato come necessario. Se con nome, i nomi vengono abbinati e i valori non specificati vengono considerati NA.\n\n\n\nLa prima cosa da controllare sarà il path del file in cui è salvato il vostro file .txt. Questo perché dovrete specificarlo nel parametro file. Su Windows e MacOS le cose funzionano differentemente.\nSu Windows il path va specificato in questo modo:\n\nC:\\\\path\\\\to\\\\directory\\\\file.txt\n\nSu MacOS il path va specificato in questo modo:\n\n/path/to/directory/file.txt\n\nAttualmente su questo computer sto utilizzando MacOS, per questo caricherò i dati con i seguenti comandi:\n\ncreo un oggetto path di tipo stringa di caratteri in cui viene specificato il percorso dove si trova il file da caricare.\nUso la funzione read.table() dove:\n\nal parametro file è assegnato l’oggetto path;\nal parametro header è assegnato il valore TRUE, in modo tale da leggere la prima riga del file come se fosse l’intestazione delle variabili;\nal parametro sep è assegnato il valore ‘\\t’ .\n\n\n\n\nCode\nlibrary(dplyr)\npath = '/Users/giacomobiganzoli/Desktop/Statistica Applicata alla Ricerca Biomedica - R/STAT DESCRITTIVA AP/datiesercitazione.txt' # genero un oggetto che descrive il percorso dove è situato il file\ndata = read.table(path, header = TRUE, sep = \" \", stringsAsFactors = FALSE)\n # utilizzo la funzione read.table per caricare i dati \n\n#View(data) # visualizzo i dati in modo più chiaro\n\n\n\nAlcune funzioni utili per avere informazioni sul dataset caricato\nSegue un elenco di alcune funzioni utili una volta che i nostri dati sono stati caricati:\n\nfunzione dim(): serve per ottenere il numero di righe (soggetti e/o misurazioni) e colonne (variabili) del dataset\n\n\nCode\ndim(data)\n\n\n[1] 418  46\n\n\nfunzione str(): serve per ottenere velocemente un riassunto su come sono strutturati i dati\n\n\nCode\nstr(data)\n\n\n'data.frame':   418 obs. of  46 variables:\n $ ID          : int  1001 1002 1003 1004 1005 1006 1007 1008 1009 1010 ...\n $ entry_date  : chr  \"1977-04-01\" \"1976-01-11\" \"1978-11-18\" \"1980-08-13\" ...\n $ bili        : num  14.5 1.1 1.4 1.8 3.4 0.8 1 0.3 3.2 12.6 ...\n $ albumin     : num  2.6 4.14 3.48 2.54 3.53 3.98 4.09 4 3.08 2.74 ...\n $ stage       : int  4 3 4 4 3 3 3 3 2 4 ...\n $ protime     : num  12.2 10.6 12 10.3 10.9 11 9.7 11 11 11.5 ...\n $ sex         : chr  \"female\" \"female\" \"male\" \"female\" ...\n $ age         : num  58.8 56.4 70.1 54.7 38.1 ...\n $ spiders     : chr  \"present\" \"present\" \"absent\" \"present\" ...\n $ hepatom     : chr  \"present\" \"present\" \"absent\" \"present\" ...\n $ ascites     : chr  \"present\" \"absent\" \"absent\" \"absent\" ...\n $ alk.phos    : num  1718 7395 516 6122 671 ...\n $ sgot        : num  137.9 113.5 96.1 60.6 113.2 ...\n $ chol        : int  261 302 176 244 279 248 322 280 562 200 ...\n $ trig        : int  172 88 55 92 72 63 213 189 88 143 ...\n $ platelet    : int  190 221 151 183 136 NA 204 373 251 302 ...\n $ drug        : chr  \"placebo\" \"placebo\" \"placebo\" \"placebo\" ...\n $ edema       : chr  \"edema despite diuretic therapy\" \"no edema\" \"edema, no diuretic therapy\" \"edema, no diuretic therapy\" ...\n $ copper      : int  156 54 210 64 143 50 52 52 79 140 ...\n $ date_t1     : chr  \"1977-09-30\" \"1976-07-11\" \"1979-05-19\" \"1981-02-11\" ...\n $ bili_t1     : num  14.61 1.95 1.72 2.41 3.46 ...\n $ albumin_t1  : num  2.44 4.01 3.31 2.37 3.46 ...\n $ protime_t1  : num  12.1 10.4 12 10.2 10.7 ...\n $ alk.phos_t1 : num  1585 7311 613 6210 485 ...\n $ platelet_t1 : num  198 232 157 186 108 ...\n $ copper_t1   : num  172.4 65 223 78.4 196.9 ...\n $ date_t2     : chr  \"1978-04-01\" \"1977-01-10\" \"1979-11-18\" \"1981-08-13\" ...\n $ bili_t2     : num  15.74 2.04 1.48 2.92 4.97 ...\n $ albumin_t2  : num  2.39 3.95 3.27 2.39 3.41 ...\n $ protime_t2  : num  12.1 10.3 11.8 10.1 10.9 ...\n $ alk.phos_t2 : num  1774 7256 486 6035 523 ...\n $ platelet_t2 : num  210.1 241.2 164.3 198.5 80.5 ...\n $ copper_t2   : num  185.4 84.8 241.4 86.8 249.1 ...\n $ bili_t3     : num  NA 2.17 2.61 3.6 5.97 ...\n $ albumin_t3  : num  NA 3.73 3.05 2.11 3.34 ...\n $ protime_t3  : num  NA 10.13 11.56 9.84 10.98 ...\n $ alk.phos_t3 : num  NA 7287 409 6183 621 ...\n $ platelet_t3 : num  NA 228.6 165 199.1 83.2 ...\n $ copper_t3   : num  NA 105 263 111 352 ...\n $ fu.days     : int  400 4500 1012 1925 1504 2503 1832 2466 2400 51 ...\n $ status      : int  1 0 1 1 0 1 0 1 1 1 ...\n $ ast.UL      : num  26.3 19.1 17.6 10.8 28.5 ...\n $ gamma.g.g_dL: num  0.765 0.76 1.479 1.368 1.26 ...\n $ ibd_0_1     : int  0 0 0 0 0 0 0 0 0 0 ...\n $ hepB.ant_0_1: int  0 0 0 0 0 0 0 0 0 0 ...\n $ mal.cond_0_1: int  0 0 0 0 0 0 0 0 0 0 ...\n\n\n\n\n\nfunzione summary(): serve per ottenere velocemente un riassunto dei dati\n❗molto utile quando le variabili nel dataset sono già nel formato corretto\n\n\nCode\nsummary(data)\n\n\n       ID        entry_date             bili           albumin     \n Min.   :1001   Length:418         Min.   : 0.300   Min.   :1.960  \n 1st Qu.:1105   Class :character   1st Qu.: 0.800   1st Qu.:3.243  \n Median :1210   Mode  :character   Median : 1.400   Median :3.530  \n Mean   :1210                      Mean   : 3.221   Mean   :3.497  \n 3rd Qu.:1314                      3rd Qu.: 3.400   3rd Qu.:3.770  \n Max.   :1418                      Max.   :28.000   Max.   :4.640  \n\n     stage          protime          sex                 age       \n Min.   :1.000   Min.   : 9.00   Length:418         Min.   :26.28  \n 1st Qu.:2.000   1st Qu.:10.00   Class :character   1st Qu.:42.83  \n Median :3.000   Median :10.60   Mode  :character   Median :51.00  \n Mean   :3.024   Mean   :10.73                      Mean   :50.74  \n 3rd Qu.:4.000   3rd Qu.:11.10                      3rd Qu.:58.24  \n Max.   :4.000   Max.   :18.00                      Max.   :78.44  \n NA's   :6       NA's   :2                                         \n   spiders            hepatom            ascites             alk.phos      \n Length:418         Length:418         Length:418         Min.   :  289.0  \n Class :character   Class :character   Class :character   1st Qu.:  871.5  \n Mode  :character   Mode  :character   Mode  :character   Median : 1259.0  \n                                                          Mean   : 1982.7  \n                                                          3rd Qu.: 1980.0  \n                                                          Max.   :13862.4  \n                                                          NA's   :106      \n      sgot             chol             trig           platelet    \n Min.   : 26.35   Min.   : 120.0   Min.   : 33.00   Min.   : 62.0  \n 1st Qu.: 80.60   1st Qu.: 249.5   1st Qu.: 84.25   1st Qu.:199.8  \n Median :114.70   Median : 309.5   Median :108.00   Median :257.0  \n Mean   :122.56   Mean   : 369.5   Mean   :124.70   Mean   :261.9  \n 3rd Qu.:151.90   3rd Qu.: 400.0   3rd Qu.:151.00   3rd Qu.:322.5  \n Max.   :457.25   Max.   :1775.0   Max.   :598.00   Max.   :563.0  \n NA's   :106      NA's   :134      NA's   :136      NA's   :110    \n     drug              edema               copper         date_t1         \n Length:418         Length:418         Min.   :  4.00   Length:418        \n Class :character   Class :character   1st Qu.: 41.25   Class :character  \n Mode  :character   Mode  :character   Median : 73.00   Mode  :character  \n                                       Mean   : 97.65                     \n                                       3rd Qu.:123.00                     \n                                       Max.   :588.00                     \n                                       NA's   :108                        \n    bili_t1           albumin_t1      protime_t1      alk.phos_t1     \n Min.   :-0.00827   Min.   :1.902   Min.   : 8.822   Min.   :  145.3  \n 1st Qu.: 1.28905   1st Qu.:3.228   1st Qu.: 9.916   1st Qu.:  828.2  \n Median : 1.96624   Median :3.480   Median :10.462   Median : 1184.6  \n Mean   : 3.44642   Mean   :3.461   Mean   :10.619   Mean   : 1940.2  \n 3rd Qu.: 3.85341   3rd Qu.:3.732   3rd Qu.:11.030   3rd Qu.: 1920.8  \n Max.   :28.86766   Max.   :4.455   Max.   :16.986   Max.   :13777.5  \n NA's   :115        NA's   :115     NA's   :115      NA's   :115      \n  platelet_t1       copper_t1        date_t2             bili_t2       \n Min.   : 48.63   Min.   : 19.37   Length:418         Min.   : 0.3688  \n 1st Qu.:189.43   1st Qu.: 75.64   Class :character   1st Qu.: 1.6899  \n Median :249.66   Median :103.38   Mode  :character   Median : 2.3806  \n Mean   :255.19   Mean   :127.27                      Mean   : 3.6885  \n 3rd Qu.:317.14   3rd Qu.:161.36                      3rd Qu.: 3.9851  \n Max.   :564.97   Max.   :611.97                      Max.   :29.6606  \n NA's   :119      NA's   :117                         NA's   :128      \n   albumin_t2      protime_t2      alk.phos_t2       platelet_t2   \n Min.   :1.850   Min.   : 8.886   Min.   :  173.9   Min.   : 43.8  \n 1st Qu.:3.168   1st Qu.: 9.818   1st Qu.:  753.5   1st Qu.:179.4  \n Median :3.416   Median :10.347   Median : 1161.2   Median :242.7  \n Mean   :3.399   Mean   :10.480   Mean   : 1853.2   Mean   :250.2  \n 3rd Qu.:3.661   3rd Qu.:10.896   3rd Qu.: 1865.6   3rd Qu.:314.0  \n Max.   :4.410   Max.   :16.954   Max.   :13738.8   Max.   :581.7  \n NA's   :128     NA's   :128      NA's   :128       NA's   :132    \n   copper_t2         bili_t3         albumin_t3      protime_t3    \n Min.   : 34.59   Min.   : 1.178   Min.   :1.819   Min.   : 8.637  \n 1st Qu.: 93.12   1st Qu.: 2.556   1st Qu.:3.023   1st Qu.: 9.700  \n Median :144.87   Median : 3.256   Median :3.277   Median :10.107  \n Mean   :155.40   Mean   : 4.530   Mean   :3.252   Mean   :10.303  \n 3rd Qu.:192.12   3rd Qu.: 5.052   3rd Qu.:3.499   3rd Qu.:10.714  \n Max.   :491.80   Max.   :29.943   Max.   :4.195   Max.   :17.141  \n NA's   :130      NA's   :140      NA's   :140     NA's   :140     \n  alk.phos_t3       platelet_t3       copper_t3         fu.days    \n Min.   :  121.1   Min.   : 44.27   Min.   : 54.14   Min.   :  41  \n 1st Qu.:  752.3   1st Qu.:179.13   1st Qu.:116.94   1st Qu.:1093  \n Median : 1082.4   Median :243.87   Median :229.39   Median :1730  \n Mean   : 1867.7   Mean   :251.61   Mean   :216.82   Mean   :1918  \n 3rd Qu.: 1878.4   3rd Qu.:315.28   3rd Qu.:285.34   3rd Qu.:2614  \n Max.   :13620.4   Max.   :581.30   Max.   :574.17   Max.   :4795  \n NA's   :140       NA's   :144      NA's   :142                    \n     status           ast.UL        gamma.g.g_dL       ibd_0_1       \n Min.   :0.0000   Min.   : 10.24   Min.   :0.7008   Min.   :0.00000  \n 1st Qu.:0.0000   1st Qu.: 16.82   1st Qu.:0.9148   1st Qu.:0.00000  \n Median :0.0000   Median : 23.04   Median :1.1605   Median :0.00000  \n Mean   :0.3852   Mean   : 51.71   Mean   :1.2726   Mean   :0.04785  \n 3rd Qu.:1.0000   3rd Qu.: 31.42   3rd Qu.:1.4061   3rd Qu.:0.00000  \n Max.   :1.0000   Max.   :395.99   Max.   :3.9975   Max.   :1.00000  \n\n  hepB.ant_0_1      mal.cond_0_1    \n Min.   :0.00000   Min.   :0.00000  \n 1st Qu.:0.00000   1st Qu.:0.00000  \n Median :0.00000   Median :0.00000  \n Mean   :0.04785   Mean   :0.04785  \n 3rd Qu.:0.00000   3rd Qu.:0.00000  \n Max.   :1.00000   Max.   :1.00000"
  },
  {
    "objectID": "STAT DESCRITTIVA AP/Stat descrittiva.html#controllo-congruenza-dati",
    "href": "STAT DESCRITTIVA AP/Stat descrittiva.html#controllo-congruenza-dati",
    "title": "Statistica descrittiva e basi di R",
    "section": "Controllo congruenza dati",
    "text": "Controllo congruenza dati\nIl dataset caricato si riferisce ai dati dello studio Mayo Clinic trial on penicillamine in advanced primary biliary cirrhosis su cui avete lavorato in precedenza. Un breve recap:\n\nBackground:\nPrimary biliary cirrhosis, a chronic liver disease of unknown cause, is characterized by inflammation and necrosis  of intrahepatic bile ducts, cholestesis, cirrhosis, and hepatic failure. The primary pathologic event appears to be destruction of the interlobular bile ducts, which may be mediated by immunologic mechanisms. Increased hepatic copper concentrations, found primarily in advanced disease (stages 3,4) are secondary to progressive intrahepatic colestasis and diminished hepatobiliary clearance of copper. There is no effective treatment for primary biliary cirrhosis, and the medical approach to patients with the disease has been limited to supportive care.\n   On the basis of the drug’s ability to increase urinary copper excretion and to inhibit tropocollagen synthesis, perhaps thereby diminishing fibrosis, and of its potential immunosuppressive properties, we initiated a long term prospective, double-blind, controlled trial to investigate whether penicillamine (D-penicillamine) is more effective than placebo in patients with primary biliary cirrhosis. Patients with early disease (histologic stage 1,2) will remain in the trial, and their response to penicillamine will be reported later, after longer observation.\n\nDopo aver caricato i dati e prima di procedere in qualsiasi tipo di analisi, è fondamentale controllare che tutti i dati siano stati raccolti e importati in modo congruo e che non ci siano errori. Anche se i dati che avete raccolto sono stati scaricati direttamente da REDCap e quindi le possibilità di errori nella compilazione del database erano minime, è comunque necessario verificare che tutti i dati siano corretti.\nFacciamo riferimento alle linee guida CONSORT. Siamo al riguadro cerchiato in viola del flowchart riportato nelle linee guida.\nSupponete di dover controllare che i criteri di inclusione dello studio siano stati tutti rispettati correttamente.\n\n\nEligibility:\nPeople with estabilished disease of more than six months duration, with a serum level of alkaline phosphatase more than 2.5 times the normal level, and a pre-entry liver biopsy considered to be diagnostic of primary biliary cirrhosis.\nReasons for the exclusion from the study:\n- serum level of aspartate aminotransferase more than 10 times the normal level\n- serum level of aspartate aminotransferase more than 5 times the normal level and gamma globulin more than twice the normal level\n- evidence of inflammatory bowel disease\n- a malignant condition other than skin cancer\n- evidence of extrahepatic obstruction\n- use of cholestatic or epatotoxic drugs or excessive alcohol intake\n- presence of hepatitis B surface antigen\n\nI soggetti che sono stati inclusi nello studio avranno specificato per la variabile relativa al farmaco assegnato un valore di ‘D-penicillamine’ o ‘placebo’. I soggetti non inclusi nello studio avranno un valore della variabile uguale a ‘not randomized’. Ma quanti soggetti sono stati assegnati a D-penicillamine, quanti a placebo e quanti non randomizzati? Ddobbiamo considerare la variabile relativa all’assegnazione del farmaco. Ed utilizzare la funzione table() per generare una tabella con le frequenze assolute.\n❗E’ buona norma aggiungere alla tabella dei ‘margini’ dove viene riportata la somma delle frequenze assolute. Per aggiungere i margini utilizziamo la funzione addmargins()\n\nLa variabile relativa all’assegnazione del farmaco è la variabile drug. Per ottenere il nome di tutte le variabili presenti nel dataset considero la funzione colnames(). [1]\nPer richiamare la variabile drug dal dataset non faccio altro che richiamare il nome del dataset (data) seguito dal simbolo $ seguito dal nome della variabile. [2]\nPer generare una tabella coi margini utilizzo la funzione table, seguita dalla funzione addmargins(). Ricorda che si possono concatenare le funzioni Section 18.1.1![3]\n\n\n\nCode\n# [1]\ncolnames(data) # uso la funzione colnames() per vedere i nomi delle colonne: la variabile drug è quella relativa al farmaco\n\n\n [1] \"ID\"           \"entry_date\"   \"bili\"         \"albumin\"      \"stage\"       \n [6] \"protime\"      \"sex\"          \"age\"          \"spiders\"      \"hepatom\"     \n[11] \"ascites\"      \"alk.phos\"     \"sgot\"         \"chol\"         \"trig\"        \n[16] \"platelet\"     \"drug\"         \"edema\"        \"copper\"       \"date_t1\"     \n[21] \"bili_t1\"      \"albumin_t1\"   \"protime_t1\"   \"alk.phos_t1\"  \"platelet_t1\" \n[26] \"copper_t1\"    \"date_t2\"      \"bili_t2\"      \"albumin_t2\"   \"protime_t2\"  \n[31] \"alk.phos_t2\"  \"platelet_t2\"  \"copper_t2\"    \"bili_t3\"      \"albumin_t3\"  \n[36] \"protime_t3\"   \"alk.phos_t3\"  \"platelet_t3\"  \"copper_t3\"    \"fu.days\"     \n[41] \"status\"       \"ast.UL\"       \"gamma.g.g_dL\" \"ibd_0_1\"      \"hepB.ant_0_1\"\n[46] \"mal.cond_0_1\"\n\n\nCode\n#[2]\ndata$drug # richiamo la variabile drug \n\n\n  [1] \"placebo\"         \"placebo\"         \"placebo\"         \"placebo\"        \n  [5] \"D-penicillamine\" \"D-penicillamine\" \"D-penicillamine\" \"D-penicillamine\"\n  [9] \"placebo\"         \"D-penicillamine\" \"D-penicillamine\" \"D-penicillamine\"\n [13] \"D-penicillamine\" \"D-penicillamine\" \"placebo\"         \"D-penicillamine\"\n [17] \"D-penicillamine\" \"placebo\"         \"placebo\"         \"D-penicillamine\"\n [21] \"D-penicillamine\" \"placebo\"         \"D-penicillamine\" \"placebo\"        \n [25] \"D-penicillamine\" \"D-penicillamine\" \"D-penicillamine\" \"D-penicillamine\"\n [29] \"D-penicillamine\" \"D-penicillamine\" \"D-penicillamine\" \"D-penicillamine\"\n [33] \"D-penicillamine\" \"placebo\"         \"D-penicillamine\" \"D-penicillamine\"\n [37] \"placebo\"         \"D-penicillamine\" \"placebo\"         \"placebo\"        \n [41] \"placebo\"         \"D-penicillamine\" \"placebo\"         \"D-penicillamine\"\n [45] \"D-penicillamine\" \"placebo\"         \"D-penicillamine\" \"D-penicillamine\"\n [49] \"D-penicillamine\" \"placebo\"         \"D-penicillamine\" \"placebo\"        \n [53] \"placebo\"         \"placebo\"         \"placebo\"         \"D-penicillamine\"\n [57] \"placebo\"         \"placebo\"         \"placebo\"         \"placebo\"        \n [61] \"D-penicillamine\" \"D-penicillamine\" \"D-penicillamine\" \"D-penicillamine\"\n [65] \"placebo\"         \"placebo\"         \"D-penicillamine\" \"placebo\"        \n [69] \"placebo\"         \"placebo\"         \"D-penicillamine\" \"D-penicillamine\"\n [73] \"D-penicillamine\" \"placebo\"         \"placebo\"         \"placebo\"        \n [77] \"D-penicillamine\" \"placebo\"         \"placebo\"         \"D-penicillamine\"\n [81] \"placebo\"         \"placebo\"         \"placebo\"         \"D-penicillamine\"\n [85] \"D-penicillamine\" \"placebo\"         \"placebo\"         \"D-penicillamine\"\n [89] \"placebo\"         \"placebo\"         \"D-penicillamine\" \"placebo\"        \n [93] \"placebo\"         \"placebo\"         \"D-penicillamine\" \"placebo\"        \n [97] \"D-penicillamine\" \"placebo\"         \"D-penicillamine\" \"D-penicillamine\"\n[101] \"D-penicillamine\" \"placebo\"         \"D-penicillamine\" \"placebo\"        \n[105] \"D-penicillamine\" \"placebo\"         \"D-penicillamine\" \"placebo\"        \n[109] \"D-penicillamine\" \"placebo\"         \"placebo\"         \"D-penicillamine\"\n[113] \"placebo\"         \"D-penicillamine\" \"D-penicillamine\" \"placebo\"        \n[117] \"placebo\"         \"placebo\"         \"placebo\"         \"placebo\"        \n[121] \"D-penicillamine\" \"placebo\"         \"placebo\"         \"placebo\"        \n[125] \"D-penicillamine\" \"placebo\"         \"D-penicillamine\" \"placebo\"        \n[129] \"placebo\"         \"D-penicillamine\" \"D-penicillamine\" \"placebo\"        \n[133] \"D-penicillamine\" \"D-penicillamine\" \"placebo\"         \"placebo\"        \n[137] \"placebo\"         \"placebo\"         \"D-penicillamine\" \"placebo\"        \n[141] \"placebo\"         \"D-penicillamine\" \"D-penicillamine\" \"D-penicillamine\"\n[145] \"D-penicillamine\" \"D-penicillamine\" \"placebo\"         \"D-penicillamine\"\n[149] \"placebo\"         \"D-penicillamine\" \"placebo\"         \"placebo\"        \n[153] \"placebo\"         \"placebo\"         \"D-penicillamine\" \"D-penicillamine\"\n[157] \"D-penicillamine\" \"placebo\"         \"D-penicillamine\" \"D-penicillamine\"\n[161] \"D-penicillamine\" \"D-penicillamine\" \"placebo\"         \"D-penicillamine\"\n[165] \"placebo\"         \"D-penicillamine\" \"placebo\"         \"D-penicillamine\"\n[169] \"D-penicillamine\" \"placebo\"         \"placebo\"         \"D-penicillamine\"\n[173] \"placebo\"         \"placebo\"         \"D-penicillamine\" \"placebo\"        \n[177] \"D-penicillamine\" \"placebo\"         \"D-penicillamine\" \"D-penicillamine\"\n[181] \"placebo\"         \"placebo\"         \"D-penicillamine\" \"D-penicillamine\"\n[185] \"placebo\"         \"placebo\"         \"D-penicillamine\" \"placebo\"        \n[189] \"D-penicillamine\" \"placebo\"         \"D-penicillamine\" \"placebo\"        \n[193] \"D-penicillamine\" \"placebo\"         \"placebo\"         \"placebo\"        \n[197] \"placebo\"         \"D-penicillamine\" \"placebo\"         \"D-penicillamine\"\n[201] \"D-penicillamine\" \"placebo\"         \"D-penicillamine\" \"D-penicillamine\"\n[205] \"placebo\"         \"placebo\"         \"placebo\"         \"placebo\"        \n[209] \"D-penicillamine\" \"D-penicillamine\" \"D-penicillamine\" \"D-penicillamine\"\n[213] \"placebo\"         \"D-penicillamine\" \"D-penicillamine\" \"placebo\"        \n[217] \"D-penicillamine\" \"placebo\"         \"D-penicillamine\" \"placebo\"        \n[221] \"D-penicillamine\" \"D-penicillamine\" \"placebo\"         \"placebo\"        \n[225] \"placebo\"         \"D-penicillamine\" \"placebo\"         \"D-penicillamine\"\n[229] \"placebo\"         \"D-penicillamine\" \"D-penicillamine\" \"placebo\"        \n[233] \"placebo\"         \"D-penicillamine\" \"D-penicillamine\" \"placebo\"        \n[237] \"placebo\"         \"D-penicillamine\" \"placebo\"         \"placebo\"        \n[241] \"D-penicillamine\" \"placebo\"         \"D-penicillamine\" \"placebo\"        \n[245] \"D-penicillamine\" \"placebo\"         \"placebo\"         \"D-penicillamine\"\n[249] \"placebo\"         \"D-penicillamine\" \"placebo\"         \"placebo\"        \n[253] \"placebo\"         \"placebo\"         \"D-penicillamine\" \"placebo\"        \n[257] \"placebo\"         \"placebo\"         \"D-penicillamine\" \"D-penicillamine\"\n[261] \"D-penicillamine\" \"D-penicillamine\" \"D-penicillamine\" \"D-penicillamine\"\n[265] \"D-penicillamine\" \"placebo\"         \"placebo\"         \"placebo\"        \n[269] \"D-penicillamine\" \"placebo\"         \"D-penicillamine\" \"placebo\"        \n[273] \"D-penicillamine\" \"placebo\"         \"placebo\"         \"placebo\"        \n[277] \"D-penicillamine\" \"D-penicillamine\" \"D-penicillamine\" \"placebo\"        \n[281] \"placebo\"         \"D-penicillamine\" \"D-penicillamine\" \"D-penicillamine\"\n[285] \"placebo\"         \"placebo\"         \"placebo\"         \"D-penicillamine\"\n[289] \"placebo\"         \"placebo\"         \"placebo\"         \"D-penicillamine\"\n[293] \"D-penicillamine\" \"placebo\"         \"placebo\"         \"D-penicillamine\"\n[297] \"placebo\"         \"D-penicillamine\" \"placebo\"         \"D-penicillamine\"\n[301] \"D-penicillamine\" \"placebo\"         \"D-penicillamine\" \"placebo\"        \n[305] \"D-penicillamine\" \"D-penicillamine\" \"D-penicillamine\" \"placebo\"        \n[309] \"D-penicillamine\" \"placebo\"         \"placebo\"         \"D-penicillamine\"\n[313] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[317] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[321] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[325] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[329] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[333] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[337] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[341] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[345] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[349] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[353] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[357] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[361] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[365] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[369] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[373] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[377] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[381] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[385] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[389] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[393] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[397] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[401] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[405] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[409] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[413] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[417] \"not randomized\"  \"not randomized\" \n\n\nCode\n#[3]\naddmargins(table(data$drug, useNA = 'always')) # tabella per frequenze assolute farmaco\n\n\n\nD-penicillamine  not randomized         placebo            &lt;NA&gt;             Sum \n            154             106             158               0             418 \n\n\nBONUS!\nPer poter calcolare velocemente le frequenze relative per ogni categoria di farmaco assegnato, possiamo utilizzare la funzione prop.table(). Questa funzione vuole come argomento la tabella che avete appena generato e automaticamente calcola le proporzioni.\n\n\nCode\nprop.table(table(data$drug))\n\n\n\nD-penicillamine  not randomized         placebo \n      0.3684211       0.2535885       0.3779904 \n\n\nOra, di tutti gli ID presenti nel dataset, dobbiamo estrarre solo quelli che sono stati inclusi nello studio. Per fare ciò consideriamo i seguenti comandi:\n\nal vettore relativo agli ID data$ID filtro, attraverso l’utilizzo delle parentesi quadre, solamente quelli associati a dei soggetti che hanno data$drug diverso (!=) a ‘not randomized’. Questi ID vengono salvati in un nuovo vettore ids.rand\n\n\n\nCode\nids.rand = data$ID[data$drug != 'not randomized'] # genero un vettore con solamente gli ID dei inclusi (drug == 'not randomized')\n\n\nOra che ho salvato tutti gli ID dei soggetti inclusi nello studio nel vettore ids.rand, posso ridurre il dataset intero per ottenerne uno dove sono presenti solo i soggetti inclusi. Ovvero, mantengo nel dataset, solamente le righe dei soggetti che hanno un ID presente (%in%) nel vettore ids.rand. Questo dataset ridotto viene salvato come inclusi\n\n\nCode\ninclusi = data[data$ID %in% ids.rand, ] # filtro i soggetti che hanno ID presente nel vettore ids.not\n\ndim(inclusi) # vedo se il numero di righe corrisponde ai 312 soggetti inclusi\n\n\n[1] 312  46\n\n\nCode\n# View(inclusi)\n\n\nUn’altra funzione più semplice da utilizzare è la funzione subset()\nOra non ci resta che considerare se i criteri di inclusione si applicano ai soggetti nel dataset ‘inclusi’\n\n- serum level of aspartate aminotransferase more than 10 times the normal level\nNormal ranges for AST are: \n\nMen: 14 to 20 units/L \nWomen: 10 to 36 units/L \n\n\nPer fare ciò, nella funzione table() inserisco le seguenti condizioni:\n\naspartate aminotransferase (AST) minore o uguale a (&lt;=) 200 se contemporaneamente (&) il soggetto è (==) maschio oppure ( | ) aspartate aminotransferase (AST) minore o uguale a (&lt;=) 360 se contemporaneamente (&) il soggetto è (==) femmina\n\n❗ Il simbolo ‘==’ viene utilizzato per dire ‘equivalente a’, il simbolo ‘=’ viene utilizzato per assegnare e generare nuovi oggetti.\n\n\nCode\ntable(inclusi$ast.UL &lt;= 200 & inclusi$sex == 'male' | \n        inclusi$ast.UL &lt;= 360 & inclusi$sex =='female')\n\n\n\nTRUE \n 312 \n\n\n\n- serum level of aspartate aminotransferase more than 5 times the normal level and gamma globulin more than twice the normal level\nNormal value ranges are:\n\nGamma globulin: 0.7 to 1.6 g/dL or 7 to 16 g/L\n\n\n\n\nCode\ntable(inclusi$ast.UL &lt;= 100 & inclusi$sex == 'male' & inclusi$gamma.g.g_dL &lt;= 3.2 | \n        inclusi$ast.UL &lt;= 180 & inclusi$sex =='female'  & inclusi$gamma.g.g_dL &lt;= 3.2)\n\n\n\nTRUE \n 312 \n\n\nOra tocca a voi!\n\n\n- evidence of inflammatory bowel disease (ibd_0_1)\n- a malignant condition other than skin cancer (mal.con_0_1)\n- evidence of extrahepatic obstruction (extra.hep_0_1)\n- use of cholestatic or epatotoxic drugs or excessive alcohol intake (ex_alch_0_1)\n- presence of hepatitis B surface antigen (cholest_epatotoxic)"
  },
  {
    "objectID": "STAT DESCRITTIVA AP/Stat descrittiva.html#homework",
    "href": "STAT DESCRITTIVA AP/Stat descrittiva.html#homework",
    "title": "Statistica descrittiva e basi di R",
    "section": "Homework 📚",
    "text": "Homework 📚\nProvate a scrivere un programma per individuare quali sono le motivazioni di non inclusione nello studio dei soggetti ‘not randomized’ e a quanti soggetti corrispondono le seguenti motivazioni:\n\n- serum level of aspartate aminotransferase more than 10 times the normal level\n- serum level of aspartate aminotransferase more than 5 times the normal level and gamma globulin more than twice the normal level\n- evidence of inflammatory bowel disease\n- a malignant condition other than skin cancer\n- evidence of extrahepatic obstruction\n- use of cholestatic or epatotoxic drugs or excessive alcohol intake\n- presence of hepatitis B surface antigen\n\nDovreste creare una tabella di questo tipo:\n\n\n\n\n\n\n\n\nMotivazione\nNumero di soggetti non inclusi\nFrequenza relativa (sul numero totale dei non inclusi)\n\n\n\n\nserum level of aspartate aminotransferase more than 10 times the normal level\n\n\n\n\nserum level of aspartate aminotransferase more than 5 times the normal level and gamma globulin more than twice the normal level\n\n\n\n\na malignant condition other than skin cancer\n\n\n\n\nevidence of extrahepatic obstruction\n\n\n\n\nuse of cholestatic or epatotoxic drugs or excessive alcohol intake\n\n\n\n\npresence of hepatitis B surface antigen"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "STAT DESCRITTIVA AP/Senza nome.html",
    "href": "STAT DESCRITTIVA AP/Senza nome.html",
    "title": "Studi osservazionali e misure di associazione",
    "section": "",
    "text": "library(dplyr)\nlibrary(ggplot2)"
  },
  {
    "objectID": "STAT DESCRITTIVA AP/Senza nome.html#introduzione-agli-studi-osservazionali",
    "href": "STAT DESCRITTIVA AP/Senza nome.html#introduzione-agli-studi-osservazionali",
    "title": "Studi osservazionali e misure di associazione",
    "section": "Introduzione agli Studi Osservazionali",
    "text": "Introduzione agli Studi Osservazionali\n\n1. Cos’è uno studio osservazionale?\nUno studio osservazionale è un tipo di ricerca in cui il ricercatore osserva e registra eventi o comportamenti senza intervenire direttamente. A differenza degli studi sperimentali, dove il ricercatore manipola una variabile (ad esempio somministrando un farmaco o un trattamento), negli studi osservazionali non c’è alcun intervento attivo. Il ricercatore si limita a monitorare l’andamento naturale degli eventi.\nGli studi osservazionali sono particolarmente utili quando sarebbe non etico o impraticabile condurre uno studio sperimentale. Ad esempio, non possiamo chiedere a delle persone di iniziare a fumare per vedere se sviluppano il cancro ai polmoni; tuttavia, possiamo osservare i fumatori e i non fumatori e studiare il rischio di sviluppare la malattia nel corso del tempo.\n\n\n2. Tipologie di studi osservazionali\nEsistono tre principali tipi di studi osservazionali, ciascuno con caratteristiche specifiche:\n\n2.1. Studi di coorte\nNegli studi di coorte, un gruppo di individui (la coorte) viene seguito nel tempo per osservare chi sviluppa una determinata condizione o malattia. Questi individui vengono suddivisi in base alla loro esposizione a un determinato fattore di rischio (ad esempio il fumo), e poi vengono osservati per vedere chi sviluppa l’outcome di interesse (ad esempio il cancro).\n\nEsempio: Si può seguire un gruppo di 1.000 fumatori e non fumatori per 10 anni per determinare chi sviluppa il cancro ai polmoni.\n\nUn altro esempio famoso\nGli studi di coorte possono essere:\n\nProspettici: i partecipanti vengono seguiti nel futuro, dal momento dell'inizio dello studio in avanti.\nRetrospettivi: si utilizzano dati già raccolti in passato, andando a esaminare ciò che è accaduto nel tempo ai partecipanti.\n\nVantaggi:\n\nPossono fornire stime dirette del rischio di malattia associato all'esposizione.\nPermettono di studiare molteplici outcome per una singola esposizione.\n\nLimiti:\n\nSono costosi e richiedono molto tempo, soprattutto per malattie che si sviluppano lentamente.\nPossono soffrire di perdita di partecipanti (attrition) durante il follow-up.\n\n\n\n2.2. Studi caso-controllo\nNegli studi caso-controllo, si confrontano individui che hanno già sviluppato una malattia (i casi) con individui che non hanno la malattia (i controlli), per verificare se vi siano differenze nelle esposizioni passate a determinati fattori di rischio.\n\nEsempio: Si può confrontare un gruppo di persone con infarto (casi) e un gruppo di persone senza infarto (controlli), per verificare se esiste una differenza nell’esposizione a una dieta ricca di grassi tra i due gruppi.\n\nUn altro esempio famoso\nVantaggi:\n\nIdeali per studiare malattie rare o con lunghi periodi di latenza.\nPiù veloci ed economici rispetto agli studi di coorte.\n\nLimiti:\n\nRischio di bias di richiamo: i casi potrebbero ricordare meglio le esposizioni passate rispetto ai controlli.\nNon permettono di calcolare il rischio assoluto, ma solo la odds ratio (rapporto di probabilità).\n\n\n\n2.3. Studi trasversali (cross-sectional)\nGli studi trasversali misurano contemporaneamente l'esposizione e l'outcome in un determinato momento, fornendo una “fotografia” della popolazione in quel preciso istante. Questi studi sono particolarmente utili per stimare la prevalenza di una condizione in una popolazione.\n\nEsempio: Si può condurre uno studio trasversale per valutare la prevalenza dell'obesità tra adulti che praticano attività fisica rispetto a coloro che non lo fanno.\n\nUn altro esempio famoso\nVantaggi:\n\nSono rapidi e relativamente poco costosi.\nUtili per descrivere la distribuzione delle malattie in una popolazione.\n\nLimiti:\n\nNon possono stabilire relazioni causali poiché esposizione e outcome sono misurati contemporaneamente.\nNon permettono di determinare se l’esposizione precede o segue l'outcome.\n\n\n\n\n3. Vantaggi e Limiti degli Studi Osservazionali\nGli studi osservazionali sono essenziali nella ricerca epidemiologica e nella medicina, soprattutto quando esperimenti controllati non sono fattibili o etici. Tuttavia, presentano una serie di limiti che è importante comprendere.\nVantaggi:\n\nEticamente accettabili: Permettono di studiare situazioni in cui non sarebbe etico intervenire (es. esposizioni dannose come il fumo o l’inquinamento).\nFattibili: Sono generalmente più facili da condurre rispetto agli studi sperimentali, richiedono meno risorse e spesso utilizzano dati già disponibili.\nGenerano ipotesi: Forniscono indicazioni preliminari su relazioni tra fattori di rischio e malattie che possono essere successivamente testate in studi sperimentali.\n\nLimiti:\n\nCausalità incerta: Non possono stabilire con certezza un nesso causale tra esposizione e outcome. Ad esempio, se uno studio trasversale mostra che le persone che guardano molta televisione sono più obese, non possiamo dire se la televisione causi l’obesità o se le persone obese tendano a guardare più televisione.\nConfondenti: Spesso è difficile controllare per tutti i fattori confondenti, cioè variabili che potrebbero influenzare sia l'esposizione che l'outcome. Ad esempio, l’età, il sesso o il reddito possono influenzare sia il rischio di malattia che l’esposizione a determinati fattori di rischio.\nBias: Gli studi osservazionali sono particolarmente vulnerabili a diversi tipi di bias (distorsioni), come il bias di selezione (se i partecipanti selezionati non sono rappresentativi della popolazione) e il bias di richiamo (se i partecipanti non ricordano accuratamente le esposizioni passate).\n\n\n\n4. Conclusione\nGli studi osservazionali sono uno strumento fondamentale nella ricerca medica e sociale. Offrono importanti indicazioni sulle associazioni tra fattori di rischio ed esiti di salute, permettendo ai ricercatori di generare ipotesi e di identificare tendenze nella popolazione. Tuttavia, a causa della loro natura non sperimentale, è essenziale interpretare i risultati con cautela, tenendo sempre presente la possibilità di confondenti e bias."
  },
  {
    "objectID": "STAT DESCRITTIVA AP/Senza nome.html#misure-di-associazione-e-loro-interpretazione",
    "href": "STAT DESCRITTIVA AP/Senza nome.html#misure-di-associazione-e-loro-interpretazione",
    "title": "Studi osservazionali e misure di associazione",
    "section": "Misure di Associazione e loro Interpretazione",
    "text": "Misure di Associazione e loro Interpretazione\nQuando conduciamo uno studio epidemiologico per esplorare la relazione tra un'esposizione (ad esempio il fumo) e un outcome di salute (ad esempio il cancro ai polmoni), è fondamentale quantificare l’associazione tra i due. Le misure di associazione ci permettono di comprendere se e quanto un'esposizione aumenta o riduce la probabilità di un determinato esito.\n\n1. Risk Ratio (Rapporto di Rischio o RR)\nIl Risk Ratio (RR), o rapporto di rischio, è una misura di associazione comunemente utilizzata negli studi di coorte. Esprime il rapporto tra il rischio di sviluppare una malattia (o un outcome) nei soggetti esposti a un fattore di rischio e il rischio nei soggetti non esposti.\n\nFormula:\n\\[RR = \\frac{Rischio \\ nei\\ soggetti \\ esposti}{Rischio \\ nei \\ soggetti \\ non \\ esposti}\\]​\n\nRischio: La probabilità che un individuo sviluppi l'outcome (ad esempio una malattia) durante un certo periodo di tempo. Si calcola come:​\n\n\\[Rischio = \\frac{Numero \\ di \\ individui \\ che \\ sviluppano \\ malattia}{Numero \\ totale \\ di \\ individui \\ esposti}\\]\n\n\nInterpretazione:\n\nRR = 1: L'esposizione non modifica il rischio rispetto ai non esposti.\nRR &gt; 1: L'esposizione aumenta il rischio di sviluppare la malattia (es. RR = 2 significa che gli esposti hanno il doppio del rischio di sviluppare la malattia rispetto ai non esposti).\nRR &lt; 1: L'esposizione riduce il rischio di sviluppare la malattia (es. RR = 0.5 indica che gli esposti hanno la metà del rischio di ammalarsi rispetto ai non esposti).\n\n\n\nEsempio:\nIn uno studio di coorte sui fumatori e il cancro ai polmoni, se 10 su 100 fumatori sviluppano il cancro e solo 2 su 100 non fumatori lo sviluppano:\n\\[\nRR = \\frac{10/100}{2/100} = 5\n\\]\nQuesto significa che i fumatori hanno un rischio 5 volte maggiore di sviluppare il cancro ai polmoni rispetto ai non fumatori.\n\n\n\n2. Odds Ratio (OR)\nL'Odds Ratio (OR), o rapporto di probabilità, è la misura più comune negli studi caso-controllo, ma può essere utilizzata anche in studi di coorte. Esprime il rapporto tra le odds (probabilità) di esposizione tra i casi (quelli che hanno sviluppato l’outcome) rispetto ai controlli (quelli che non lo hanno sviluppato).\n\nFormula:\n\\[OR = \\frac{odds \\ di \\ esposizione \\ nei \\ casi }{odds \\ di \\ esposizione \\ nei \\ controlli}\\]​\n\nOdds: La probabilità che un evento si verifichi rispetto alla probabilità che non si verifichi. Si calcola come:\n\n\\[Odds = \\frac{Numero \\  di \\ eventi}{Numero \\  di  \\ non  \\ eventi}\\]​\n\n\nInterpretazione:\n\nOR = 1: Nessuna associazione tra esposizione e outcome.\nOR &gt; 1: L'esposizione è associata a un aumento delle probabilità di sviluppare l'outcome.\nOR &lt; 1: L'esposizione è associata a una riduzione delle probabilità di sviluppare l'outcome.\n\n\n\nEsempio:\nIn uno studio caso-controllo che esamina la relazione tra dieta ricca di grassi e infarto, supponiamo che 30 casi su 50 abbiano avuto una dieta ricca di grassi, mentre tra i controlli solo 10 su 50 lo abbiano fatto:\n\\[\nOR = \\frac{30/20}{10/40} = \\frac{1.5}{0.25} = 6\n\\]\nQuesto significa che coloro che hanno una dieta ricca di grassi hanno 6 volte più probabilità di avere un infarto rispetto a quelli con una dieta a basso contenuto di grassi.\n\n\n\n3. Prevalence Ratio (PR)\nIl Prevalence Ratio (PR) è utilizzato negli studi trasversali (cross-sectional) per confrontare la prevalenza di un outcome tra individui esposti e non esposti a un determinato fattore di rischio. Misura il rapporto tra la prevalenza della malattia negli esposti rispetto ai non esposti.\n\nFormula:\n\\[\nPR = \\frac{Prevalenza \\ negli \\ esposti}{Prevalenza \\  nei \\  non \\ esposti}\n\\]\n\nPrevalenza: La proporzione di individui con una condizione o malattia in un determinato momento. Si calcola come:\n\n\\[\nPrevalenza = \\frac{Numero \\ di \\ casi \\ di \\ malattia}{Numero \\ totale \\ di \\ individui \\ nella \\ popolazione}\n\\]​\n\n\nInterpretazione:\n\nPR = 1: Nessuna differenza nella prevalenza dell'outcome tra esposti e non esposti.\nPR &gt; 1: La prevalenza dell'outcome è maggiore tra gli esposti.\nPR &lt; 1: La prevalenza dell'outcome è minore tra gli esposti.\n\n\n\nEsempio:\nIn uno studio trasversale sulla prevalenza dell’asma tra persone esposte e non esposte a inquinamento, se la prevalenza di asma è del 15% tra gli esposti e del 5% tra i non esposti:\n\\[\nPR = \\frac{0.15}{0.05}= 3\n\\]\nQuesto significa che la prevalenza dell’asma è 3 volte maggiore tra coloro che sono esposti all'inquinamento rispetto a coloro che non lo sono.\n\n\n\n4. Differenze tra Risk Ratio, Odds Ratio e Prevalence Ratio\n\nIl Risk Ratio è utilizzato principalmente negli studi di coorte, dove seguiamo i partecipanti nel tempo e possiamo calcolare il rischio di sviluppare una malattia.\nL'Odds Ratio è comune negli studi caso-controllo, dove non possiamo calcolare il rischio perché la malattia è già presente al momento della raccolta dei dati, quindi usiamo le odds (probabilità) di esposizione.\nIl Prevalence Ratio è specifico degli studi trasversali, dove valutiamo la prevalenza di una condizione in un dato momento, ma non possiamo calcolare il rischio futuro.\n\n\n\n5. Tabelle di contingenza\nStudio caso-controllo\n\nset.seed(123)\nr = .6\nsim &lt;- rbind(\ndata.frame(outcome = rep(1, 30), exposure = rbinom(30, 1, r) ),\ndata.frame(outcome = rep(0, 60), exposure = rbinom(60, 1, r/2)))\n\ntoString(sim$outcome)\n\n[1] \"1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0\"\n\ntoString(sim$exposure)\n\n[1] \"1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 1, 0\"\n\ntab&lt;- addmargins(table(ESPOSIZIONE =  sim$exposure, OUTCOME = sim$outcome))\ntab\n\n           OUTCOME\nESPOSIZIONE  0  1 Sum\n        0   42 14  56\n        1   18 16  34\n        Sum 60 30  90\n\nOR = (tab[2,2]/tab[1,2])/(tab[2,1]/tab[1,1])\nOR\n\n[1] 2.666667\n\ntab&lt;- table(ESPOSIZIONE =  sim$exposure, OUTCOME = sim$outcome)\nptab &lt;- prop.table(tab, margin = 2)\n\nptab\n\n           OUTCOME\nESPOSIZIONE         0         1\n          0 0.7000000 0.4666667\n          1 0.3000000 0.5333333\n\nOR = (ptab[2,2]/(1-ptab[2,2]))/(ptab[2,1]/(1-ptab[2,1]))"
  },
  {
    "objectID": "STAT DESCRITTIVA AP/Senza nome.html#curva-roc-e-auc-valutare-lassociazione-tra-una-variabile-continua-e-una-condizione-binaria",
    "href": "STAT DESCRITTIVA AP/Senza nome.html#curva-roc-e-auc-valutare-lassociazione-tra-una-variabile-continua-e-una-condizione-binaria",
    "title": "Studi osservazionali e misure di associazione",
    "section": "Curva ROC e AUC: Valutare l’Associazione tra una Variabile Continua e una Condizione Binaria",
    "text": "Curva ROC e AUC: Valutare l’Associazione tra una Variabile Continua e una Condizione Binaria\n\n1. Introduzione\nQuando abbiamo una variabile numerica continua (ad esempio, livelli di colesterolo nel sangue) e vogliamo capire come questa variabile si associ a una condizione binaria (ad esempio, malato vs non malato), possiamo usare la curva ROC e l’Area Sotto la Curva (AUC) per misurare il potere discriminante della variabile continua. Questo ci permette di valutare quanto bene la variabile predice l'appartenenza a una delle due categorie.\n\nmalati &lt;- rnorm(10000,120,20 )\nsani &lt;-  rnorm(10000, 80, 20)\n\n\ndata.frame(col = c(malati, sani), ty = rep(c('malati', 'sani'), each = 10000)) -&gt; cc\n\n\n\nggplot(cc, aes(col, fill = ty))+geom_density(alpha = .5)+ggthemes::theme_base()+labs(fill = '', x = 'Colesterolo LDL (mg/dL)')\n\n\n\n\n\n\n2. Il Problema della Classificazione Basata su una Variabile Continua\nSupponiamo di avere una variabile continua come il livello di colesterolo e di voler capire quanto sia utile questo indicatore per predire la presenza di malattie cardiovascolari (CVD) in un gruppo di pazienti. I pazienti sono classificati come “malati” o “non malati” in base alla presenza o assenza di CVD.\nL'obiettivo è determinare se possiamo usare il livello di colesterolo per distinguere in modo efficace chi svilupperà malattie cardiovascolari e chi no. La curva ROC e l’AUC sono strumenti fondamentali per questo scopo.\n\n\n3. Concetto della Curva ROC per Variabili Continue\nLa curva ROC viene utilizzata per valutare un classificatore, ma in questo caso la variabile continua (ad esempio, il livello di colesterolo) viene trattata come un predittore che può assumere valori diversi. In pratica, impostiamo diverse soglie lungo la variabile continua e a ogni soglia decidiamo se classificare un individuo come “malato” o “non malato”. Per ciascuna soglia:\n\nSe il valore del colesterolo è sopra la soglia, classifichiamo il paziente come “malato”.\nSe il valore è sotto la soglia, il paziente viene classificato come “non malato”.\n\nModificando la soglia, otteniamo una serie di coppie di valori di True Positive Rate (TPR) e False Positive Rate (FPR)che tracciamo sulla curva ROC.\n\n\n4. Calcolo della Curva ROC\n\nModello senza soglia fissa: La variabile continua, come il colesterolo, non ha un valore netto che separa perfettamente i “malati” dai “non malati”. A ogni livello di colesterolo possiamo determinare una soglia diversa per decidere chi è malato.\nTPR e FPR: Per ciascuna soglia di colesterolo:\n\nIl True Positive Rate (TPR) (o sensibilità) è la proporzione di individui malati correttamente identificati come tali.\nIl False Positive Rate (FPR) è la proporzione di individui non malati erroneamente classificati come malati.\n\nCostruzione della curva ROC: Variando la soglia lungo l’intervallo di valori di colesterolo, possiamo tracciare la curva ROC, che rappresenta il compromesso tra TPR e FPR a diverse soglie.\n\n\nt = 80\nlapply(seq(70,200, 1), function(t){\n  \n  TPR &lt;- sum(cc$col&gt;=t & cc$ty == 'malati')/sum(cc$ty == 'malati')\n  FPR &lt;- sum(cc$col&gt;=t & cc$ty == 'sani')/sum(cc$ty == 'sani')\n  \n  data.frame(TPR, FPR)\n  \n})%&gt;%do.call(rbind,.) -&gt; tmp\n\nggplot(tmp, aes(FPR, TPR))+geom_step()+\n  geom_abline(slope = 1, intercept = 0, linetype = 'dotted')+\n  scale_x_continuous(limits = c(0,1))+\n  ggthemes::theme_base()\n\n\n\n\n\npar(mfrow = c(2,1))\n\nhist(cc$col[cc$ty == 'malati' & cc$col &gt; 0 & cc$col &lt;=200], breaks = seq(0,200, 10), xlab = 'Total Cholesterol (mg/dL)', main = paste0('Malati (N = ', sum(cc$ty == 'malati' & cc$col &gt; 0 & cc$col &lt;=200), ')'), axes = F)\naxis(1, at = seq(0, 200, 10))\naxis(2)\nabline(v = seq(70, 150, 10), lty = 3, col = 'purple', lwd = 2)\nabline(h = seq(0, 2000, 250), lty = 3, col = 'grey', lwd = 1)\n\n\nhist(cc$col[cc$ty == 'sani' & cc$col &gt; 0 & cc$col &lt;=200], breaks = seq(0,200, 10), xlab = 'Total Cholesterol (mg/dL)', main = paste0('Sani (N = ', sum(cc$ty == 'sani' & cc$col &gt; 0 & cc$col &lt;=200), ')'), axes = F)\naxis(1, at = seq(0, 200, 10))\naxis(2)\nabline(v = seq(70, 150, 10), lty = 3, col = 'purple', lwd = 2)\nabline(h = seq(0, 2000, 250), lty = 3, col = 'grey', lwd = 1)\n\n\n\n\n\n\n5. Interpretazione della Curva ROC per Variabili Continue\nLa forma della curva ROC ci dà un’indicazione del potere discriminante della variabile continua:\n\nSe la curva ROC si avvicina all'angolo in alto a sinistra, significa che esiste una soglia di colesterolo in grado di separare molto bene i malati dai non malati, con un TPR alto e un FPR basso.\nSe la curva ROC si avvicina alla diagonale (la linea 45° che va da (0,0) a (1,1)), significa che il colesterolo non è un buon indicatore per distinguere tra malati e non malati; il modello è poco utile perché non discrimina bene tra le due categorie.\n\n\n\n6. Area Sotto la Curva (AUC)\nL’AUC è una singola misura sintetica che quantifica la capacità discriminante della variabile continua rispetto alla condizione binaria.\n\nInterpretazione dell'AUC:\n\nAUC = 1: La variabile continua separa perfettamente malati e non malati, esiste una soglia perfetta.\nAUC = 0.5: La variabile continua è inutile per discriminare tra malati e non malati; il risultato sarebbe equivalente a indovinare a caso.\nAUC &gt; 0.8: La variabile ha una buona capacità di discriminazione.\nAUC = 0.7-0.8: Moderata capacità discriminante.\nAUC &lt; 0.7: Capacità discriminante scarsa.\n\n\n\n\n7. Esempio Pratico: Colesterolo e Malattie Cardiovascolari\nImmaginiamo uno studio che ha raccolto i livelli di colesterolo di 100 pazienti, di cui 50 hanno sviluppato malattie cardiovascolari e 50 no. Vogliamo vedere se i livelli di colesterolo sono un buon indicatore per identificare chi sviluppa malattie.\n\nStep 1: Modellazione della curva ROC: Utilizziamo diversi valori di soglia del colesterolo (ad esempio, 180 mg/dL, 200 mg/dL, 220 mg/dL) per classificare i pazienti. Per ogni soglia, calcoliamo il TPR e il FPR.\nStep 2: Tracciamento della curva ROC: Tracciamo la curva ROC in base ai valori di TPR e FPR per ciascuna soglia. Se la curva sale rapidamente verso l’alto e rimane vicina all’angolo superiore sinistro del grafico, significa che il colesterolo ha un buon potere discriminante.\nStep 3: Calcolo dell'AUC: Se l'AUC risultante è 0.85, possiamo concludere che i livelli di colesterolo hanno una buona capacità di distinguere tra pazienti malati e non malati. Se l'AUC fosse vicina a 0.5, il colesterolo non sarebbe un buon indicatore per prevedere le malattie cardiovascolari.\n\n\n\n8. Vantaggi dell’Uso della Curva ROC per Variabili Continue\n\nValutazione indipendente dalla soglia: La curva ROC permette di valutare il potere discriminante della variabile continua senza dover fissare una soglia specifica.\nConfronto tra variabili: È possibile confrontare diverse variabili (ad esempio, colesterolo vs pressione sanguigna) per vedere quale ha una migliore capacità di predizione, basandosi sull’AUC.\n\n\ntmp$var = 'T Chol'\n\nmalati &lt;- rnorm(10000, 140, 30)\nsani &lt;- rnorm(10000, 110, 30)\n\nps &lt;- data.frame(ps = c(malati, sani), ty = rep(c('malati', 'sani'), each = 10000))\n\nggplot(ps, aes(ps, fill = ty))+geom_density(alpha = .5)+ggthemes::theme_base()+labs(fill = '', x = 'PAS (mmHg)')\n\n\n\nlapply(seq(70,200, 1), function(t){\n  \n  TPR &lt;- sum(ps$ps&gt;=t & ps$ty == 'malati')/sum(ps$ty == 'malati')\n  FPR &lt;- sum(ps$ps&gt;=t & ps$ty == 'sani')/sum(ps$ty == 'sani')\n  \n  data.frame(TPR, FPR)\n  \n})%&gt;%do.call(rbind,.) -&gt; tmp2\n\nggplot(tmp2, aes(FPR, TPR))+geom_step()+\n  geom_abline(slope = 1, intercept = 0, linetype = 'dotted')+\n  scale_x_continuous(limits = c(0,1))+\n  ggthemes::theme_base()\n\n\n\ntmp2$var &lt;- 'PAS'\n\n\ncompare &lt;- rbind(tmp, tmp2)\n\nggplot(compare%&gt;%filter(FPR &lt;= 0.65), aes(FPR, TPR, col = var))+geom_step()+\n  geom_abline(slope = 1, intercept = 0, linetype = 'dotted')+\n  scale_x_continuous(limits = c(0,1))+\n  labs(col = '', fill = '')+\n  ggthemes::theme_base()+\n  coord_cartesian(xlim = c(0, .67))\n\n\n\nggplot(compare%&gt;%filter(FPR &lt;= 0.65), aes(FPR, TPR, col = var))+geom_step(lwd = 2)+\n  geom_abline(slope = 1, intercept = 0, linetype = 'dotted')+\n  scale_x_continuous(limits = c(0,1))+\n  labs(col = '', fill = '')+\n  ggthemes::theme_base()+\n  geom_ribbon(aes(ymin = 0, ymax = TPR, xmin = 0, fill = var), alpha = .2)+\n  coord_cartesian(xlim = c(0, .67))\n\n\n\n  #theme(legend.position = 'bottom')\n\n\nMisura intuitiva: L’AUC fornisce un’indicazione semplice e facilmente interpretabile della qualità del modello, o in questo caso, della variabile predittiva.\n\n\n\n9. Limiti della Curva ROC per Variabili Continue\n\nSquilibrio tra classi: Se i malati sono molto meno numerosi rispetto ai non malati, la curva ROC può risultare meno utile. In questi casi, la Precision-Recall Curve può essere più informativa.\nInterpretazione pratica della soglia: Sebbene la curva ROC e l'AUC siano utili per valutare la capacità di discriminazione, non forniscono una soglia ottimale per la classificazione. Determinare una soglia specifica richiede ulteriori considerazioni basate su altri parametri, come la prevalenza della malattia o il costo degli errori.\n\n\n\n10. Conclusione\nLa curva ROC e l'AUC sono strumenti preziosi per valutare il grado di associazione tra una variabile continua e una condizione binaria. Permettono di vedere quanto bene una variabile (come il colesterolo) possa predire un outcome binario (come lo sviluppo di malattie cardiovascolari), fornendo una rappresentazione visiva delle prestazioni a diverse soglie e una misura sintetica dell’efficacia del predittore. Tuttavia, devono essere interpretati con cautela, specialmente in contesti con classi squilibrate o in cui è necessario identificare una soglia ottimale di classificazione."
  },
  {
    "objectID": "STAT DESCRITTIVA AP/Studi osservazionali.html",
    "href": "STAT DESCRITTIVA AP/Studi osservazionali.html",
    "title": "Studi osservazionali e misure di associazione",
    "section": "",
    "text": "Code\nlibrary(dplyr)\nlibrary(ggplot2)"
  },
  {
    "objectID": "STAT DESCRITTIVA AP/Studi osservazionali.html#introduzione-agli-studi-osservazionali",
    "href": "STAT DESCRITTIVA AP/Studi osservazionali.html#introduzione-agli-studi-osservazionali",
    "title": "Studi osservazionali e misure di associazione",
    "section": "Introduzione agli Studi Osservazionali",
    "text": "Introduzione agli Studi Osservazionali\n\n1. Cos’è uno studio osservazionale?\nUno studio osservazionale è un tipo di ricerca in cui il ricercatore osserva e registra eventi o comportamenti senza intervenire direttamente. A differenza degli studi sperimentali, dove il ricercatore manipola una variabile (ad esempio somministrando un farmaco o un trattamento), negli studi osservazionali non c’è alcun intervento attivo. Il ricercatore si limita a monitorare l’andamento naturale degli eventi.\nGli studi osservazionali sono particolarmente utili quando sarebbe non etico o impraticabile condurre uno studio sperimentale. Ad esempio, non possiamo chiedere a delle persone di iniziare a fumare per vedere se sviluppano il cancro ai polmoni; tuttavia, possiamo osservare i fumatori e i non fumatori e studiare il rischio di sviluppare la malattia nel corso del tempo.\n\n\n2. Tipologie di studi osservazionali\nEsistono tre principali tipi di studi osservazionali, ciascuno con caratteristiche specifiche:\n\n2.1. Studi di coorte\nNegli studi di coorte, un gruppo di individui (la coorte) viene seguito nel tempo per osservare chi sviluppa una determinata condizione o malattia. Questi individui vengono suddivisi in base alla loro esposizione a un determinato fattore di rischio (ad esempio il fumo), e poi vengono osservati per vedere chi sviluppa l’outcome di interesse (ad esempio il cancro).\n\nEsempio: Si può seguire un gruppo di 1.000 fumatori e non fumatori per 10 anni per determinare chi sviluppa il cancro ai polmoni.\n\nUn altro esempio famoso\nGli studi di coorte possono essere:\n\nProspettici: i partecipanti vengono seguiti nel futuro, dal momento dell’inizio dello studio in avanti.\nRetrospettivi: si utilizzano dati già raccolti in passato, andando a esaminare ciò che è accaduto nel tempo ai partecipanti.\n\nVantaggi:\n\nPossono fornire stime dirette del rischio di malattia associato all’esposizione.\nPermettono di studiare molteplici outcome per una singola esposizione.\n\nLimiti:\n\nSono costosi e richiedono molto tempo, soprattutto per malattie che si sviluppano lentamente.\nPossono soffrire di perdita di partecipanti (attrition) durante il follow-up.\n\n\n\n2.2. Studi caso-controllo\nNegli studi caso-controllo, si confrontano individui che hanno già sviluppato una malattia (i casi) con individui che non hanno la malattia (i controlli), per verificare se vi siano differenze nelle esposizioni passate a determinati fattori di rischio.\n\nEsempio: Si può confrontare un gruppo di persone con infarto (casi) e un gruppo di persone senza infarto (controlli), per verificare se esiste una differenza nell’esposizione a una dieta ricca di grassi tra i due gruppi.\n\nUn altro esempio famoso\nVantaggi:\n\nIdeali per studiare malattie rare o con lunghi periodi di latenza.\nPiù veloci ed economici rispetto agli studi di coorte.\n\nLimiti:\n\nRischio di bias di richiamo: i casi potrebbero ricordare meglio le esposizioni passate rispetto ai controlli.\nNon permettono di calcolare il rischio assoluto, ma solo la odds ratio (rapporto di probabilità).\n\n\n\n2.3. Studi trasversali (cross-sectional)\nGli studi trasversali misurano contemporaneamente l’esposizione e l’outcome in un determinato momento, fornendo una “fotografia” della popolazione in quel preciso istante. Questi studi sono particolarmente utili per stimare la prevalenza di una condizione in una popolazione.\n\nEsempio: Si può condurre uno studio trasversale per valutare la prevalenza dell’obesità tra adulti che praticano attività fisica rispetto a coloro che non lo fanno.\n\nUn altro esempio famoso\nVantaggi:\n\nSono rapidi e relativamente poco costosi.\nUtili per descrivere la distribuzione delle malattie in una popolazione.\n\nLimiti:\n\nNon possono stabilire relazioni causali poiché esposizione e outcome sono misurati contemporaneamente.\nNon permettono di determinare se l’esposizione precede o segue l’outcome.\n\n\n\n\n3. Vantaggi e Limiti degli Studi Osservazionali\nGli studi osservazionali sono essenziali nella ricerca epidemiologica e nella medicina, soprattutto quando esperimenti controllati non sono fattibili o etici. Tuttavia, presentano una serie di limiti che è importante comprendere.\nVantaggi:\n\nEticamente accettabili: Permettono di studiare situazioni in cui non sarebbe etico intervenire (es. esposizioni dannose come il fumo o l’inquinamento).\nFattibili: Sono generalmente più facili da condurre rispetto agli studi sperimentali, richiedono meno risorse e spesso utilizzano dati già disponibili.\nGenerano ipotesi: Forniscono indicazioni preliminari su relazioni tra fattori di rischio e malattie che possono essere successivamente testate in studi sperimentali.\n\nLimiti:\n\nCausalità incerta: Non possono stabilire con certezza un nesso causale tra esposizione e outcome. Ad esempio, se uno studio trasversale mostra che le persone che guardano molta televisione sono più obese, non possiamo dire se la televisione causi l’obesità o se le persone obese tendano a guardare più televisione.\nConfondenti: Spesso è difficile controllare per tutti i fattori confondenti, cioè variabili che potrebbero influenzare sia l’esposizione che l’outcome. Ad esempio, l’età, il sesso o il reddito possono influenzare sia il rischio di malattia che l’esposizione a determinati fattori di rischio.\nBias: Gli studi osservazionali sono particolarmente vulnerabili a diversi tipi di bias (distorsioni), come il bias di selezione (se i partecipanti selezionati non sono rappresentativi della popolazione) e il bias di richiamo (se i partecipanti non ricordano accuratamente le esposizioni passate).\n\n\n\n4. Conclusione\nGli studi osservazionali sono uno strumento fondamentale nella ricerca medica e sociale. Offrono importanti indicazioni sulle associazioni tra fattori di rischio ed esiti di salute, permettendo ai ricercatori di generare ipotesi e di identificare tendenze nella popolazione. Tuttavia, a causa della loro natura non sperimentale, è essenziale interpretare i risultati con cautela, tenendo sempre presente la possibilità di confondenti e bias."
  },
  {
    "objectID": "STAT DESCRITTIVA AP/Studi osservazionali.html#misure-di-associazione-e-loro-interpretazione",
    "href": "STAT DESCRITTIVA AP/Studi osservazionali.html#misure-di-associazione-e-loro-interpretazione",
    "title": "Studi osservazionali e misure di associazione",
    "section": "Misure di Associazione e loro Interpretazione",
    "text": "Misure di Associazione e loro Interpretazione\nQuando conduciamo uno studio epidemiologico per esplorare la relazione tra un’esposizione (ad esempio il fumo) e un outcome di salute (ad esempio il cancro ai polmoni), è fondamentale quantificare l’associazione tra i due. Le misure di associazione ci permettono di comprendere se e quanto un’esposizione aumenta o riduce la probabilità di un determinato esito.\n\n1. Risk Ratio (Rapporto di Rischio o RR)\nIl Risk Ratio (RR), o rapporto di rischio, è una misura di associazione comunemente utilizzata negli studi di coorte. Esprime il rapporto tra il rischio di sviluppare una malattia (o un outcome) nei soggetti esposti a un fattore di rischio e il rischio nei soggetti non esposti.\n\nFormula:\n\\[RR = \\frac{Rischio \\ nei\\ soggetti \\ esposti}{Rischio \\ nei \\ soggetti \\ non \\ esposti}\\]​\n\nRischio: La probabilità che un individuo sviluppi l’outcome (ad esempio una malattia) durante un certo periodo di tempo. Si calcola come:​\n\n\\[Rischio = \\frac{Numero \\ di \\ individui \\ che \\ sviluppano \\ malattia}{Numero \\ totale \\ di \\ individui \\ esposti}\\]\n\n\nInterpretazione:\n\nRR = 1: L’esposizione non modifica il rischio rispetto ai non esposti.\nRR &gt; 1: L’esposizione aumenta il rischio di sviluppare la malattia (es. RR = 2 significa che gli esposti hanno il doppio del rischio di sviluppare la malattia rispetto ai non esposti).\nRR &lt; 1: L’esposizione riduce il rischio di sviluppare la malattia (es. RR = 0.5 indica che gli esposti hanno la metà del rischio di ammalarsi rispetto ai non esposti).\n\n\n\nEsempio:\nIn uno studio di coorte sui fumatori e il cancro ai polmoni, se 10 su 100 fumatori sviluppano il cancro e solo 2 su 100 non fumatori lo sviluppano:\n\\[\nRR = \\frac{10/100}{2/100} = 5\n\\]\nQuesto significa che i fumatori hanno un rischio 5 volte maggiore di sviluppare il cancro ai polmoni rispetto ai non fumatori.\n\n\n\n2. Odds Ratio (OR)\nL’Odds Ratio (OR), o rapporto di probabilità, è la misura più comune negli studi caso-controllo, ma può essere utilizzata anche in studi di coorte. Esprime il rapporto tra le odds (probabilità) di esposizione tra i casi (quelli che hanno sviluppato l’outcome) rispetto ai controlli (quelli che non lo hanno sviluppato).\n\nFormula:\n\\[OR = \\frac{odds \\ di \\ esposizione \\ nei \\ casi }{odds \\ di \\ esposizione \\ nei \\ controlli}\\]​\n\nOdds: La probabilità che un evento si verifichi rispetto alla probabilità che non si verifichi. Si calcola come:\n\n\\[Odds = \\frac{Numero \\  di \\ eventi}{Numero \\  di  \\ non  \\ eventi}\\]​\n\n\nInterpretazione:\n\nOR = 1: Nessuna associazione tra esposizione e outcome.\nOR &gt; 1: L’esposizione è associata a un aumento delle probabilità di sviluppare l’outcome.\nOR &lt; 1: L’esposizione è associata a una riduzione delle probabilità di sviluppare l’outcome.\n\n\n\nEsempio:\nIn uno studio caso-controllo che esamina la relazione tra dieta ricca di grassi e infarto, supponiamo che 30 casi su 50 abbiano avuto una dieta ricca di grassi, mentre tra i controlli solo 10 su 50 lo abbiano fatto:\n\\[\nOR = \\frac{30/20}{10/40} = \\frac{1.5}{0.25} = 6\n\\]\nQuesto significa che coloro che hanno una dieta ricca di grassi hanno 6 volte più probabilità di avere un infarto rispetto a quelli con una dieta a basso contenuto di grassi.\n\n\n\n3. Prevalence Ratio (PR)\nIl Prevalence Ratio (PR) è utilizzato negli studi trasversali (cross-sectional) per confrontare la prevalenza di un outcome tra individui esposti e non esposti a un determinato fattore di rischio. Misura il rapporto tra la prevalenza della malattia negli esposti rispetto ai non esposti.\n\nFormula:\n\\[\nPR = \\frac{Prevalenza \\ negli \\ esposti}{Prevalenza \\  nei \\  non \\ esposti}\n\\]\n\nPrevalenza: La proporzione di individui con una condizione o malattia in un determinato momento. Si calcola come:\n\n\\[\nPrevalenza = \\frac{Numero \\ di \\ casi \\ di \\ malattia}{Numero \\ totale \\ di \\ individui \\ nella \\ popolazione}\n\\]​\n\n\nInterpretazione:\n\nPR = 1: Nessuna differenza nella prevalenza dell’outcome tra esposti e non esposti.\nPR &gt; 1: La prevalenza dell’outcome è maggiore tra gli esposti.\nPR &lt; 1: La prevalenza dell’outcome è minore tra gli esposti.\n\n\n\nEsempio:\nIn uno studio trasversale sulla prevalenza dell’asma tra persone esposte e non esposte a inquinamento, se la prevalenza di asma è del 15% tra gli esposti e del 5% tra i non esposti:\n\\[\nPR = \\frac{0.15}{0.05}= 3\n\\]\nQuesto significa che la prevalenza dell’asma è 3 volte maggiore tra coloro che sono esposti all’inquinamento rispetto a coloro che non lo sono.\n\n\n\n4. Differenze tra Risk Ratio, Odds Ratio e Prevalence Ratio\n\nIl Risk Ratio è utilizzato principalmente negli studi di coorte, dove seguiamo i partecipanti nel tempo e possiamo calcolare il rischio di sviluppare una malattia.\nL’Odds Ratio è comune negli studi caso-controllo, dove non possiamo calcolare il rischio perché la malattia è già presente al momento della raccolta dei dati, quindi usiamo le odds (probabilità) di esposizione.\nIl Prevalence Ratio è specifico degli studi trasversali, dove valutiamo la prevalenza di una condizione in un dato momento, ma non possiamo calcolare il rischio futuro.\n\n\n\nBONUS: Rapporti fra tassi\nIl rate ratio (RR) è utilizzato negli studi longitudinali per confrontare il tasso di un outcome tra individui esposti e non esposti a un determinato fattore di rischio. Misura il rapporto tra tassi di insorgenza della malattia nel tempo negli esposti rispetto ai non esposti.\n\nFormula:\n\\[\nRR = \\frac{Tasso \\ di \\ malattia \\ negli \\ esposti}{Tasso \\ di \\ malattia \\  nei \\  non \\ esposti}\n\\]\n\nTasso di incidenza: Numero di nuovi eventi da t a t + \\(\\Delta t\\) sul totale della massa a rischio in \\(\\Delta\\). Si calcola come:\n\nLa 𝑠𝑜𝑚𝑚𝑎 𝑑𝑒𝑖 𝑡𝑒𝑚𝑝𝑖 𝑑𝑖 𝑒𝑠𝑝𝑜𝑠𝑖𝑧𝑖𝑜𝑛𝑒 𝑎𝑙 𝑟𝑖𝑠𝑐ℎ𝑖𝑜 è denominata «massa a rischio». I tempi da includere nella somma sono: Per i soggetti che si ammalano il tempo che intercorre tra l’inizio dell’osservazione e il tempo in cui è osservata per la prima volta la malattia (t a t + \\(\\Delta t\\) ). Per i soggetti che sono osservati per tutto il periodo da t a t + \\(\\Delta t\\) e che non si sono ammalati il tempo è dato da tutto il periodo (\\(\\Delta\\)) Per i soggetti che non si ammalano ma che sono usciti dall’osservazione per un tempo &lt; \\(\\Delta\\) (persi al follow-up) il tempo da t fino all’ultima osservazione. Questo permette di tenere conto in modo corretto dei soggetti con informazione incompleta. L’unità di misura è persone/tempo​.\n\n\n\nInterpretazione:\n\nRR = 1: Nessuna differenza nella tasso di incidenza dell’outcome tra esposti e non esposti.\nRR &gt; 1: Il tasso di incidenza dell’outcome è maggiore tra gli esposti.\nRR &lt; 1: Il tasso di incidenza dell’outcome è minore tra gli esposti\n\n\n\n\n5. Tabelle di contingenza\nStudio caso-controllo\n\n\nCode\nset.seed(123)\nr = .6\nsim &lt;- rbind(\ndata.frame(outcome = rep(1, 30), exposure = rbinom(30, 1, r) ),\ndata.frame(outcome = rep(0, 60), exposure = rbinom(60, 1, r/2)))\n\ntoString(sim$outcome)\n\n\n[1] \"1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0\"\n\n\nCode\ntoString(sim$exposure)\n\n\n[1] \"1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 1, 0\"\n\n\nCode\ntab&lt;- addmargins(table(ESPOSIZIONE =  sim$exposure, OUTCOME = sim$outcome))\ntab\n\n\n           OUTCOME\nESPOSIZIONE  0  1 Sum\n        0   42 14  56\n        1   18 16  34\n        Sum 60 30  90\n\n\nCode\nOR = (tab[2,2]/tab[1,2])/(tab[2,1]/tab[1,1])\nOR\n\n\n[1] 2.666667\n\n\nCode\ntab&lt;- table(ESPOSIZIONE =  sim$exposure, OUTCOME = sim$outcome)\nptab &lt;- prop.table(tab, margin = 2)\n\nptab\n\n\n           OUTCOME\nESPOSIZIONE         0         1\n          0 0.7000000 0.4666667\n          1 0.3000000 0.5333333\n\n\nCode\nOR = (ptab[2,2]/(1-ptab[2,2]))/(ptab[2,1]/(1-ptab[2,1]))"
  },
  {
    "objectID": "STAT DESCRITTIVA AP/Studi osservazionali.html#curva-roc-e-auc-valutare-lassociazione-tra-una-variabile-continua-e-una-condizione-binaria",
    "href": "STAT DESCRITTIVA AP/Studi osservazionali.html#curva-roc-e-auc-valutare-lassociazione-tra-una-variabile-continua-e-una-condizione-binaria",
    "title": "Studi osservazionali e misure di associazione",
    "section": "Curva ROC e AUC: Valutare l’Associazione tra una Variabile Continua e una Condizione Binaria",
    "text": "Curva ROC e AUC: Valutare l’Associazione tra una Variabile Continua e una Condizione Binaria\n\n1. Introduzione\nQuando abbiamo una variabile numerica continua (ad esempio, livelli di colesterolo nel sangue) e vogliamo capire come questa variabile si associ a una condizione binaria (ad esempio, malato vs non malato), possiamo usare la curva ROC e l’Area Sotto la Curva (AUC) per misurare il potere discriminante della variabile continua. Questo ci permette di valutare quanto bene la variabile predice l’appartenenza a una delle due categorie.\n\n\nCode\nmalati &lt;- rnorm(10000,120,20 )\nsani &lt;-  rnorm(10000, 80, 20)\n\n\ndata.frame(col = c(malati, sani), ty = rep(c('malati', 'sani'), each = 10000)) -&gt; cc\n\n\n\nggplot(cc, aes(col, fill = ty))+geom_density(alpha = .5)+ggthemes::theme_base()+labs(fill = '', x = 'Colesterolo LDL (mg/dL)')\n\n\n\n\n\n\n\n2. Il Problema della Classificazione Basata su una Variabile Continua\nSupponiamo di avere una variabile continua come il livello di colesterolo e di voler capire quanto sia utile questo indicatore per predire la presenza di malattie cardiovascolari (CVD) in un gruppo di pazienti. I pazienti sono classificati come “malati” o “non malati” in base alla presenza o assenza di CVD.\nL’obiettivo è determinare se possiamo usare il livello di colesterolo per distinguere in modo efficace chi svilupperà malattie cardiovascolari e chi no. La curva ROC e l’AUC sono strumenti fondamentali per questo scopo.\n\n\n3. Concetto della Curva ROC per Variabili Continue\nLa curva ROC viene utilizzata per valutare un classificatore, ma in questo caso la variabile continua (ad esempio, il livello di colesterolo) viene trattata come un predittore che può assumere valori diversi. In pratica, impostiamo diverse soglie lungo la variabile continua e a ogni soglia decidiamo se classificare un individuo come “malato” o “non malato”. Per ciascuna soglia:\n\nSe il valore del colesterolo è sopra la soglia, classifichiamo il paziente come “malato”.\nSe il valore è sotto la soglia, il paziente viene classificato come “non malato”.\n\nModificando la soglia, otteniamo una serie di coppie di valori di True Positive Rate (TPR) e False Positive Rate (FPR)che tracciamo sulla curva ROC.\n\n\n4. Calcolo della Curva ROC\n\nModello senza soglia fissa: La variabile continua, come il colesterolo, non ha un valore netto che separa perfettamente i “malati” dai “non malati”. A ogni livello di colesterolo possiamo determinare una soglia diversa per decidere chi è malato.\nTPR e FPR: Per ciascuna soglia di colesterolo:\n\nIl True Positive Rate (TPR) (o sensibilità) è la proporzione di individui malati correttamente identificati come tali.\nIl False Positive Rate (FPR) è la proporzione di individui non malati erroneamente classificati come malati.\n\nCostruzione della curva ROC: Variando la soglia lungo l’intervallo di valori di colesterolo, possiamo tracciare la curva ROC, che rappresenta il compromesso tra TPR e FPR a diverse soglie.\n\n\n\nCode\nt = 80\nlapply(seq(70,200, 1), function(t){\n  \n  TPR &lt;- sum(cc$col&gt;=t & cc$ty == 'malati')/sum(cc$ty == 'malati')\n  FPR &lt;- sum(cc$col&gt;=t & cc$ty == 'sani')/sum(cc$ty == 'sani')\n  \n  data.frame(TPR, FPR)\n  \n})%&gt;%do.call(rbind,.) -&gt; tmp\n\nggplot(tmp, aes(FPR, TPR))+geom_step()+\n  geom_abline(slope = 1, intercept = 0, linetype = 'dotted')+\n  scale_x_continuous(limits = c(0,1))+\n  ggthemes::theme_base()\n\n\n\n\n\n\n\nCode\npar(mfrow = c(2,1))\n\nhist(cc$col[cc$ty == 'malati' & cc$col &gt; 0 & cc$col &lt;=200], breaks = seq(0,200, 10), xlab = 'Total Cholesterol (mg/dL)', main = paste0('Malati (N = ', sum(cc$ty == 'malati' & cc$col &gt; 0 & cc$col &lt;=200), ')'), axes = F)\naxis(1, at = seq(0, 200, 10))\naxis(2)\nabline(v = seq(70, 150, 10), lty = 3, col = 'purple', lwd = 2)\nabline(h = seq(0, 2000, 250), lty = 3, col = 'grey', lwd = 1)\n\n\nhist(cc$col[cc$ty == 'sani' & cc$col &gt; 0 & cc$col &lt;=200], breaks = seq(0,200, 10), xlab = 'Total Cholesterol (mg/dL)', main = paste0('Sani (N = ', sum(cc$ty == 'sani' & cc$col &gt; 0 & cc$col &lt;=200), ')'), axes = F)\naxis(1, at = seq(0, 200, 10))\naxis(2)\nabline(v = seq(70, 150, 10), lty = 3, col = 'purple', lwd = 2)\nabline(h = seq(0, 2000, 250), lty = 3, col = 'grey', lwd = 1)\n\n\n\n\n\n\n\n5. Interpretazione della Curva ROC per Variabili Continue\nLa forma della curva ROC ci dà un’indicazione del potere discriminante della variabile continua:\n\nSe la curva ROC si avvicina all’angolo in alto a sinistra, significa che esiste una soglia di colesterolo in grado di separare molto bene i malati dai non malati, con un TPR alto e un FPR basso.\nSe la curva ROC si avvicina alla diagonale (la linea 45° che va da (0,0) a (1,1)), significa che il colesterolo non è un buon indicatore per distinguere tra malati e non malati; il modello è poco utile perché non discrimina bene tra le due categorie.\n\n\n\n6. Area Sotto la Curva (AUC)\nL’AUC è una singola misura sintetica che quantifica la capacità discriminante della variabile continua rispetto alla condizione binaria.\n\nInterpretazione dell’AUC:\n\nAUC = 1: La variabile continua separa perfettamente malati e non malati, esiste una soglia perfetta.\nAUC = 0.5: La variabile continua è inutile per discriminare tra malati e non malati; il risultato sarebbe equivalente a indovinare a caso.\nAUC &gt; 0.8: La variabile ha una buona capacità di discriminazione.\nAUC = 0.7-0.8: Moderata capacità discriminante.\nAUC &lt; 0.7: Capacità discriminante scarsa.\n\n\n\n\n7. Esempio Pratico: Colesterolo e Malattie Cardiovascolari\nImmaginiamo uno studio che ha raccolto i livelli di colesterolo di 100 pazienti, di cui 50 hanno sviluppato malattie cardiovascolari e 50 no. Vogliamo vedere se i livelli di colesterolo sono un buon indicatore per identificare chi sviluppa malattie.\n\nStep 1: Modellazione della curva ROC: Utilizziamo diversi valori di soglia del colesterolo (ad esempio, 180 mg/dL, 200 mg/dL, 220 mg/dL) per classificare i pazienti. Per ogni soglia, calcoliamo il TPR e il FPR.\nStep 2: Tracciamento della curva ROC: Tracciamo la curva ROC in base ai valori di TPR e FPR per ciascuna soglia. Se la curva sale rapidamente verso l’alto e rimane vicina all’angolo superiore sinistro del grafico, significa che il colesterolo ha un buon potere discriminante.\nStep 3: Calcolo dell’AUC: Se l’AUC risultante è 0.85, possiamo concludere che i livelli di colesterolo hanno una buona capacità di distinguere tra pazienti malati e non malati. Se l’AUC fosse vicina a 0.5, il colesterolo non sarebbe un buon indicatore per prevedere le malattie cardiovascolari.\n\n\n\n8. Vantaggi dell’Uso della Curva ROC per Variabili Continue\n\nValutazione indipendente dalla soglia: La curva ROC permette di valutare il potere discriminante della variabile continua senza dover fissare una soglia specifica.\nConfronto tra variabili: È possibile confrontare diverse variabili (ad esempio, colesterolo vs pressione sanguigna) per vedere quale ha una migliore capacità di predizione, basandosi sull’AUC.\n\n\n\nCode\ntmp$var = 'T Chol'\n\nmalati &lt;- rnorm(10000, 140, 30)\nsani &lt;- rnorm(10000, 110, 30)\n\nps &lt;- data.frame(ps = c(malati, sani), ty = rep(c('malati', 'sani'), each = 10000))\n\nggplot(ps, aes(ps, fill = ty))+geom_density(alpha = .5)+ggthemes::theme_base()+labs(fill = '', x = 'PAS (mmHg)')\n\n\n\n\n\nCode\nlapply(seq(70,200, 1), function(t){\n  \n  TPR &lt;- sum(ps$ps&gt;=t & ps$ty == 'malati')/sum(ps$ty == 'malati')\n  FPR &lt;- sum(ps$ps&gt;=t & ps$ty == 'sani')/sum(ps$ty == 'sani')\n  \n  data.frame(TPR, FPR)\n  \n})%&gt;%do.call(rbind,.) -&gt; tmp2\n\nggplot(tmp2, aes(FPR, TPR))+geom_step()+\n  geom_abline(slope = 1, intercept = 0, linetype = 'dotted')+\n  scale_x_continuous(limits = c(0,1))+\n  ggthemes::theme_base()\n\n\n\n\n\nCode\ntmp2$var &lt;- 'PAS'\n\n\ncompare &lt;- rbind(tmp, tmp2)\n\nggplot(compare%&gt;%filter(FPR &lt;= 0.65), aes(FPR, TPR, col = var))+geom_step()+\n  geom_abline(slope = 1, intercept = 0, linetype = 'dotted')+\n  scale_x_continuous(limits = c(0,1))+\n  labs(col = '', fill = '')+\n  ggthemes::theme_base()+\n  coord_cartesian(xlim = c(0, .67))\n\n\n\n\n\nCode\nggplot(compare%&gt;%filter(FPR &lt;= 0.65), aes(FPR, TPR, col = var))+geom_step(lwd = 2)+\n  geom_abline(slope = 1, intercept = 0, linetype = 'dotted')+\n  scale_x_continuous(limits = c(0,1))+\n  labs(col = '', fill = '')+\n  ggthemes::theme_base()+\n  geom_ribbon(aes(ymin = 0, ymax = TPR, xmin = 0, fill = var), alpha = .2)+\n  coord_cartesian(xlim = c(0, .67))\n\n\n\n\n\nCode\n  #theme(legend.position = 'bottom')\n\n\n\nMisura intuitiva: L’AUC fornisce un’indicazione semplice e facilmente interpretabile della qualità del modello, o in questo caso, della variabile predittiva.\n\n\n\n9. Limiti della Curva ROC per Variabili Continue\n\nSquilibrio tra classi: Se i malati sono molto meno numerosi rispetto ai non malati, la curva ROC può risultare meno utile. In questi casi, la Precision-Recall Curve può essere più informativa.\nInterpretazione pratica della soglia: Sebbene la curva ROC e l’AUC siano utili per valutare la capacità di discriminazione, non forniscono una soglia ottimale per la classificazione. Determinare una soglia specifica richiede ulteriori considerazioni basate su altri parametri, come la prevalenza della malattia o il costo degli errori.\n\n\n\n10. Conclusione\nLa curva ROC e l’AUC sono strumenti preziosi per valutare il grado di associazione tra una variabile continua e una condizione binaria. Permettono di vedere quanto bene una variabile (come il colesterolo) possa predire un outcome binario (come lo sviluppo di malattie cardiovascolari), fornendo una rappresentazione visiva delle prestazioni a diverse soglie e una misura sintetica dell’efficacia del predittore. Tuttavia, devono essere interpretati con cautela, specialmente in contesti con classi squilibrate o in cui è necessario identificare una soglia ottimale di classificazione."
  },
  {
    "objectID": "Stat descrittiva.html",
    "href": "Stat descrittiva.html",
    "title": "Statistica descrittiva e basi di R",
    "section": "",
    "text": "Dopo aver definito gli obiettivi dello studio si deve pianificare la raccolta delle variabili in modo tale da valutare correttamente il raggiungimento degli obiettivi e di caratterizzare il campione in studio.\nVariabili legate alla valutazione dello stato di salute del soggetto.\nSe è prevista una terapia: variabili legate alle modalità di somministrazione, eventuali modifiche di dosaggio, rilevazione di effetti collaterali, efficacia.\nVariabili che potenzialmente potrebbero influenzare lo stato di salute e/o l’efficacia della terapia.\nAltre variabili che caratterizzano il soggetto ‘’clinicamente’’ e ‘’demograficamente’’."
  },
  {
    "objectID": "Stat descrittiva.html#la-rilevazione-delle-variabili",
    "href": "Stat descrittiva.html#la-rilevazione-delle-variabili",
    "title": "Statistica descrittiva e basi di R",
    "section": "",
    "text": "Dopo aver definito gli obiettivi dello studio si deve pianificare la raccolta delle variabili in modo tale da valutare correttamente il raggiungimento degli obiettivi e di caratterizzare il campione in studio.\nVariabili legate alla valutazione dello stato di salute del soggetto.\nSe è prevista una terapia: variabili legate alle modalità di somministrazione, eventuali modifiche di dosaggio, rilevazione di effetti collaterali, efficacia.\nVariabili che potenzialmente potrebbero influenzare lo stato di salute e/o l’efficacia della terapia.\nAltre variabili che caratterizzano il soggetto ‘’clinicamente’’ e ‘’demograficamente’’."
  },
  {
    "objectID": "Stat descrittiva.html#lo-studio-clinico",
    "href": "Stat descrittiva.html#lo-studio-clinico",
    "title": "Statistica descrittiva e basi di R",
    "section": "Lo studio clinico",
    "text": "Lo studio clinico\nDati dall’articolo Associations of vitamin D status with markers of metabolic health: A community-based study in Shanghai, China\n\nVitamin D is a hormone that has long been related to bone metabolism. Recent evidence, however, has suggested links between lower vitamin D status and higher susceptibility for type 2 diabetes (T2DM) dyslipidemia, hypertension and obesity, all of which are major components of metabolic syndrome (MS).\nAims: To investigated the associations of vitamin D status (i.e., serum 25(OH)D concentration) with markers of metabolic health and metabolic syndrome (MS), as well as possible gender differences in these associations, with metabolic syndrome (MS) for a sample from Shanghai, China.\nMethods: Demographic and anthropometric data, as well as 25-hydroxyvitamin D (serum 25(OH)D), blood glucose, and lipid concentrations were obtained for 508 urban residents aged 19–70 years.\n\nQuali tra le seguenti caratteristiche sono associate alla presenza di sindrome metabolica?\n\nVitamin D status : (ng/mL)\nAge (years)\nGender (M/F)\nlifestyle: current smokers(yes/no); Alcohol use (yes/no); Sleep Duration (hours/day); Outdoor PA (hours/week)"
  },
  {
    "objectID": "Stat descrittiva.html#tipologia-delle-variabili",
    "href": "Stat descrittiva.html#tipologia-delle-variabili",
    "title": "Statistica descrittiva e basi di R",
    "section": "Tipologia delle variabili",
    "text": "Tipologia delle variabili\nLa modalità di rilevazione delle variabili indicate definisce la loro tipologia\n\nSindrome metabolica, Genere, abitudine al fumo, consumo abituale di alcool sono variabili che necessitano della definizione a priori di «categorie» entro le quali classificare la rilevazionead ogni soggetto nel momento della rilevazione è associata una ed una sola categoria\n\n\nGenere: M/F abitudine al fumo (si/no); consumo abituale di alcool (si/no); Presenza di sindrome metabolica (si/no).\n\n\nOre di sonno, ore di attività fisica, vitamina D Sono variabili numeriche che richiedono una «misura», una unità di misura e un livello di approssimazione:\n\n\nOre di sonno per notte: come calcolarle? Riportate con approssimazione a numeri interi o con decimali? E quanti? Ore di attività fisica all’aria aperta: come calcolarle? Riportate con approssimazione a numeri interi o con decimali? E quanti?"
  },
  {
    "objectID": "Stat descrittiva.html#utilità-della-statistica-descrittiva",
    "href": "Stat descrittiva.html#utilità-della-statistica-descrittiva",
    "title": "Statistica descrittiva e basi di R",
    "section": "Utilità della statistica descrittiva",
    "text": "Utilità della statistica descrittiva\n\nIdentificare le caratteristiche del campione di soggetti studiati.\nConfrontare le casistiche di diversi studi: se i risultati di diversi studi differiscono una delle cause potrebbe essere la differente composizione dei campioni per variabili clinico/biologiche rilevanti.\nIdentificare le caratteristiche delle distribuzioni delle variabili nella fase preliminare al test statistico.\nUna serie completa di dati non fornisce necessariamente informazioni facilmente interpretabili → trovare un compromesso tra sintesi ed informazioni rilevanti."
  },
  {
    "objectID": "Stat descrittiva.html#utilità-della-statistica-descrittiva-1",
    "href": "Stat descrittiva.html#utilità-della-statistica-descrittiva-1",
    "title": "Statistica descrittiva e basi di R",
    "section": "Utilità della statistica descrittiva",
    "text": "Utilità della statistica descrittiva\n1) fornire indicazioni sulla forma della distribuzione di frequenza delle variabili rilevate\n• Per le variabili categoriche e ordinali si può utilizzare una tabella di frequenza e/o una rappresentazione grafica.\n• Per le variabili numeriche discrete o continue si ricorre a rappresentazioni grafiche.\n2) sintetizzare la distribuzione mediante indici di tendenza centrale e dispersione (utilizzate nel caso di variabili su scala numerica).\n• Indici di tendenza centrale: un valore della variabile che dovrebbe essere ‘’rappresentativo’’ della distribuzione \n• Indici di dispersione: quanto sono dispersi i valori della variabile attorno alla tendenza centrale maggiore è la dispersione e minore è la ‘’rappresentatività’’ dell’indice di tendenza centrale.\n• La scelta degli indici di sintesi dipende dalla scala di misura della variabile e dalla forma della distribuzione di frequenza"
  },
  {
    "objectID": "Stat descrittiva.html#table-1",
    "href": "Stat descrittiva.html#table-1",
    "title": "Statistica descrittiva e basi di R",
    "section": "Table 1",
    "text": "Table 1\nLa prima parte di ogni articolo fornisce una sintesi dei dati per la descrizione della casistica \n\n\nCode\npkgs &lt;- c('tableone', 'dplyr', 'data.table', 'gt')\n\nlapply(pkgs, library, character.only = T)\n\ndata &lt;- read.csv2('/Users/giacomobiganzoli/Desktop/Statistica Applicata alla Ricerca Biomedica - R/zhu.csv', na = '.')\n\n\n\n\nCode\ntbl1 &lt;- data%&gt;%dplyr::select(Gender, Age, Smoking, Alcohol, Sleep, OutdoorPA, MS)%&gt;%\n  mutate(across(c(Gender, Smoking, Alcohol, MS), as.factor))\n\ncolnames(tbl1) &lt;- c('Gender', 'Age', 'Current Smoker', 'Alcohol', 'Sleep Duration (hours/day)', 'Outdoor PA (hours/week)', 'Metabolic Syndrome')\n\ntbl1 &lt;- CreateTableOne(data = tbl1)%&gt;%print(., showAllLevels = T)\n\n\n                                        \n                                         level Overall      \n  n                                              546        \n  Gender (%)                             1       164 (32.3) \n                                         2       344 (67.7) \n  Age (mean (SD))                              50.15 (13.23)\n  Current Smoker (%)                     0       409 (85.6) \n                                         1        69 (14.4) \n  Alcohol (%)                            0       443 (92.7) \n                                         1        35 ( 7.3) \n  Sleep Duration (hours/day) (mean (SD))        7.03 (1.03) \n  Outdoor PA (hours/week) (mean (SD))           9.16 (4.78) \n  Metabolic Syndrome (%)                 0       367 (76.3) \n                                         1       114 (23.7) \n\n\nPer le variabili categoriche il numero di soggetti in ogni categoria con le %\nPer le variabili numeriche la sintesi è fornita come media +/- deviazione standard\n\nCome si interpreta questo dato? Se la distribuzione è simmetrica (e bene approssimata da una Gaussiana) il 68% dei valori è compreso nell’intervallo media +/- deviazione standard\n\nMa se la variabile non ha distribuzione simmetrica e/o non è bene approssimata da una Gaussiana questa proprietà non vale. Perché scrivere allora media +/- deviazione standard?"
  },
  {
    "objectID": "Stat descrittiva.html#indici-di-tendenza-centrale",
    "href": "Stat descrittiva.html#indici-di-tendenza-centrale",
    "title": "Statistica descrittiva e basi di R",
    "section": "Indici di tendenza centrale",
    "text": "Indici di tendenza centrale\nLa media aritmetica: è sempre un buon indice di tendenza centrale?\nMedia aritmetica (scala numerica continua, numerica discreta): è calcolata sommando tutte le osservazioni e dividendo per il totale.\nutilizzando una notazione sintetica: per N osservazioni convalori \\(X_1, X_2,..,X_N, \\ media = \\frac{(X_1+X_2+...X_N)}{N} = \\sum_{i}^{N}\\frac{X_i}{N}\\)\nÈ la misura più utilizzata ma è influenzata dai valori estremi: quei valori della distribuzione che sono ‘’distanti’’ dagli altri in quanto sono decisamente maggiori (spostano la media verso valori più elevati) o decisamente minori (spostano la media verso valori più bassi).\n⚠️ Quando le distribuzioni non sono simmetriche la media non è un indice appropriato di tendenza centrale.\n\n\nCode\n# Carica le librerie necessarie\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# Numero di campioni per ogni distribuzione\nn_samples &lt;- 1000000\n\n# Parametri per la distribuzione Beta asimmetrica a destra (alpha &lt; beta)\nalpha_destra &lt;- 2\nbeta_destra &lt;- 5\n\n# Parametri per la distribuzione Beta asimmetrica a sinistra (alpha &gt; beta)\nalpha_sinistra &lt;- 5\nbeta_sinistra &lt;- 2\n\n# Genera campioni Beta asimmetrici\nbeta_asimmetrica_destra &lt;- rbeta(n_samples, shape1 = alpha_destra, shape2 = beta_destra)\nbeta_asimmetrica_sinistra &lt;- rbeta(n_samples, shape1 = alpha_sinistra, shape2 = beta_sinistra)\n\n# Crea un data frame per entrambe le distribuzioni\ndati &lt;- data.frame(\n  valore = c(beta_asimmetrica_destra, beta_asimmetrica_sinistra, rnorm(n_samples, 0.5, .5)),\n  tipo = rep(c(\"Asimmetrica a Destra\", \"Asimmetrica a Sinistra\", 'Normale'), each = n_samples)\n)\n\n# Traccia i grafici delle distribuzioni\nggplot(dati, aes(x = valore, fill = tipo)) +\n  geom_density(alpha = 0.6) +\n  facet_wrap(~tipo, scales = \"free\") +\n  labs(title = \"Distribuzioni Beta Asimmetriche a Destra e a Sinistra\",\n       x = \"Valore\", y = \"Densità\") +\n  theme_minimal()+\n  theme(legend.position = 'none')"
  },
  {
    "objectID": "Stat descrittiva.html#le-misure-di-dispersione-attorno-alla-media",
    "href": "Stat descrittiva.html#le-misure-di-dispersione-attorno-alla-media",
    "title": "Statistica descrittiva e basi di R",
    "section": "Le misure di dispersione attorno alla media",
    "text": "Le misure di dispersione attorno alla media\nDevianza, Varianza e deviazione standard\n\nutilizzano come misura di distanza dalla media lo scarto quadratico\nconsiderando le osservazioni \\(x_1,x_2...x_n\\) , la cui media è \\(\\overline{x}\\)\nLa devianza è:: \\((x_1-\\overline{x})^2 + (x_2-\\overline{x})^2 + (x_3-\\overline{x})^2+...+(x_n-\\overline{x})^2 = \\sum_i^N(x_i-\\overline{x})^2\\)\nLa varianza è ottenuta dividendo la devianza per N-1, ovvero i ‘gradi di libertà’: \\(s^2 = \\frac{(x_1-\\overline{x})^2 + (x_2-\\overline{x})^2 + (x_3-\\overline{x})^2+...+(x_n-\\overline{x})^2 }{N-1}= \\frac{\\sum_i^N(x_i-\\overline{x})^2}{N-1}\\)\nvarianza: l’unità di misura coincide con quella delle osservazioni (al quadrato), quindi non bene interpretabile, per questo si usa la deviazione standard: \\(s = \\sqrt{s^2}\\)\n\nQuando le distribuzioni non sono simmetriche la varianza non è un indice appropriato di tendenza centrale. Come la media è influenzata dai valori estemi, anche la deviazione standard è influenzata dai valori estremi (ancora più della media). In caso di asimmetria accentuata la deviazione standard è più elevata della media → Media +/- deviazione standard non ha senso dal momento che media – deviazione standard è un numero &lt; 0!"
  },
  {
    "objectID": "Stat descrittiva.html#per-valutare-se-le-distribuzioni-sono-asimmeriche-è-necessario-analizzarle-ad-esempio-rappresentarle-graficamente",
    "href": "Stat descrittiva.html#per-valutare-se-le-distribuzioni-sono-asimmeriche-è-necessario-analizzarle-ad-esempio-rappresentarle-graficamente",
    "title": "Statistica descrittiva e basi di R",
    "section": "Per valutare se le distribuzioni sono asimmeriche è necessario analizzarle, ad esempio rappresentarle graficamente",
    "text": "Per valutare se le distribuzioni sono asimmeriche è necessario analizzarle, ad esempio rappresentarle graficamente\nEtà: variabile numerica su scala discreta: infatti è misurata in «anni compiuti». Non sono possibili valori con cifre decimali ma solo interi 18,19,20,21,…..\n\n\nCode\nplot(table(data$Age), ylab  = '# times', xlab = 'Age (yrs)')\n\n\n\n\n\nOre di sonno variabile numerica su scala discreta : infatti la variabile è riportata in ore e quindi sono possibili solo valori interi, 5,6,7,8,9\n\n\nCode\nplot(table(data$Sleep), ylab  = '# times', xlab = 'Sleep (hours/day)')\n\n\n\n\n\nOre di attività fisica per settimana : è calcolata come media e quindi «in teoria» potrebbero assumere tutti i possibili valori e considerare la misura su scala continua ma in realtà sono presenti solo 4 possibili valori 1.8, 3.5, 7 e 14 quindi trattata come variabili numerica discreta.\n\n\nCode\nplot(table(data$Sleep), ylab  = '# times', xlab = 'Sleep (hours/day)')\n\n\n\n\n\nVitamina D: variabile numerica continua (assume valori decimali)\n\n\nCode\nplot(table(data$VD), ylab  = '# times', xlab = 'vitD (u/L)')\n\n\n\n\n\nCode\nhist(data$VD, breaks = 30)\n\n\n\n\n\nCode\nfor(b in seq(10,110,20)){\n   hist(data$VD, breaks = b, main = paste('# bins', b), \n        xlab = 'vitD (u/L)')\n}"
  },
  {
    "objectID": "Stat descrittiva.html#altre-misure-di-tendenza-centrale",
    "href": "Stat descrittiva.html#altre-misure-di-tendenza-centrale",
    "title": "Statistica descrittiva e basi di R",
    "section": "Altre misure di tendenza centrale",
    "text": "Altre misure di tendenza centrale\nLa media non è l’unico indice di tendenza centra le che si può considerare. In presenza di valori estremi nella distribuzione è preferibile ricorrere adun indice di tendenza centrale che sia meno influenzato dalla presenzadi valori estremi rispetto alla media (più robusto) in presenza di distribuzioni asimmetriche è preferibili ricorrere adun indice di tendenza centrale che meglio rappresenti il «centro» delladistribuzione.\nUn indice che ha tale caratteristica è la mediana"
  },
  {
    "objectID": "Stat descrittiva.html#altre-misure-di-tendenza-centrale-1",
    "href": "Stat descrittiva.html#altre-misure-di-tendenza-centrale-1",
    "title": "Statistica descrittiva e basi di R",
    "section": "Altre misure di tendenza centrale",
    "text": "Altre misure di tendenza centrale\nLa mediana (m) di un insieme finito di osservazioni è quel valore della variabile che divide l’insieme ordinato delle osservazioni in due parti in modo tale che il numero delle osservazioni che precede la mediana sia uguale al numero di osservazioni successive alla mediana. Una percentuale ≤ al 50% delle osservazioni ha valore della variabile minore della mediana e una percentuale ≤ al 50% ha valore della variabile maggiore della mediana\nper calcolarla occorre:\n\nordinare le N osservazioni in senso crescente:\n\n\nCode\nage2 &lt;- data$Age[!is.na(data$Age)]\nage2 &lt;- sort(age2)\n\n\nidentificare la posizione della mediana:\n\nse N è dispari la mediana si trova in corrispondenza della osservazione xq dove q=(N + 1)/2 → m\nse N è pari la mediana si trova al centro tra xq ed xq+1 dove q=N/2 e q+1=(N/2) + 1\n\n\n\nCode\nlength(age2) # PARI\n\n\n[1] 476\n\n\nCode\nq = length(age2)/2\nq\n\n\n[1] 238\n\n\nCode\nq1 = (length(age2)/2) +1\nq1\n\n\n[1] 239\n\n\nCalcolare la mediana m = 0.5 ∗ (xq+1 + xq)\n\n\nCode\nm = 0.5 * (age2[q] + age2[q1])\nm\n\n\n[1] 53\n\n\n\nCon R la funzione ‘median’ velocizza notevolmente il processo\n\n\nCode\nmedian(data$Age, na.rm = TRUE)\n\n\n[1] 53\n\n\nCode\nplot(table(data$Age), ylab = 'Frequency', xlab = 'Age (yrs)', main = 'In rosso la mediana della distribuzione')\nabline(v = as.character(median( data$Age, na.rm = T)), lwd = 2, col = 'red')\n\n\n\n\n\nCode\nplot(table(data$Age), ylab = 'Frequency', xlab = 'Age (yrs)', main = 'In rosso la mediana della distribuzione \\n in blu la media della distribiuzione') \nabline(v = as.character(median( data$Age, na.rm = T)), lwd = 2, col = 'red')\nabline(v = as.character(mean( data$Age, na.rm = T)), lwd = 2, col = 'blue')"
  },
  {
    "objectID": "Stat descrittiva.html#sintesi-numerica-dei-dati-le-misure-di-dispersione-attorno-alla-mediana-campo-di-variazione-interquartile",
    "href": "Stat descrittiva.html#sintesi-numerica-dei-dati-le-misure-di-dispersione-attorno-alla-mediana-campo-di-variazione-interquartile",
    "title": "Statistica descrittiva e basi di R",
    "section": "Sintesi numerica dei dati: le misure di dispersione attorno alla mediana campo di variazione interquartile",
    "text": "Sintesi numerica dei dati: le misure di dispersione attorno alla mediana campo di variazione interquartile\n• differenza tra il 3° quartile (Q3) e il 1° quartile (Q1).\nIn una situazione «ideale»\n\nQ3 è il valore che suddivide la distribuzione in modo tale che il 75% delle osservazioni è &lt; di Q3 e il 25% è maggiore di Q3\nQ1 è il valore che suddivide la distribuzione in modo tale che il 25% delle osservazioni è &lt; di Q1 e il 75% delle osservazioni è &gt; Q1\nTra Q3 e Q1 è compresa una percentuale pari al 50% delle osservazioni\n\n\n\nCode\nq1 = quantile(data$VD, probs = c(.25), na.rm = T)\nq1\n\n\n    25% \n25.7625 \n\n\nCode\nq3 = quantile(data$VD, probs = c(.75), na.rm = T)\nq3\n\n\n    75% \n34.0125 \n\n\nCode\nhist(data$VD, breaks = 30, axes = F)\naxis(1, at = round(seq(min(data$VD, na.rm = T), max(data$VD, na.rm = T), length.out = 10),2))\naxis(2)\nabline(v = q1, lwd =2, col = 'red')\nabline(v = q3, lwd =2, col = 'blue')\nabline(v = median(data$VD, na.rm = T), lwd =2, col = 'purple')"
  },
  {
    "objectID": "Stat descrittiva.html#mediana-e-quartili-per-descrivere-graficamente-le-distribuzioni-il-box-plot",
    "href": "Stat descrittiva.html#mediana-e-quartili-per-descrivere-graficamente-le-distribuzioni-il-box-plot",
    "title": "Statistica descrittiva e basi di R",
    "section": "Mediana e quartili per descrivere graficamente le distribuzioni: il ‘’box-plot’’",
    "text": "Mediana e quartili per descrivere graficamente le distribuzioni: il ‘’box-plot’’\n\n\nCode\nboxplot(data$VD, ylab = 'Vitamin D (U/L)')\n\n\n\n\n\n• è costruito dalle seguenti caratteristiche della distribuzione: il minimo, Q1, mediana, Q3, il massimo\n• la riga all’interno del box è la mediana.\n• i lati del box sono Q1 (basso) e Q3 (alto);\n• l’altezza del box è il range interquartile (Q3-Q1)\n• le linee che si estendono oltre il box (wiskers) contengono il 25% delle osservazioni e sono calcolate come segue: wb: Q1-1.5(Q3-Q1) e wa: Q3+1.5(Q3-Q1)se wb è &lt; del minimo dei dati si pone wb = al minimo dei datise wa è &gt; del massimo dei dati si pone wa = al massimo dei dati\n• i valori che si estendono oltre gli wiskers sono definiti «outliers»\nMa che utilità può avere il box-plot?\n\nevidenziare osservazioni outliers: sono dati «atipici» rispetto agli altri quindi è opportuno controllarli, potrebbero essere errori di rilevazione oppure soggetti con particolari condizioni che devono essere valutati a parte\nevidenziare se la distribuzione è simmetrica o asimmetrica: se la distribuzione è asimmetrica non è opportuno usare la media come indice di tendenza centrale, invece la mediana è comunque corretta!\nquando si confrontano due distribuzioni fornisce una indicazione sulla differenza di tendenza centrale, di dispersione e sul grado di sovrapposizione dei valori della variabile nelle due distribuzioni\n\n\nCode\ndata$MS &lt;- as.character(data$MS)\n\nboxplot(data$VD~data$MS, ylab = 'Vitamin D (U/L)', xlab = 'MetS')\n\n\n\n\n\nCode\nboxplot(data$Age~data$MS, ylab = 'Age (yrs)', xlab = 'MetS')"
  },
  {
    "objectID": "Stat descrittiva.html#le-funzioni-di-distribuzione-cumulata-per-il-confronto-tra-distribuzioni",
    "href": "Stat descrittiva.html#le-funzioni-di-distribuzione-cumulata-per-il-confronto-tra-distribuzioni",
    "title": "Statistica descrittiva e basi di R",
    "section": "Le funzioni di distribuzione cumulata per il confronto tra distribuzioni",
    "text": "Le funzioni di distribuzione cumulata per il confronto tra distribuzioni\nLa distribuzione cumulata: per ogni valore X di vit.D è la frequenza di soggetti che hanno valori di vit. D &lt;= X.\n\n\nCode\necdfDIBIC &lt;- function(x){\n  \n  x &lt;- as.data.frame(table(x))\n  x$cum.freq &lt;- cumsum(x$Freq)\n  x$perc &lt;- round(x$cum.freq/sum(x$Freq),2)\n  colnames(x)[1] &lt;- 'val'\n  x$val &lt;- as.numeric(as.character(x$val))\n  \n  x\n  \n}\n\n\necdf.age.si &lt;- ecdfDIBIC(data$Age[data$MS == 1])\necdf.age.no &lt;- ecdfDIBIC(data$Age[data$MS == 0])\n\n\nplot(ecdf.age.si$val, ecdf.age.si$perc, type = 's', lwd = 2, main = 'ECDFs of Age', \n     xlab = 'Age (yrs)',ylab = 'P(X &lt;=x)')\nlines(ecdf.age.no$val, ecdf.age.no$perc, type = 's', col = 'purple', lwd = 2)\nabline(h = c(.25, .5, .75), lty = 3)\nlegend('bottomright', c('MetS', 'No MetS'), lty = 1, col = c('black', 'purple'), \n       lwd = 2)\n\n\n\n\n\nCode\nfind.values &lt;- function(ecdf, p){\n  \n max(ecdf$val[ecdf$perc &lt;= p])\n  \n}\n\nfind.values(ecdf = ecdf.age.si, p = .75)\n\n\n[1] 63\n\n\n\n\nCode\nall &lt;- ecdfDIBIC(data$VD)\nms.si &lt;- ecdfDIBIC(data$VD[data$MS == 1])\nms.no &lt;- ecdfDIBIC(data$VD[data$MS == 0])\n\n\nplot(all$val, all$perc, type = 's', xlab = 'Vitamin D (U/L)', ylab = 'P(X &lt;= x)', lwd = 2, main = 'ECDFs of Vitamin D', axes = F)\nlines(ms.si$val, ms.si$perc, type = 's', xlab = 'Vitamin D (U/L)', ylab = '%', lwd = 2, col = 2)\nlines(ms.no$val, ms.no$perc, type = 's', xlab = 'Vitamin D (U/L)', ylab = '%', lwd = 2, col = 3)\nabline(h = c(.25, .5, .75), lty = 3)\naxis(1, at = seq(5,45,1))\naxis(2, at = seq(0,1,.05))\nlegend('bottomright', c('All', 'MetS', 'No Mets'),lty = 1, col = c(1,2,3), lwd = 2 )\n\n\n\n\n\nCode\npar(mfrow = c(1,3))\nhist(data$VD[data$MS == 1], breaks  = 30, main = 'MetS', xlab = 'Vitamin D (U/L)', axes = F)\naxis(1, at = seq(5,50,5))\naxis(2)\n\nhist(data$VD[data$MS == 0], breaks = 30, main = 'No MetS', xlab = 'Vitamin D (U/L)', axes = F)\naxis(1, at = seq(5,50,5))\naxis(2)\n\nhist(data$VD, breaks = 30, main = 'All', xlab = 'Vitamin D (U/L)', axes = F)\naxis(1, at = seq(5,50,5))\naxis(2)\n\n\n\n\n\nGrafici vietati:\nhttps://biostat.app.vumc.org/wiki/pub/Main/TatsukiRcode/Poster3.pdf"
  },
  {
    "objectID": "Stat descrittiva.html#installazione-di-r",
    "href": "Stat descrittiva.html#installazione-di-r",
    "title": "Statistica descrittiva e basi di R",
    "section": "Installazione di R",
    "text": "Installazione di R\nR è un linguaggio di programmazione open source ampiamente utilizzato per l’analisi statistica e la creazione di grafici. È stato creato da Ross Ihaka e Robert Gentleman e la sua prima versione è stata rilasciata nel 1995.\nR è diventato uno degli strumenti più popolari tra i data scientist e gli analisti dei dati, grazie alla sua vasta libreria di pacchetti che consentono di manipolare, visualizzare e analizzare grandi quantità di dati. Inoltre, la sua sintassi intuitiva e flessibile lo rende facile da imparare anche per coloro che non hanno una formazione di programmazione formale.\nOltre alla sua capacità di analisi statistica, R è anche utilizzato in diverse applicazioni come la creazione di dashboard interattivi, la creazione di report automatizzati e la costruzione di modelli di apprendimento automatico.\nInoltre, R è supportato da una vasta comunità di sviluppatori e utenti che contribuiscono alla sua crescita, alla sua manutenzione e alla creazione di nuovi pacchetti e funzionalità. Grazie a tutto questo, R è diventato uno strumento essenziale per chiunque lavori con i dati.\n\nSe non avete ancora installato R\nSe non avete ancora installato R, potete seguire questi semplici step per poterlo installare velocemente:\nCliccate su questo link\nAccederete ad una pagina come questa:\n\n\nUtilizzi Windows?\n\n\n\nAccedi al link cerchiato in rosso\n\n\n\n\n\nAccedi al link cerchiato in rosso\n\n\n\n\n\nAccedi al link cerchiato in rosso. Il download del file .exe dovrebbe partire automaticamente. Una volta scaricato, apri il file, per iniziare ad installare R sul tuo PC\n\n\n\n\nUtilizzi macOS?\n\n\n\nAccedi al link cerchiato in rosso.\n\n\n\n\n\nSe hai un Mac con processore M1 o M2 accedi al link cerchiato in rosso. Altrimenti, accedi al link cerchiato in blu\n\n\n\n\n\nAvete installato R\nUna volta installato correttamente R, apritelo. Vi si aprirà una finestra, definita console, di questo tipo:\n\nProvate a digitare nella console, dopo il simbolo ‘&gt;’, questo codice:\n\n\nCode\nplot(c(1,2,3,4))\n\n\n\n\n\nSe vi appare un grafico come quello sopra riportato, allora avete installato R in modo corretto e siete pronti per poterlo utilizzare in classe! 🤘"
  },
  {
    "objectID": "Stat descrittiva.html#installare-rstudio",
    "href": "Stat descrittiva.html#installare-rstudio",
    "title": "Statistica descrittiva e basi di R",
    "section": "Installare RStudio",
    "text": "Installare RStudio\nUn altro programma molto utile per interfacciarsi con R è RStudio.\n\nRStudio is an integrated development environment for R, a programming language for statistical computing and graphics. It is available in two formats: RStudio Desktop is a regular desktop application while RStudio Server runs on a remote server and allows accessing RStudio using a web browser.\n\nPer installare R Studio in modo semplice cliccate questo link e seguite le istruzioni che sono descritte nella pagina.\n❗ Se avete già installato R, non dovete far altro che seguire lo step 2 ed installe RStudio.\n\nUna volta scaricato ed installato, se aprirete RStudio accederete ad una pagina di questo tipo:"
  },
  {
    "objectID": "Stat descrittiva.html#non-esitare-a-contattarmi-per-evenutali-domande-eo-problemi-di-installazione",
    "href": "Stat descrittiva.html#non-esitare-a-contattarmi-per-evenutali-domande-eo-problemi-di-installazione",
    "title": "Statistica descrittiva e basi di R",
    "section": "📧 Non esitare a contattarmi per evenutali domande e/o problemi di installazione!📧",
    "text": "📧 Non esitare a contattarmi per evenutali domande e/o problemi di installazione!📧\nGiacomo: giacomo.biganzoli@unimi.it"
  },
  {
    "objectID": "Stat descrittiva.html#introduzione-al-linguaggio-di-r",
    "href": "Stat descrittiva.html#introduzione-al-linguaggio-di-r",
    "title": "Statistica descrittiva e basi di R",
    "section": "Introduzione al linguaggio di R",
    "text": "Introduzione al linguaggio di R\n\n\nScript: oggetti e funzioni\nGeneralmente, per poter importare ed analizzare i dati che avete accuratamente raccolto, scriverete un ‘programma’ in uno script. Un programma non è altro che un elenco di oggetti e funzioni che devono essere eseguite per ottenere i risultati desiderati. Lo script viene successivamente eseguito ed interpretato da R in modo tale da ottenere i risultati richiesti.\nI principali tipi di oggetti in R sono:\n\nstringhe di caratteri\nvettori\nmatrici\nliste\ndata.frames\n\nL’oggetto che più utilizzeremo sarà il data.frame. Pensate al data.frame come la forma di dati tabulati che trovereste se apriste un comunissimo file .xlsx o .csv in Excel.\nIn R, le funzioni servono a ‘trasformare’ un oggetto in un altro oggetto all’interno dell’ambiente R. R è ricco di funzioni di base e funzioni scritte da esperti per poter fare una miriade di cose. Inolte, in R è possibile scrivere le proprie funzioni (solo per utilizzatori avanzati!).\nAd esempio, digitando nello script il seguente codice, assegno ad un oggetto che chiamo boomer la stringa di caratteri ‘I am smiling because i am using R’. Se successivamente applico la funzione print() all’oggetto boomer, R stampa cosa è assegnato a boomer.\n\n\nCode\nboomer &lt;- \"I am smiling because i am using R\" # assegno all'oggetto boomer una stringa di caratteri\n\nprint(boomer) # eseguo il print dell'oggetto per vedere cosa riporta\n\n\n[1] \"I am smiling because i am using R\"\n\n\nSe invece consideriamo un vettore, inteso come una sequenza di valori numerici o di caratteri, possono essere utili altre funzioni. Ad esempio, pensate di intervistare cinque vostri colleghi per chiedere loro quante visite ospedaliere hanno eseguito negli ultimi 5 anni. I cinque colleghi vi rispondono nel seguente modo:\n\n5 visite\n3 visite\n2 visite\n1 visita\n0 visite\n\nAllora possiamo assegnare all’oggetto visite un vettore definito in questo modo:\n\n\nCode\nvisite = c(5,3,2,1,0) # genero un nuovo vettore 'visite'\nprint(visite) # guardo cosa contiene il vettore 'visite'\n\n\n[1] 5 3 2 1 0\n\n\nSe ad esempio sono interessato al totale delle visite dei cinque colleghi intervistati, posso applicare al vettore visite la funzione sum()\n\n\nCode\nsum(visite) # applico la funzione sum() per calcolare il totale delle visite dei cinque colleghi\n\n\n[1] 11\n\n\nSe invece fossi interessato alla media del numero di visite dei cinque colleghi intervistati, posso applicare a visite la funzione mean()\n\n\nCode\nmean(visite) # applico la funzione mean() per calcolare il totale delle visite dei cinque colleghi\n\n\n[1] 2.2\n\n\n❗ questi ultimi due calcoli (totale con la funzione sum() e media con la funzione mean() ) non sono stati assegnati ad alcun oggetto. Se nella nostra sessione di analisi volessimo utilizzare nuovamente la media e il totale delle visite, possiamo assegnare a due nuovi oggetti, rispettivamente mean_visite e tot_visite, il calcolo della media e del totale del numero di visite.\n\n\nCode\nmean_visite &lt;- mean(visite) # assegno all'oggetto mean_visite il calcolo della media del vettore visite\ntot_visite = sum(visite) # assegno all'oggetto tot_visite il calcolo del totale del vettore visite\n\nprint(mean_visite)\n\n\n[1] 2.2\n\n\nCode\nprint(tot_visite)\n\n\n[1] 11\n\n\nSe fossi interessato, per qualche motivo particolare, a calcolare la differenza tra tot_visite e mean_visite, allora, semplicemente, potrei digitare il codice:\n\n\nCode\ntot_visite - mean_visite # faccio la differenza tra totale e media\n\n\n[1] 8.8\n\n\ne assegnare a diff_visite questo calcolo:\n\n\nCode\ndiff_visite = tot_visite - mean_visite # assego ad un oggetto diff_visite la differenza tra totale e media. \nprint(diff_visite)\n\n\n[1] 8.8\n\n\n⚠️ Probabilmente avrete notato che per assegnare vettori o stringhe di caratteri ad oggetti utilizzo indistintamente il simbolo ‘=’ o il simbolo ‘&lt;-’. Nonostante l’utilizzo di uno o dell’altro simbolo abbia generato grande dibattito fra i vari R nerds nel mondo:\n\nNoi d’ora in poi, per comodità, utilizzeremo il simbolo ‘=’.\n⚠️ Inoltre, avrete notato che dopo ogni codice scritto, segue quasi sempre un commento al codice preceduto da un #. E buona norma commentare il codice scritto. Questo perché, se in futuro vorrete riprendere il codice per le analisi oppure inviarlo ad un collega per farlgielo utilizzare, saprete perché era stata utilizzata tale funzione, o perché era stato creato tale oggetto etc etc…\n\nbonus!\nIn R le funzioni, come in matematica, si possono concatenare! Questo vuol dire che se volessi applicare ad uno stesso oggetto (A) più di una funzione (f() e g() ), al posto di creare e salvare due o più oggetti per applicare in sequenza le funzioni, potrei concatenarle in questo modo:\ng( f(A) )\nEsempio:\nSupponiamo di aver misurato e raccolto i dati della massa corporea in kg di 5 soggetti in un vettore weight così definito c(64.679, 78.943, 60.321, 90.453, 112.765). Se volessi arrotondare i valori della massa corporea alla sola cifra intera (considerando solo i kg) e poi volessi calcolare la media dei valori, allora potrei fare in questo modo:\n\n\nCode\nweight = c(64.679, 78.943, 60.321, 90.453, 112.765) # assegno al vettore weight i valori di massa corporea\n\nmean(round(weight)) # arrotondo a numeri interi e poi eseguo la media \n\n\n[1] 81.4\n\n\n❗ L’ordine in cui applichiamo le funzioni conta. Se invertissimo l’ordine delle funzioni, il valore ottenuto è diverso:\n\n\nCode\nround(mean(weight)) # eseguo la media e poi arrotondo a numeri interi \n\n\n[1] 81\n\n\n\n\nAlcune funzioni essenziali:\nLe funzioni help(), ls(), install.packages() e library(), sono quattro funzioni essenziali. La prima serve per interrogare R sul tipo di funzioni che stiamo utilizzando. Ad esempio, se trovo la funzione mean() ma non riesco a capire cosa voglia dire e/o cosa serva, allora posso utilizzare la funzione help() al cui interno digito il nome della funzione a me sconosciuta (senza le due parentesi).\n\n\nCode\nhelp(\"mean\")\n\n\nLa funzione ls() invece mi serve per vedere quali sono gli oggetti che ho salvato nella workspace di R. Sopratutto in caso di codici molto lunghi, non possiamo memorizzare tutto quello che abbiamo creato!\nSe utilizzo la funzione ls(), R mi stamperà tutti gli oggetti salvati nella workspace\n\n\nCode\nls()\n\n\n [1] \"age2\"                      \"all\"                      \n [3] \"alpha_destra\"              \"alpha_sinistra\"           \n [5] \"b\"                         \"beta_asimmetrica_destra\"  \n [7] \"beta_asimmetrica_sinistra\" \"beta_destra\"              \n [9] \"beta_sinistra\"             \"boomer\"                   \n[11] \"data\"                      \"dati\"                     \n[13] \"diff_visite\"               \"ecdf.age.no\"              \n[15] \"ecdf.age.si\"               \"ecdfDIBIC\"                \n[17] \"find.values\"               \"has_annotations\"          \n[19] \"m\"                         \"mean_visite\"              \n[21] \"ms.no\"                     \"ms.si\"                    \n[23] \"n_samples\"                 \"pkgs\"                     \n[25] \"q\"                         \"q1\"                       \n[27] \"q3\"                        \"tbl1\"                     \n[29] \"tot_visite\"                \"visite\"                   \n[31] \"weight\"                   \n\n\nLa funzione install.packages() mi permette di installare pacchetti di funzioni in aggiunta a quelli pre-installati, così da poter utilizzare qualsiasi tipo di funzione non di base. La funzione library() invece mi serve per caricare i nuovi pacchetti installati.\nAd esempio, voglio installare il pacchetto dplyr e caricarlo nella workspace.\n\n\nCode\n#install.packages('dplyr') #installo il pacchetto dplyr\nlibrary(dplyr) # carico il pacchetto dplyr nella workspace cosi che è pronto per poter essere utilizzato\n\n\nIn questa piccola sezione, vi abbiamo mostrato poche delle migliaia funzioni disponibili in R. Nel corso della Sessione 1, e nella prossima sessione, avremo modo di indicarvi ulteriori funzioni utili per l’analisi dei dati. Lungi da noi riuscire ad esaurire in poche ore tutte le funzioni disponibili per poter analizzare i vostri dati. Ma uno strumento fondamentale che potete utilizzare gratuitamente sul web è:\n\nUn website dove vengono raccolte domande e risposte degli users di R (e non solo), cui potete fare riferimento qualora aveste dei problemi con il vostro codice, ma sopratutto voleste informazioni sull’esistenza di una data funzione. Molto spesso, le domande e/o i problemi sopraggiunti, sono già capitati ad altri users come voi!"
  },
  {
    "objectID": "Stat descrittiva.html#caricare-i-dati-su-r",
    "href": "Stat descrittiva.html#caricare-i-dati-su-r",
    "title": "Statistica descrittiva e basi di R",
    "section": "Caricare i dati su R",
    "text": "Caricare i dati su R\nOra passiamo all’aspetto più importante e per alcuni il più tedioso: caricare in maniera pulita e veloce i dati che avete raccolto. Da REDCap avrete modo di scaricare i dati in forma tabulata in formato .csv, .xls, .xlsx, o txt. Il consiglio che vi diamo è di preferire il formato .txt per leggere i dati.\nCome potete immaginare, in R esistono numerose funzioni per leggere i dati in ogni formato. Tra queste si annovera una funzione principale che è quella universalmente più performante, proveniente dal pacchetto utils, chiamata read.table(). La funzione legge un file in formato tabulato e ne crea un frame di dati, con i casi corrispondenti alle righe e le variabili alle colonne del file. La funzione ha i seguenti parametri:\n\nLa compilazione di questi parametri è obbligatoria, di altri è solo facoltativa.\n\n\n\n\n\n\n\nParametro\nUtilizzo\n\n\n\n\nfile\nIl percorso e il nome del file da cui leggere i dati. Ogni riga della tabella appare come una riga del file.\n\n\nheader\nun valore logico che indica se il file contiene i nomi delle variabili come prima riga. Se manca, il valore è determinato dal formato del file: header è impostato su TRUE se e solo se la prima riga contiene una colonna in meno rispetto al numero di colonne per le altre righe.\n\n\nsep\nIl carattere di separazione delle colonne. I valori su ogni riga del file sono separati da questo carattere. Se sep = “” (l’impostazione predefinita per read.table) il separatore è uno “spazio bianco”, cioè uno o più spazi, tabulazioni, newline o ritorni a capo.\n\n\ndec\nil carattere utilizzato nel file per i punti decimali.\n\n\nrow.names\nun vettore di nomi di righe. Può essere un vettore con i nomi effettivi delle righe, oppure un numero singolo con la colonna della tabella che contiene i nomi delle righe, o una stringa di caratteri con il nome della colonna della tabella che contiene i nomi delle righe.\nSe esiste un’intestazione e la prima riga contiene un campo in meno rispetto al numero di colonne, per i nomi delle righe viene utilizzata la prima colonna dell’input. Altrimenti, se row.names manca, le righe vengono numerate.\n\n\ncol.names\nun vettore di nomi opzionali per le variabili. L’impostazione predefinita prevede l’uso di “V” seguito dal numero della colonna.\n\n\nskip\nil numero di righe da ‘saltare’ prima che il programma legga i dati\n\n\ncolClasses\ncarattere. Un vettore di classi da assumere per le colonne. Se non ha nome, viene riciclato come necessario. Se con nome, i nomi vengono abbinati e i valori non specificati vengono considerati NA.\n\n\n\nLa prima cosa da controllare sarà il path del file in cui è salvato il vostro file .txt. Questo perché dovrete specificarlo nel parametro file. Su Windows e MacOS le cose funzionano differentemente.\nSu Windows il path va specificato in questo modo:\n\nC:\\\\path\\\\to\\\\directory\\\\file.txt\n\nSu MacOS il path va specificato in questo modo:\n\n/path/to/directory/file.txt\n\nAttualmente su questo computer sto utilizzando MacOS, per questo caricherò i dati con i seguenti comandi:\n\ncreo un oggetto path di tipo stringa di caratteri in cui viene specificato il percorso dove si trova il file da caricare.\nUso la funzione read.table() dove:\n\nal parametro file è assegnato l’oggetto path;\nal parametro header è assegnato il valore TRUE, in modo tale da leggere la prima riga del file come se fosse l’intestazione delle variabili;\nal parametro sep è assegnato il valore ‘\\t’ .\n\n\n\n\nCode\nlibrary(dplyr)\npath = '/Users/giacomobiganzoli/Desktop/Statistica Applicata alla Ricerca Biomedica - R/datiesercitazione.txt' # genero un oggetto che descrive il percorso dove è situato il file\ndata = read.table(path, header = TRUE, sep = \" \", stringsAsFactors = FALSE)\n # utilizzo la funzione read.table per caricare i dati \n\n#View(data) # visualizzo i dati in modo più chiaro\n\n\n\nAlcune funzioni utili per avere informazioni sul dataset caricato\nSegue un elenco di alcune funzioni utili una volta che i nostri dati sono stati caricati:\n\nfunzione dim(): serve per ottenere il numero di righe (soggetti e/o misurazioni) e colonne (variabili) del dataset\n\n\nCode\ndim(data)\n\n\n[1] 418  46\n\n\nfunzione str(): serve per ottenere velocemente un riassunto su come sono strutturati i dati\n\n\nCode\nstr(data)\n\n\n'data.frame':   418 obs. of  46 variables:\n $ ID          : int  1001 1002 1003 1004 1005 1006 1007 1008 1009 1010 ...\n $ entry_date  : chr  \"1977-04-01\" \"1976-01-11\" \"1978-11-18\" \"1980-08-13\" ...\n $ bili        : num  14.5 1.1 1.4 1.8 3.4 0.8 1 0.3 3.2 12.6 ...\n $ albumin     : num  2.6 4.14 3.48 2.54 3.53 3.98 4.09 4 3.08 2.74 ...\n $ stage       : int  4 3 4 4 3 3 3 3 2 4 ...\n $ protime     : num  12.2 10.6 12 10.3 10.9 11 9.7 11 11 11.5 ...\n $ sex         : chr  \"female\" \"female\" \"male\" \"female\" ...\n $ age         : num  58.8 56.4 70.1 54.7 38.1 ...\n $ spiders     : chr  \"present\" \"present\" \"absent\" \"present\" ...\n $ hepatom     : chr  \"present\" \"present\" \"absent\" \"present\" ...\n $ ascites     : chr  \"present\" \"absent\" \"absent\" \"absent\" ...\n $ alk.phos    : num  1718 7395 516 6122 671 ...\n $ sgot        : num  137.9 113.5 96.1 60.6 113.2 ...\n $ chol        : int  261 302 176 244 279 248 322 280 562 200 ...\n $ trig        : int  172 88 55 92 72 63 213 189 88 143 ...\n $ platelet    : int  190 221 151 183 136 NA 204 373 251 302 ...\n $ drug        : chr  \"placebo\" \"placebo\" \"placebo\" \"placebo\" ...\n $ edema       : chr  \"edema despite diuretic therapy\" \"no edema\" \"edema, no diuretic therapy\" \"edema, no diuretic therapy\" ...\n $ copper      : int  156 54 210 64 143 50 52 52 79 140 ...\n $ date_t1     : chr  \"1977-09-30\" \"1976-07-11\" \"1979-05-19\" \"1981-02-11\" ...\n $ bili_t1     : num  14.61 1.95 1.72 2.41 3.46 ...\n $ albumin_t1  : num  2.44 4.01 3.31 2.37 3.46 ...\n $ protime_t1  : num  12.1 10.4 12 10.2 10.7 ...\n $ alk.phos_t1 : num  1585 7311 613 6210 485 ...\n $ platelet_t1 : num  198 232 157 186 108 ...\n $ copper_t1   : num  172.4 65 223 78.4 196.9 ...\n $ date_t2     : chr  \"1978-04-01\" \"1977-01-10\" \"1979-11-18\" \"1981-08-13\" ...\n $ bili_t2     : num  15.74 2.04 1.48 2.92 4.97 ...\n $ albumin_t2  : num  2.39 3.95 3.27 2.39 3.41 ...\n $ protime_t2  : num  12.1 10.3 11.8 10.1 10.9 ...\n $ alk.phos_t2 : num  1774 7256 486 6035 523 ...\n $ platelet_t2 : num  210.1 241.2 164.3 198.5 80.5 ...\n $ copper_t2   : num  185.4 84.8 241.4 86.8 249.1 ...\n $ bili_t3     : num  NA 2.17 2.61 3.6 5.97 ...\n $ albumin_t3  : num  NA 3.73 3.05 2.11 3.34 ...\n $ protime_t3  : num  NA 10.13 11.56 9.84 10.98 ...\n $ alk.phos_t3 : num  NA 7287 409 6183 621 ...\n $ platelet_t3 : num  NA 228.6 165 199.1 83.2 ...\n $ copper_t3   : num  NA 105 263 111 352 ...\n $ fu.days     : int  400 4500 1012 1925 1504 2503 1832 2466 2400 51 ...\n $ status      : int  1 0 1 1 0 1 0 1 1 1 ...\n $ ast.UL      : num  26.3 19.1 17.6 10.8 28.5 ...\n $ gamma.g.g_dL: num  0.765 0.76 1.479 1.368 1.26 ...\n $ ibd_0_1     : int  0 0 0 0 0 0 0 0 0 0 ...\n $ hepB.ant_0_1: int  0 0 0 0 0 0 0 0 0 0 ...\n $ mal.cond_0_1: int  0 0 0 0 0 0 0 0 0 0 ...\n\n\n\n\n\nfunzione summary(): serve per ottenere velocemente un riassunto dei dati\n❗molto utile quando le variabili nel dataset sono già nel formato corretto\n\n\nCode\nsummary(data)\n\n\n       ID        entry_date             bili           albumin     \n Min.   :1001   Length:418         Min.   : 0.300   Min.   :1.960  \n 1st Qu.:1105   Class :character   1st Qu.: 0.800   1st Qu.:3.243  \n Median :1210   Mode  :character   Median : 1.400   Median :3.530  \n Mean   :1210                      Mean   : 3.221   Mean   :3.497  \n 3rd Qu.:1314                      3rd Qu.: 3.400   3rd Qu.:3.770  \n Max.   :1418                      Max.   :28.000   Max.   :4.640  \n\n     stage          protime          sex                 age       \n Min.   :1.000   Min.   : 9.00   Length:418         Min.   :26.28  \n 1st Qu.:2.000   1st Qu.:10.00   Class :character   1st Qu.:42.83  \n Median :3.000   Median :10.60   Mode  :character   Median :51.00  \n Mean   :3.024   Mean   :10.73                      Mean   :50.74  \n 3rd Qu.:4.000   3rd Qu.:11.10                      3rd Qu.:58.24  \n Max.   :4.000   Max.   :18.00                      Max.   :78.44  \n NA's   :6       NA's   :2                                         \n   spiders            hepatom            ascites             alk.phos      \n Length:418         Length:418         Length:418         Min.   :  289.0  \n Class :character   Class :character   Class :character   1st Qu.:  871.5  \n Mode  :character   Mode  :character   Mode  :character   Median : 1259.0  \n                                                          Mean   : 1982.7  \n                                                          3rd Qu.: 1980.0  \n                                                          Max.   :13862.4  \n                                                          NA's   :106      \n      sgot             chol             trig           platelet    \n Min.   : 26.35   Min.   : 120.0   Min.   : 33.00   Min.   : 62.0  \n 1st Qu.: 80.60   1st Qu.: 249.5   1st Qu.: 84.25   1st Qu.:199.8  \n Median :114.70   Median : 309.5   Median :108.00   Median :257.0  \n Mean   :122.56   Mean   : 369.5   Mean   :124.70   Mean   :261.9  \n 3rd Qu.:151.90   3rd Qu.: 400.0   3rd Qu.:151.00   3rd Qu.:322.5  \n Max.   :457.25   Max.   :1775.0   Max.   :598.00   Max.   :563.0  \n NA's   :106      NA's   :134      NA's   :136      NA's   :110    \n     drug              edema               copper         date_t1         \n Length:418         Length:418         Min.   :  4.00   Length:418        \n Class :character   Class :character   1st Qu.: 41.25   Class :character  \n Mode  :character   Mode  :character   Median : 73.00   Mode  :character  \n                                       Mean   : 97.65                     \n                                       3rd Qu.:123.00                     \n                                       Max.   :588.00                     \n                                       NA's   :108                        \n    bili_t1           albumin_t1      protime_t1      alk.phos_t1     \n Min.   :-0.00827   Min.   :1.902   Min.   : 8.822   Min.   :  145.3  \n 1st Qu.: 1.28905   1st Qu.:3.228   1st Qu.: 9.916   1st Qu.:  828.2  \n Median : 1.96624   Median :3.480   Median :10.462   Median : 1184.6  \n Mean   : 3.44642   Mean   :3.461   Mean   :10.619   Mean   : 1940.2  \n 3rd Qu.: 3.85341   3rd Qu.:3.732   3rd Qu.:11.030   3rd Qu.: 1920.8  \n Max.   :28.86766   Max.   :4.455   Max.   :16.986   Max.   :13777.5  \n NA's   :115        NA's   :115     NA's   :115      NA's   :115      \n  platelet_t1       copper_t1        date_t2             bili_t2       \n Min.   : 48.63   Min.   : 19.37   Length:418         Min.   : 0.3688  \n 1st Qu.:189.43   1st Qu.: 75.64   Class :character   1st Qu.: 1.6899  \n Median :249.66   Median :103.38   Mode  :character   Median : 2.3806  \n Mean   :255.19   Mean   :127.27                      Mean   : 3.6885  \n 3rd Qu.:317.14   3rd Qu.:161.36                      3rd Qu.: 3.9851  \n Max.   :564.97   Max.   :611.97                      Max.   :29.6606  \n NA's   :119      NA's   :117                         NA's   :128      \n   albumin_t2      protime_t2      alk.phos_t2       platelet_t2   \n Min.   :1.850   Min.   : 8.886   Min.   :  173.9   Min.   : 43.8  \n 1st Qu.:3.168   1st Qu.: 9.818   1st Qu.:  753.5   1st Qu.:179.4  \n Median :3.416   Median :10.347   Median : 1161.2   Median :242.7  \n Mean   :3.399   Mean   :10.480   Mean   : 1853.2   Mean   :250.2  \n 3rd Qu.:3.661   3rd Qu.:10.896   3rd Qu.: 1865.6   3rd Qu.:314.0  \n Max.   :4.410   Max.   :16.954   Max.   :13738.8   Max.   :581.7  \n NA's   :128     NA's   :128      NA's   :128       NA's   :132    \n   copper_t2         bili_t3         albumin_t3      protime_t3    \n Min.   : 34.59   Min.   : 1.178   Min.   :1.819   Min.   : 8.637  \n 1st Qu.: 93.12   1st Qu.: 2.556   1st Qu.:3.023   1st Qu.: 9.700  \n Median :144.87   Median : 3.256   Median :3.277   Median :10.107  \n Mean   :155.40   Mean   : 4.530   Mean   :3.252   Mean   :10.303  \n 3rd Qu.:192.12   3rd Qu.: 5.052   3rd Qu.:3.499   3rd Qu.:10.714  \n Max.   :491.80   Max.   :29.943   Max.   :4.195   Max.   :17.141  \n NA's   :130      NA's   :140      NA's   :140     NA's   :140     \n  alk.phos_t3       platelet_t3       copper_t3         fu.days    \n Min.   :  121.1   Min.   : 44.27   Min.   : 54.14   Min.   :  41  \n 1st Qu.:  752.3   1st Qu.:179.13   1st Qu.:116.94   1st Qu.:1093  \n Median : 1082.4   Median :243.87   Median :229.39   Median :1730  \n Mean   : 1867.7   Mean   :251.61   Mean   :216.82   Mean   :1918  \n 3rd Qu.: 1878.4   3rd Qu.:315.28   3rd Qu.:285.34   3rd Qu.:2614  \n Max.   :13620.4   Max.   :581.30   Max.   :574.17   Max.   :4795  \n NA's   :140       NA's   :144      NA's   :142                    \n     status           ast.UL        gamma.g.g_dL       ibd_0_1       \n Min.   :0.0000   Min.   : 10.24   Min.   :0.7008   Min.   :0.00000  \n 1st Qu.:0.0000   1st Qu.: 16.82   1st Qu.:0.9148   1st Qu.:0.00000  \n Median :0.0000   Median : 23.04   Median :1.1605   Median :0.00000  \n Mean   :0.3852   Mean   : 51.71   Mean   :1.2726   Mean   :0.04785  \n 3rd Qu.:1.0000   3rd Qu.: 31.42   3rd Qu.:1.4061   3rd Qu.:0.00000  \n Max.   :1.0000   Max.   :395.99   Max.   :3.9975   Max.   :1.00000  \n\n  hepB.ant_0_1      mal.cond_0_1    \n Min.   :0.00000   Min.   :0.00000  \n 1st Qu.:0.00000   1st Qu.:0.00000  \n Median :0.00000   Median :0.00000  \n Mean   :0.04785   Mean   :0.04785  \n 3rd Qu.:0.00000   3rd Qu.:0.00000  \n Max.   :1.00000   Max.   :1.00000"
  },
  {
    "objectID": "Stat descrittiva.html#controllo-congruenza-dati",
    "href": "Stat descrittiva.html#controllo-congruenza-dati",
    "title": "Statistica descrittiva e basi di R",
    "section": "Controllo congruenza dati",
    "text": "Controllo congruenza dati\nIl dataset caricato si riferisce ai dati dello studio Mayo Clinic trial on penicillamine in advanced primary biliary cirrhosis su cui avete lavorato in precedenza. Un breve recap:\n\nBackground:\nPrimary biliary cirrhosis, a chronic liver disease of unknown cause, is characterized by inflammation and necrosis  of intrahepatic bile ducts, cholestesis, cirrhosis, and hepatic failure. The primary pathologic event appears to be destruction of the interlobular bile ducts, which may be mediated by immunologic mechanisms. Increased hepatic copper concentrations, found primarily in advanced disease (stages 3,4) are secondary to progressive intrahepatic colestasis and diminished hepatobiliary clearance of copper. There is no effective treatment for primary biliary cirrhosis, and the medical approach to patients with the disease has been limited to supportive care.\n   On the basis of the drug’s ability to increase urinary copper excretion and to inhibit tropocollagen synthesis, perhaps thereby diminishing fibrosis, and of its potential immunosuppressive properties, we initiated a long term prospective, double-blind, controlled trial to investigate whether penicillamine (D-penicillamine) is more effective than placebo in patients with primary biliary cirrhosis. Patients with early disease (histologic stage 1,2) will remain in the trial, and their response to penicillamine will be reported later, after longer observation.\n\nDopo aver caricato i dati e prima di procedere in qualsiasi tipo di analisi, è fondamentale controllare che tutti i dati siano stati raccolti e importati in modo congruo e che non ci siano errori. Anche se i dati che avete raccolto sono stati scaricati direttamente da REDCap e quindi le possibilità di errori nella compilazione del database erano minime, è comunque necessario verificare che tutti i dati siano corretti.\nFacciamo riferimento alle linee guida CONSORT. Siamo al riguadro cerchiato in viola del flowchart riportato nelle linee guida.\nSupponete di dover controllare che i criteri di inclusione dello studio siano stati tutti rispettati correttamente.\n\n\nEligibility:\nPeople with estabilished disease of more than six months duration, with a serum level of alkaline phosphatase more than 2.5 times the normal level, and a pre-entry liver biopsy considered to be diagnostic of primary biliary cirrhosis.\nReasons for the exclusion from the study:\n- serum level of aspartate aminotransferase more than 10 times the normal level\n- serum level of aspartate aminotransferase more than 5 times the normal level and gamma globulin more than twice the normal level\n- evidence of inflammatory bowel disease\n- a malignant condition other than skin cancer\n- evidence of extrahepatic obstruction\n- use of cholestatic or epatotoxic drugs or excessive alcohol intake\n- presence of hepatitis B surface antigen\n\nI soggetti che sono stati inclusi nello studio avranno specificato per la variabile relativa al farmaco assegnato un valore di ‘D-penicillamine’ o ‘placebo’. I soggetti non inclusi nello studio avranno un valore della variabile uguale a ‘not randomized’. Ma quanti soggetti sono stati assegnati a D-penicillamine, quanti a placebo e quanti non randomizzati? Ddobbiamo considerare la variabile relativa all’assegnazione del farmaco. Ed utilizzare la funzione table() per generare una tabella con le frequenze assolute.\n❗E’ buona norma aggiungere alla tabella dei ‘margini’ dove viene riportata la somma delle frequenze assolute. Per aggiungere i margini utilizziamo la funzione addmargins()\n\nLa variabile relativa all’assegnazione del farmaco è la variabile drug. Per ottenere il nome di tutte le variabili presenti nel dataset considero la funzione colnames(). [1]\nPer richiamare la variabile drug dal dataset non faccio altro che richiamare il nome del dataset (data) seguito dal simbolo $ seguito dal nome della variabile. [2]\nPer generare una tabella coi margini utilizzo la funzione table, seguita dalla funzione addmargins(). Ricorda che si possono concatenare le funzioni Section 18.1.1![3]\n\n\n\nCode\n# [1]\ncolnames(data) # uso la funzione colnames() per vedere i nomi delle colonne: la variabile drug è quella relativa al farmaco\n\n\n [1] \"ID\"           \"entry_date\"   \"bili\"         \"albumin\"      \"stage\"       \n [6] \"protime\"      \"sex\"          \"age\"          \"spiders\"      \"hepatom\"     \n[11] \"ascites\"      \"alk.phos\"     \"sgot\"         \"chol\"         \"trig\"        \n[16] \"platelet\"     \"drug\"         \"edema\"        \"copper\"       \"date_t1\"     \n[21] \"bili_t1\"      \"albumin_t1\"   \"protime_t1\"   \"alk.phos_t1\"  \"platelet_t1\" \n[26] \"copper_t1\"    \"date_t2\"      \"bili_t2\"      \"albumin_t2\"   \"protime_t2\"  \n[31] \"alk.phos_t2\"  \"platelet_t2\"  \"copper_t2\"    \"bili_t3\"      \"albumin_t3\"  \n[36] \"protime_t3\"   \"alk.phos_t3\"  \"platelet_t3\"  \"copper_t3\"    \"fu.days\"     \n[41] \"status\"       \"ast.UL\"       \"gamma.g.g_dL\" \"ibd_0_1\"      \"hepB.ant_0_1\"\n[46] \"mal.cond_0_1\"\n\n\nCode\n#[2]\ndata$drug # richiamo la variabile drug \n\n\n  [1] \"placebo\"         \"placebo\"         \"placebo\"         \"placebo\"        \n  [5] \"D-penicillamine\" \"D-penicillamine\" \"D-penicillamine\" \"D-penicillamine\"\n  [9] \"placebo\"         \"D-penicillamine\" \"D-penicillamine\" \"D-penicillamine\"\n [13] \"D-penicillamine\" \"D-penicillamine\" \"placebo\"         \"D-penicillamine\"\n [17] \"D-penicillamine\" \"placebo\"         \"placebo\"         \"D-penicillamine\"\n [21] \"D-penicillamine\" \"placebo\"         \"D-penicillamine\" \"placebo\"        \n [25] \"D-penicillamine\" \"D-penicillamine\" \"D-penicillamine\" \"D-penicillamine\"\n [29] \"D-penicillamine\" \"D-penicillamine\" \"D-penicillamine\" \"D-penicillamine\"\n [33] \"D-penicillamine\" \"placebo\"         \"D-penicillamine\" \"D-penicillamine\"\n [37] \"placebo\"         \"D-penicillamine\" \"placebo\"         \"placebo\"        \n [41] \"placebo\"         \"D-penicillamine\" \"placebo\"         \"D-penicillamine\"\n [45] \"D-penicillamine\" \"placebo\"         \"D-penicillamine\" \"D-penicillamine\"\n [49] \"D-penicillamine\" \"placebo\"         \"D-penicillamine\" \"placebo\"        \n [53] \"placebo\"         \"placebo\"         \"placebo\"         \"D-penicillamine\"\n [57] \"placebo\"         \"placebo\"         \"placebo\"         \"placebo\"        \n [61] \"D-penicillamine\" \"D-penicillamine\" \"D-penicillamine\" \"D-penicillamine\"\n [65] \"placebo\"         \"placebo\"         \"D-penicillamine\" \"placebo\"        \n [69] \"placebo\"         \"placebo\"         \"D-penicillamine\" \"D-penicillamine\"\n [73] \"D-penicillamine\" \"placebo\"         \"placebo\"         \"placebo\"        \n [77] \"D-penicillamine\" \"placebo\"         \"placebo\"         \"D-penicillamine\"\n [81] \"placebo\"         \"placebo\"         \"placebo\"         \"D-penicillamine\"\n [85] \"D-penicillamine\" \"placebo\"         \"placebo\"         \"D-penicillamine\"\n [89] \"placebo\"         \"placebo\"         \"D-penicillamine\" \"placebo\"        \n [93] \"placebo\"         \"placebo\"         \"D-penicillamine\" \"placebo\"        \n [97] \"D-penicillamine\" \"placebo\"         \"D-penicillamine\" \"D-penicillamine\"\n[101] \"D-penicillamine\" \"placebo\"         \"D-penicillamine\" \"placebo\"        \n[105] \"D-penicillamine\" \"placebo\"         \"D-penicillamine\" \"placebo\"        \n[109] \"D-penicillamine\" \"placebo\"         \"placebo\"         \"D-penicillamine\"\n[113] \"placebo\"         \"D-penicillamine\" \"D-penicillamine\" \"placebo\"        \n[117] \"placebo\"         \"placebo\"         \"placebo\"         \"placebo\"        \n[121] \"D-penicillamine\" \"placebo\"         \"placebo\"         \"placebo\"        \n[125] \"D-penicillamine\" \"placebo\"         \"D-penicillamine\" \"placebo\"        \n[129] \"placebo\"         \"D-penicillamine\" \"D-penicillamine\" \"placebo\"        \n[133] \"D-penicillamine\" \"D-penicillamine\" \"placebo\"         \"placebo\"        \n[137] \"placebo\"         \"placebo\"         \"D-penicillamine\" \"placebo\"        \n[141] \"placebo\"         \"D-penicillamine\" \"D-penicillamine\" \"D-penicillamine\"\n[145] \"D-penicillamine\" \"D-penicillamine\" \"placebo\"         \"D-penicillamine\"\n[149] \"placebo\"         \"D-penicillamine\" \"placebo\"         \"placebo\"        \n[153] \"placebo\"         \"placebo\"         \"D-penicillamine\" \"D-penicillamine\"\n[157] \"D-penicillamine\" \"placebo\"         \"D-penicillamine\" \"D-penicillamine\"\n[161] \"D-penicillamine\" \"D-penicillamine\" \"placebo\"         \"D-penicillamine\"\n[165] \"placebo\"         \"D-penicillamine\" \"placebo\"         \"D-penicillamine\"\n[169] \"D-penicillamine\" \"placebo\"         \"placebo\"         \"D-penicillamine\"\n[173] \"placebo\"         \"placebo\"         \"D-penicillamine\" \"placebo\"        \n[177] \"D-penicillamine\" \"placebo\"         \"D-penicillamine\" \"D-penicillamine\"\n[181] \"placebo\"         \"placebo\"         \"D-penicillamine\" \"D-penicillamine\"\n[185] \"placebo\"         \"placebo\"         \"D-penicillamine\" \"placebo\"        \n[189] \"D-penicillamine\" \"placebo\"         \"D-penicillamine\" \"placebo\"        \n[193] \"D-penicillamine\" \"placebo\"         \"placebo\"         \"placebo\"        \n[197] \"placebo\"         \"D-penicillamine\" \"placebo\"         \"D-penicillamine\"\n[201] \"D-penicillamine\" \"placebo\"         \"D-penicillamine\" \"D-penicillamine\"\n[205] \"placebo\"         \"placebo\"         \"placebo\"         \"placebo\"        \n[209] \"D-penicillamine\" \"D-penicillamine\" \"D-penicillamine\" \"D-penicillamine\"\n[213] \"placebo\"         \"D-penicillamine\" \"D-penicillamine\" \"placebo\"        \n[217] \"D-penicillamine\" \"placebo\"         \"D-penicillamine\" \"placebo\"        \n[221] \"D-penicillamine\" \"D-penicillamine\" \"placebo\"         \"placebo\"        \n[225] \"placebo\"         \"D-penicillamine\" \"placebo\"         \"D-penicillamine\"\n[229] \"placebo\"         \"D-penicillamine\" \"D-penicillamine\" \"placebo\"        \n[233] \"placebo\"         \"D-penicillamine\" \"D-penicillamine\" \"placebo\"        \n[237] \"placebo\"         \"D-penicillamine\" \"placebo\"         \"placebo\"        \n[241] \"D-penicillamine\" \"placebo\"         \"D-penicillamine\" \"placebo\"        \n[245] \"D-penicillamine\" \"placebo\"         \"placebo\"         \"D-penicillamine\"\n[249] \"placebo\"         \"D-penicillamine\" \"placebo\"         \"placebo\"        \n[253] \"placebo\"         \"placebo\"         \"D-penicillamine\" \"placebo\"        \n[257] \"placebo\"         \"placebo\"         \"D-penicillamine\" \"D-penicillamine\"\n[261] \"D-penicillamine\" \"D-penicillamine\" \"D-penicillamine\" \"D-penicillamine\"\n[265] \"D-penicillamine\" \"placebo\"         \"placebo\"         \"placebo\"        \n[269] \"D-penicillamine\" \"placebo\"         \"D-penicillamine\" \"placebo\"        \n[273] \"D-penicillamine\" \"placebo\"         \"placebo\"         \"placebo\"        \n[277] \"D-penicillamine\" \"D-penicillamine\" \"D-penicillamine\" \"placebo\"        \n[281] \"placebo\"         \"D-penicillamine\" \"D-penicillamine\" \"D-penicillamine\"\n[285] \"placebo\"         \"placebo\"         \"placebo\"         \"D-penicillamine\"\n[289] \"placebo\"         \"placebo\"         \"placebo\"         \"D-penicillamine\"\n[293] \"D-penicillamine\" \"placebo\"         \"placebo\"         \"D-penicillamine\"\n[297] \"placebo\"         \"D-penicillamine\" \"placebo\"         \"D-penicillamine\"\n[301] \"D-penicillamine\" \"placebo\"         \"D-penicillamine\" \"placebo\"        \n[305] \"D-penicillamine\" \"D-penicillamine\" \"D-penicillamine\" \"placebo\"        \n[309] \"D-penicillamine\" \"placebo\"         \"placebo\"         \"D-penicillamine\"\n[313] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[317] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[321] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[325] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[329] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[333] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[337] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[341] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[345] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[349] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[353] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[357] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[361] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[365] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[369] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[373] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[377] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[381] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[385] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[389] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[393] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[397] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[401] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[405] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[409] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[413] \"not randomized\"  \"not randomized\"  \"not randomized\"  \"not randomized\" \n[417] \"not randomized\"  \"not randomized\" \n\n\nCode\n#[3]\naddmargins(table(data$drug, useNA = 'always')) # tabella per frequenze assolute farmaco\n\n\n\nD-penicillamine  not randomized         placebo            &lt;NA&gt;             Sum \n            154             106             158               0             418 \n\n\nBONUS!\nPer poter calcolare velocemente le frequenze relative per ogni categoria di farmaco assegnato, possiamo utilizzare la funzione prop.table(). Questa funzione vuole come argomento la tabella che avete appena generato e automaticamente calcola le proporzioni.\n\n\nCode\nprop.table(table(data$drug))\n\n\n\nD-penicillamine  not randomized         placebo \n      0.3684211       0.2535885       0.3779904 \n\n\nOra, di tutti gli ID presenti nel dataset, dobbiamo estrarre solo quelli che sono stati inclusi nello studio. Per fare ciò consideriamo i seguenti comandi:\n\nal vettore relativo agli ID data$ID filtro, attraverso l’utilizzo delle parentesi quadre, solamente quelli associati a dei soggetti che hanno data$drug diverso (!=) a ‘not randomized’. Questi ID vengono salvati in un nuovo vettore ids.rand\n\n\n\nCode\nids.rand = data$ID[data$drug != 'not randomized'] # genero un vettore con solamente gli ID dei inclusi (drug == 'not randomized')\n\n\nOra che ho salvato tutti gli ID dei soggetti inclusi nello studio nel vettore ids.rand, posso ridurre il dataset intero per ottenerne uno dove sono presenti solo i soggetti inclusi. Ovvero, mantengo nel dataset, solamente le righe dei soggetti che hanno un ID presente (%in%) nel vettore ids.rand. Questo dataset ridotto viene salvato come inclusi\n\n\nCode\ninclusi = data[data$ID %in% ids.rand, ] # filtro i soggetti che hanno ID presente nel vettore ids.not\n\ndim(inclusi) # vedo se il numero di righe corrisponde ai 312 soggetti inclusi\n\n\n[1] 312  46\n\n\nCode\n# View(inclusi)\n\n\nUn’altra funzione più semplice da utilizzare è la funzione subset()\nOra non ci resta che considerare se i criteri di inclusione si applicano ai soggetti nel dataset ‘inclusi’\n\n- serum level of aspartate aminotransferase more than 10 times the normal level\nNormal ranges for AST are: \n\nMen: 14 to 20 units/L \nWomen: 10 to 36 units/L \n\n\nPer fare ciò, nella funzione table() inserisco le seguenti condizioni:\n\naspartate aminotransferase (AST) minore o uguale a (&lt;=) 200 se contemporaneamente (&) il soggetto è (==) maschio oppure ( | ) aspartate aminotransferase (AST) minore o uguale a (&lt;=) 360 se contemporaneamente (&) il soggetto è (==) femmina\n\n❗ Il simbolo ‘==’ viene utilizzato per dire ‘equivalente a’, il simbolo ‘=’ viene utilizzato per assegnare e generare nuovi oggetti.\n\n\nCode\ntable(inclusi$ast.UL &lt;= 200 & inclusi$sex == 'male' | \n        inclusi$ast.UL &lt;= 360 & inclusi$sex =='female')\n\n\n\nTRUE \n 312 \n\n\n\n- serum level of aspartate aminotransferase more than 5 times the normal level and gamma globulin more than twice the normal level\nNormal value ranges are:\n\nGamma globulin: 0.7 to 1.6 g/dL or 7 to 16 g/L\n\n\n\n\nCode\ntable(inclusi$ast.UL &lt;= 100 & inclusi$sex == 'male' & inclusi$gamma.g.g_dL &lt;= 3.2 | \n        inclusi$ast.UL &lt;= 180 & inclusi$sex =='female'  & inclusi$gamma.g.g_dL &lt;= 3.2)\n\n\n\nTRUE \n 312 \n\n\nOra tocca a voi!\n\n\n- evidence of inflammatory bowel disease (ibd_0_1)\n- a malignant condition other than skin cancer (mal.con_0_1)\n- evidence of extrahepatic obstruction (extra.hep_0_1)\n- use of cholestatic or epatotoxic drugs or excessive alcohol intake (ex_alch_0_1)\n- presence of hepatitis B surface antigen (cholest_epatotoxic)"
  },
  {
    "objectID": "Stat descrittiva.html#homework",
    "href": "Stat descrittiva.html#homework",
    "title": "Statistica descrittiva e basi di R",
    "section": "Homework 📚",
    "text": "Homework 📚\nProvate a scrivere un programma per individuare quali sono le motivazioni di non inclusione nello studio dei soggetti ‘not randomized’ e a quanti soggetti corrispondono le seguenti motivazioni:\n\n- serum level of aspartate aminotransferase more than 10 times the normal level\n- serum level of aspartate aminotransferase more than 5 times the normal level and gamma globulin more than twice the normal level\n- evidence of inflammatory bowel disease\n- a malignant condition other than skin cancer\n- evidence of extrahepatic obstruction\n- use of cholestatic or epatotoxic drugs or excessive alcohol intake\n- presence of hepatitis B surface antigen\n\nDovreste creare una tabella di questo tipo:\n\n\n\n\n\n\n\n\nMotivazione\nNumero di soggetti non inclusi\nFrequenza relativa (sul numero totale dei non inclusi)\n\n\n\n\nserum level of aspartate aminotransferase more than 10 times the normal level\n\n\n\n\nserum level of aspartate aminotransferase more than 5 times the normal level and gamma globulin more than twice the normal level\n\n\n\n\na malignant condition other than skin cancer\n\n\n\n\nevidence of extrahepatic obstruction\n\n\n\n\nuse of cholestatic or epatotoxic drugs or excessive alcohol intake\n\n\n\n\npresence of hepatitis B surface antigen"
  },
  {
    "objectID": "Studi osservazionali.html",
    "href": "Studi osservazionali.html",
    "title": "Studi osservazionali e misure di associazione",
    "section": "",
    "text": "Code\nlibrary(dplyr)\nlibrary(ggplot2)"
  },
  {
    "objectID": "Studi osservazionali.html#introduzione-agli-studi-osservazionali",
    "href": "Studi osservazionali.html#introduzione-agli-studi-osservazionali",
    "title": "Studi osservazionali e misure di associazione",
    "section": "Introduzione agli Studi Osservazionali",
    "text": "Introduzione agli Studi Osservazionali\n\n1. Cos’è uno studio osservazionale?\nUno studio osservazionale è un tipo di ricerca in cui il ricercatore osserva e registra eventi o comportamenti senza intervenire direttamente. A differenza degli studi sperimentali, dove il ricercatore manipola una variabile (ad esempio somministrando un farmaco o un trattamento), negli studi osservazionali non c’è alcun intervento attivo. Il ricercatore si limita a monitorare l’andamento naturale degli eventi.\nGli studi osservazionali sono particolarmente utili quando sarebbe non etico o impraticabile condurre uno studio sperimentale. Ad esempio, non possiamo chiedere a delle persone di iniziare a fumare per vedere se sviluppano il cancro ai polmoni; tuttavia, possiamo osservare i fumatori e i non fumatori e studiare il rischio di sviluppare la malattia nel corso del tempo.\n\n\n2. Tipologie di studi osservazionali\nEsistono tre principali tipi di studi osservazionali, ciascuno con caratteristiche specifiche:\n\n2.1. Studi di coorte\nNegli studi di coorte, un gruppo di individui (la coorte) viene seguito nel tempo per osservare chi sviluppa una determinata condizione o malattia. Questi individui vengono suddivisi in base alla loro esposizione a un determinato fattore di rischio (ad esempio il fumo), e poi vengono osservati per vedere chi sviluppa l’outcome di interesse (ad esempio il cancro).\n\nEsempio: Si può seguire un gruppo di 1.000 fumatori e non fumatori per 10 anni per determinare chi sviluppa il cancro ai polmoni.\n\nUn altro esempio famoso\nGli studi di coorte possono essere:\n\nProspettici: i partecipanti vengono seguiti nel futuro, dal momento dell’inizio dello studio in avanti.\nRetrospettivi: si utilizzano dati già raccolti in passato, andando a esaminare ciò che è accaduto nel tempo ai partecipanti.\n\nVantaggi:\n\nPossono fornire stime dirette del rischio di malattia associato all’esposizione.\nPermettono di studiare molteplici outcome per una singola esposizione.\n\nLimiti:\n\nSono costosi e richiedono molto tempo, soprattutto per malattie che si sviluppano lentamente.\nPossono soffrire di perdita di partecipanti (attrition) durante il follow-up.\n\n\n\n2.2. Studi caso-controllo\nNegli studi caso-controllo, si confrontano individui che hanno già sviluppato una malattia (i casi) con individui che non hanno la malattia (i controlli), per verificare se vi siano differenze nelle esposizioni passate a determinati fattori di rischio.\n\nEsempio: Si può confrontare un gruppo di persone con infarto (casi) e un gruppo di persone senza infarto (controlli), per verificare se esiste una differenza nell’esposizione a una dieta ricca di grassi tra i due gruppi.\n\nUn altro esempio famoso\nVantaggi:\n\nIdeali per studiare malattie rare o con lunghi periodi di latenza.\nPiù veloci ed economici rispetto agli studi di coorte.\n\nLimiti:\n\nRischio di bias di richiamo: i casi potrebbero ricordare meglio le esposizioni passate rispetto ai controlli.\nNon permettono di calcolare il rischio assoluto, ma solo la odds ratio (rapporto di probabilità).\n\n\n\n2.3. Studi trasversali (cross-sectional)\nGli studi trasversali misurano contemporaneamente l’esposizione e l’outcome in un determinato momento, fornendo una “fotografia” della popolazione in quel preciso istante. Questi studi sono particolarmente utili per stimare la prevalenza di una condizione in una popolazione.\n\nEsempio: Si può condurre uno studio trasversale per valutare la prevalenza dell’obesità tra adulti che praticano attività fisica rispetto a coloro che non lo fanno.\n\nUn altro esempio famoso\nVantaggi:\n\nSono rapidi e relativamente poco costosi.\nUtili per descrivere la distribuzione delle malattie in una popolazione.\n\nLimiti:\n\nNon possono stabilire relazioni causali poiché esposizione e outcome sono misurati contemporaneamente.\nNon permettono di determinare se l’esposizione precede o segue l’outcome.\n\n\n\n\n3. Vantaggi e Limiti degli Studi Osservazionali\nGli studi osservazionali sono essenziali nella ricerca epidemiologica e nella medicina, soprattutto quando esperimenti controllati non sono fattibili o etici. Tuttavia, presentano una serie di limiti che è importante comprendere.\nVantaggi:\n\nEticamente accettabili: Permettono di studiare situazioni in cui non sarebbe etico intervenire (es. esposizioni dannose come il fumo o l’inquinamento).\nFattibili: Sono generalmente più facili da condurre rispetto agli studi sperimentali, richiedono meno risorse e spesso utilizzano dati già disponibili.\nGenerano ipotesi: Forniscono indicazioni preliminari su relazioni tra fattori di rischio e malattie che possono essere successivamente testate in studi sperimentali.\n\nLimiti:\n\nCausalità incerta: Non possono stabilire con certezza un nesso causale tra esposizione e outcome. Ad esempio, se uno studio trasversale mostra che le persone che guardano molta televisione sono più obese, non possiamo dire se la televisione causi l’obesità o se le persone obese tendano a guardare più televisione.\nConfondenti: Spesso è difficile controllare per tutti i fattori confondenti, cioè variabili che potrebbero influenzare sia l’esposizione che l’outcome. Ad esempio, l’età, il sesso o il reddito possono influenzare sia il rischio di malattia che l’esposizione a determinati fattori di rischio.\nBias: Gli studi osservazionali sono particolarmente vulnerabili a diversi tipi di bias (distorsioni), come il bias di selezione (se i partecipanti selezionati non sono rappresentativi della popolazione) e il bias di richiamo (se i partecipanti non ricordano accuratamente le esposizioni passate).\n\n\n\n4. Conclusione\nGli studi osservazionali sono uno strumento fondamentale nella ricerca medica e sociale. Offrono importanti indicazioni sulle associazioni tra fattori di rischio ed esiti di salute, permettendo ai ricercatori di generare ipotesi e di identificare tendenze nella popolazione. Tuttavia, a causa della loro natura non sperimentale, è essenziale interpretare i risultati con cautela, tenendo sempre presente la possibilità di confondenti e bias."
  },
  {
    "objectID": "Studi osservazionali.html#misure-di-associazione-e-loro-interpretazione",
    "href": "Studi osservazionali.html#misure-di-associazione-e-loro-interpretazione",
    "title": "Studi osservazionali e misure di associazione",
    "section": "Misure di Associazione e loro Interpretazione",
    "text": "Misure di Associazione e loro Interpretazione\nQuando conduciamo uno studio epidemiologico per esplorare la relazione tra un’esposizione (ad esempio il fumo) e un outcome di salute (ad esempio il cancro ai polmoni), è fondamentale quantificare l’associazione tra i due. Le misure di associazione ci permettono di comprendere se e quanto un’esposizione aumenta o riduce la probabilità di un determinato esito.\n\n1. Risk Ratio (Rapporto di Rischio o RR)\nIl Risk Ratio (RR), o rapporto di rischio, è una misura di associazione comunemente utilizzata negli studi di coorte. Esprime il rapporto tra il rischio di sviluppare una malattia (o un outcome) nei soggetti esposti a un fattore di rischio e il rischio nei soggetti non esposti.\n\nFormula:\n\\[RR = \\frac{Rischio \\ nei\\ soggetti \\ esposti}{Rischio \\ nei \\ soggetti \\ non \\ esposti}\\]​\n\nRischio: La probabilità che un individuo sviluppi l’outcome (ad esempio una malattia) durante un certo periodo di tempo. Si calcola come:​\n\n\\[Rischio = \\frac{Numero \\ di \\ individui \\ che \\ sviluppano \\ malattia}{Numero \\ totale \\ di \\ individui \\ esposti}\\]\n\n\nInterpretazione:\n\nRR = 1: L’esposizione non modifica il rischio rispetto ai non esposti.\nRR &gt; 1: L’esposizione aumenta il rischio di sviluppare la malattia (es. RR = 2 significa che gli esposti hanno il doppio del rischio di sviluppare la malattia rispetto ai non esposti).\nRR &lt; 1: L’esposizione riduce il rischio di sviluppare la malattia (es. RR = 0.5 indica che gli esposti hanno la metà del rischio di ammalarsi rispetto ai non esposti).\n\n\n\nEsempio:\nIn uno studio di coorte sui fumatori e il cancro ai polmoni, se 10 su 100 fumatori sviluppano il cancro e solo 2 su 100 non fumatori lo sviluppano:\n\\[\nRR = \\frac{10/100}{2/100} = 5\n\\]\nQuesto significa che i fumatori hanno un rischio 5 volte maggiore di sviluppare il cancro ai polmoni rispetto ai non fumatori.\n\n\n\n2. Odds Ratio (OR)\nL’Odds Ratio (OR), o rapporto di probabilità, è la misura più comune negli studi caso-controllo, ma può essere utilizzata anche in studi di coorte. Esprime il rapporto tra le odds (probabilità) di esposizione tra i casi (quelli che hanno sviluppato l’outcome) rispetto ai controlli (quelli che non lo hanno sviluppato).\n\nFormula:\n\\[OR = \\frac{odds \\ di \\ esposizione \\ nei \\ casi }{odds \\ di \\ esposizione \\ nei \\ controlli}\\]​\n\nOdds: La probabilità che un evento si verifichi rispetto alla probabilità che non si verifichi. Si calcola come:\n\n\\[Odds = \\frac{Numero \\  di \\ eventi}{Numero \\  di  \\ non  \\ eventi}\\]​\n\n\nInterpretazione:\n\nOR = 1: Nessuna associazione tra esposizione e outcome.\nOR &gt; 1: L’esposizione è associata a un aumento delle probabilità di sviluppare l’outcome.\nOR &lt; 1: L’esposizione è associata a una riduzione delle probabilità di sviluppare l’outcome.\n\n\n\nEsempio:\nIn uno studio caso-controllo che esamina la relazione tra dieta ricca di grassi e infarto, supponiamo che 30 casi su 50 abbiano avuto una dieta ricca di grassi, mentre tra i controlli solo 10 su 50 lo abbiano fatto:\n\\[\nOR = \\frac{30/20}{10/40} = \\frac{1.5}{0.25} = 6\n\\]\nQuesto significa che coloro che hanno una dieta ricca di grassi hanno 6 volte più probabilità di avere un infarto rispetto a quelli con una dieta a basso contenuto di grassi.\n\n\n\n3. Prevalence Ratio (PR)\nIl Prevalence Ratio (PR) è utilizzato negli studi trasversali (cross-sectional) per confrontare la prevalenza di un outcome tra individui esposti e non esposti a un determinato fattore di rischio. Misura il rapporto tra la prevalenza della malattia negli esposti rispetto ai non esposti.\n\nFormula:\n\\[\nPR = \\frac{Prevalenza \\ negli \\ esposti}{Prevalenza \\  nei \\  non \\ esposti}\n\\]\n\nPrevalenza: La proporzione di individui con una condizione o malattia in un determinato momento. Si calcola come:\n\n\\[\nPrevalenza = \\frac{Numero \\ di \\ casi \\ di \\ malattia}{Numero \\ totale \\ di \\ individui \\ nella \\ popolazione}\n\\]​\n\n\nInterpretazione:\n\nPR = 1: Nessuna differenza nella prevalenza dell’outcome tra esposti e non esposti.\nPR &gt; 1: La prevalenza dell’outcome è maggiore tra gli esposti.\nPR &lt; 1: La prevalenza dell’outcome è minore tra gli esposti.\n\n\n\nEsempio:\nIn uno studio trasversale sulla prevalenza dell’asma tra persone esposte e non esposte a inquinamento, se la prevalenza di asma è del 15% tra gli esposti e del 5% tra i non esposti:\n\\[\nPR = \\frac{0.15}{0.05}= 3\n\\]\nQuesto significa che la prevalenza dell’asma è 3 volte maggiore tra coloro che sono esposti all’inquinamento rispetto a coloro che non lo sono.\n\n\n\n4. Differenze tra Risk Ratio, Odds Ratio e Prevalence Ratio\n\nIl Risk Ratio è utilizzato principalmente negli studi di coorte, dove seguiamo i partecipanti nel tempo e possiamo calcolare il rischio di sviluppare una malattia.\nL’Odds Ratio è comune negli studi caso-controllo, dove non possiamo calcolare il rischio perché la malattia è già presente al momento della raccolta dei dati, quindi usiamo le odds (probabilità) di esposizione.\nIl Prevalence Ratio è specifico degli studi trasversali, dove valutiamo la prevalenza di una condizione in un dato momento, ma non possiamo calcolare il rischio futuro.\n\n\n\nBONUS: Rapporti fra tassi\nIl rate ratio (RR) è utilizzato negli studi longitudinali per confrontare il tasso di un outcome tra individui esposti e non esposti a un determinato fattore di rischio. Misura il rapporto tra tassi di insorgenza della malattia nel tempo negli esposti rispetto ai non esposti.\n\nFormula:\n\\[\nRR = \\frac{Tasso \\ di \\ malattia \\ negli \\ esposti}{Tasso \\ di \\ malattia \\  nei \\  non \\ esposti}\n\\]\n\nTasso di incidenza: Numero di nuovi eventi da t a t + \\(\\Delta t\\) sul totale della massa a rischio in \\(\\Delta\\). Si calcola come:\n\nLa 𝑠𝑜𝑚𝑚𝑎 𝑑𝑒𝑖 𝑡𝑒𝑚𝑝𝑖 𝑑𝑖 𝑒𝑠𝑝𝑜𝑠𝑖𝑧𝑖𝑜𝑛𝑒 𝑎𝑙 𝑟𝑖𝑠𝑐ℎ𝑖𝑜 è denominata «massa a rischio». I tempi da includere nella somma sono: Per i soggetti che si ammalano il tempo che intercorre tra l’inizio dell’osservazione e il tempo in cui è osservata per la prima volta la malattia (t a t + \\(\\Delta t\\) ). Per i soggetti che sono osservati per tutto il periodo da t a t + \\(\\Delta t\\) e che non si sono ammalati il tempo è dato da tutto il periodo (\\(\\Delta\\)) Per i soggetti che non si ammalano ma che sono usciti dall’osservazione per un tempo &lt; \\(\\Delta\\) (persi al follow-up) il tempo da t fino all’ultima osservazione. Questo permette di tenere conto in modo corretto dei soggetti con informazione incompleta. L’unità di misura è persone/tempo​.\n\n\n\nInterpretazione:\n\nRR = 1: Nessuna differenza nella tasso di incidenza dell’outcome tra esposti e non esposti.\nRR &gt; 1: Il tasso di incidenza dell’outcome è maggiore tra gli esposti.\nRR &lt; 1: Il tasso di incidenza dell’outcome è minore tra gli esposti\n\n\n\n\n5. Tabelle di contingenza\nStudio caso-controllo\n\n\nCode\nset.seed(123)\nr = .6\nsim &lt;- rbind(\ndata.frame(outcome = rep(1, 30), exposure = rbinom(30, 1, r) ),\ndata.frame(outcome = rep(0, 60), exposure = rbinom(60, 1, r/2)))\n\ntoString(sim$outcome)\n\n\n[1] \"1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0\"\n\n\nCode\ntoString(sim$exposure)\n\n\n[1] \"1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 1, 0\"\n\n\nCode\ntab&lt;- addmargins(table(ESPOSIZIONE =  sim$exposure, OUTCOME = sim$outcome))\ntab\n\n\n           OUTCOME\nESPOSIZIONE  0  1 Sum\n        0   42 14  56\n        1   18 16  34\n        Sum 60 30  90\n\n\nCode\nOR = (tab[2,2]/tab[1,2])/(tab[2,1]/tab[1,1])\nOR\n\n\n[1] 2.666667\n\n\nCode\ntab&lt;- table(ESPOSIZIONE =  sim$exposure, OUTCOME = sim$outcome)\nptab &lt;- prop.table(tab, margin = 2)\n\nptab\n\n\n           OUTCOME\nESPOSIZIONE         0         1\n          0 0.7000000 0.4666667\n          1 0.3000000 0.5333333\n\n\nCode\nOR = (ptab[2,2]/(1-ptab[2,2]))/(ptab[2,1]/(1-ptab[2,1]))"
  },
  {
    "objectID": "Studi osservazionali.html#curva-roc-e-auc-valutare-lassociazione-tra-una-variabile-continua-e-una-condizione-binaria",
    "href": "Studi osservazionali.html#curva-roc-e-auc-valutare-lassociazione-tra-una-variabile-continua-e-una-condizione-binaria",
    "title": "Studi osservazionali e misure di associazione",
    "section": "Curva ROC e AUC: Valutare l’Associazione tra una Variabile Continua e una Condizione Binaria",
    "text": "Curva ROC e AUC: Valutare l’Associazione tra una Variabile Continua e una Condizione Binaria\n\n1. Introduzione\nQuando abbiamo una variabile numerica continua (ad esempio, livelli di colesterolo nel sangue) e vogliamo capire come questa variabile si associ a una condizione binaria (ad esempio, malato vs non malato), possiamo usare la curva ROC e l’Area Sotto la Curva (AUC) per misurare il potere discriminante della variabile continua. Questo ci permette di valutare quanto bene la variabile predice l’appartenenza a una delle due categorie.\n\n\nCode\nmalati &lt;- rnorm(10000,120,20 )\nsani &lt;-  rnorm(10000, 80, 20)\n\n\ndata.frame(col = c(malati, sani), ty = rep(c('malati', 'sani'), each = 10000)) -&gt; cc\n\n\n\nggplot(cc, aes(col, fill = ty))+geom_density(alpha = .5)+ggthemes::theme_base()+labs(fill = '', x = 'Colesterolo LDL (mg/dL)')\n\n\n\n\n\n\n\n2. Il Problema della Classificazione Basata su una Variabile Continua\nSupponiamo di avere una variabile continua come il livello di colesterolo e di voler capire quanto sia utile questo indicatore per predire la presenza di malattie cardiovascolari (CVD) in un gruppo di pazienti. I pazienti sono classificati come “malati” o “non malati” in base alla presenza o assenza di CVD.\nL’obiettivo è determinare se possiamo usare il livello di colesterolo per distinguere in modo efficace chi svilupperà malattie cardiovascolari e chi no. La curva ROC e l’AUC sono strumenti fondamentali per questo scopo.\n\n\n3. Concetto della Curva ROC per Variabili Continue\nLa curva ROC viene utilizzata per valutare un classificatore, ma in questo caso la variabile continua (ad esempio, il livello di colesterolo) viene trattata come un predittore che può assumere valori diversi. In pratica, impostiamo diverse soglie lungo la variabile continua e a ogni soglia decidiamo se classificare un individuo come “malato” o “non malato”. Per ciascuna soglia:\n\nSe il valore del colesterolo è sopra la soglia, classifichiamo il paziente come “malato”.\nSe il valore è sotto la soglia, il paziente viene classificato come “non malato”.\n\nModificando la soglia, otteniamo una serie di coppie di valori di True Positive Rate (TPR) e False Positive Rate (FPR)che tracciamo sulla curva ROC.\n\n\n4. Calcolo della Curva ROC\n\nModello senza soglia fissa: La variabile continua, come il colesterolo, non ha un valore netto che separa perfettamente i “malati” dai “non malati”. A ogni livello di colesterolo possiamo determinare una soglia diversa per decidere chi è malato.\nTPR e FPR: Per ciascuna soglia di colesterolo:\n\nIl True Positive Rate (TPR) (o sensibilità) è la proporzione di individui malati correttamente identificati come tali.\nIl False Positive Rate (FPR) è la proporzione di individui non malati erroneamente classificati come malati.\n\nCostruzione della curva ROC: Variando la soglia lungo l’intervallo di valori di colesterolo, possiamo tracciare la curva ROC, che rappresenta il compromesso tra TPR e FPR a diverse soglie.\n\n\n\nCode\nt = 80\nlapply(seq(70,200, 1), function(t){\n  \n  TPR &lt;- sum(cc$col&gt;=t & cc$ty == 'malati')/sum(cc$ty == 'malati')\n  FPR &lt;- sum(cc$col&gt;=t & cc$ty == 'sani')/sum(cc$ty == 'sani')\n  \n  data.frame(TPR, FPR)\n  \n})%&gt;%do.call(rbind,.) -&gt; tmp\n\nggplot(tmp, aes(FPR, TPR))+geom_step()+\n  geom_abline(slope = 1, intercept = 0, linetype = 'dotted')+\n  scale_x_continuous(limits = c(0,1))+\n  ggthemes::theme_base()\n\n\n\n\n\n\n\nCode\npar(mfrow = c(2,1))\n\nhist(cc$col[cc$ty == 'malati' & cc$col &gt; 0 & cc$col &lt;=200], breaks = seq(0,200, 10), xlab = 'Total Cholesterol (mg/dL)', main = paste0('Malati (N = ', sum(cc$ty == 'malati' & cc$col &gt; 0 & cc$col &lt;=200), ')'), axes = F)\naxis(1, at = seq(0, 200, 10))\naxis(2)\nabline(v = seq(70, 150, 10), lty = 3, col = 'purple', lwd = 2)\nabline(h = seq(0, 2000, 250), lty = 3, col = 'grey', lwd = 1)\n\n\nhist(cc$col[cc$ty == 'sani' & cc$col &gt; 0 & cc$col &lt;=200], breaks = seq(0,200, 10), xlab = 'Total Cholesterol (mg/dL)', main = paste0('Sani (N = ', sum(cc$ty == 'sani' & cc$col &gt; 0 & cc$col &lt;=200), ')'), axes = F)\naxis(1, at = seq(0, 200, 10))\naxis(2)\nabline(v = seq(70, 150, 10), lty = 3, col = 'purple', lwd = 2)\nabline(h = seq(0, 2000, 250), lty = 3, col = 'grey', lwd = 1)\n\n\n\n\n\n\n\n5. Interpretazione della Curva ROC per Variabili Continue\nLa forma della curva ROC ci dà un’indicazione del potere discriminante della variabile continua:\n\nSe la curva ROC si avvicina all’angolo in alto a sinistra, significa che esiste una soglia di colesterolo in grado di separare molto bene i malati dai non malati, con un TPR alto e un FPR basso.\nSe la curva ROC si avvicina alla diagonale (la linea 45° che va da (0,0) a (1,1)), significa che il colesterolo non è un buon indicatore per distinguere tra malati e non malati; il modello è poco utile perché non discrimina bene tra le due categorie.\n\n\n\n6. Area Sotto la Curva (AUC)\nL’AUC è una singola misura sintetica che quantifica la capacità discriminante della variabile continua rispetto alla condizione binaria.\n\nInterpretazione dell’AUC:\n\nAUC = 1: La variabile continua separa perfettamente malati e non malati, esiste una soglia perfetta.\nAUC = 0.5: La variabile continua è inutile per discriminare tra malati e non malati; il risultato sarebbe equivalente a indovinare a caso.\nAUC &gt; 0.8: La variabile ha una buona capacità di discriminazione.\nAUC = 0.7-0.8: Moderata capacità discriminante.\nAUC &lt; 0.7: Capacità discriminante scarsa.\n\n\n\n\n7. Esempio Pratico: Colesterolo e Malattie Cardiovascolari\nImmaginiamo uno studio che ha raccolto i livelli di colesterolo di 100 pazienti, di cui 50 hanno sviluppato malattie cardiovascolari e 50 no. Vogliamo vedere se i livelli di colesterolo sono un buon indicatore per identificare chi sviluppa malattie.\n\nStep 1: Modellazione della curva ROC: Utilizziamo diversi valori di soglia del colesterolo (ad esempio, 180 mg/dL, 200 mg/dL, 220 mg/dL) per classificare i pazienti. Per ogni soglia, calcoliamo il TPR e il FPR.\nStep 2: Tracciamento della curva ROC: Tracciamo la curva ROC in base ai valori di TPR e FPR per ciascuna soglia. Se la curva sale rapidamente verso l’alto e rimane vicina all’angolo superiore sinistro del grafico, significa che il colesterolo ha un buon potere discriminante.\nStep 3: Calcolo dell’AUC: Se l’AUC risultante è 0.85, possiamo concludere che i livelli di colesterolo hanno una buona capacità di distinguere tra pazienti malati e non malati. Se l’AUC fosse vicina a 0.5, il colesterolo non sarebbe un buon indicatore per prevedere le malattie cardiovascolari.\n\n\n\n8. Vantaggi dell’Uso della Curva ROC per Variabili Continue\n\nValutazione indipendente dalla soglia: La curva ROC permette di valutare il potere discriminante della variabile continua senza dover fissare una soglia specifica.\nConfronto tra variabili: È possibile confrontare diverse variabili (ad esempio, colesterolo vs pressione sanguigna) per vedere quale ha una migliore capacità di predizione, basandosi sull’AUC.\n\n\n\nCode\ntmp$var = 'T Chol'\n\nmalati &lt;- rnorm(10000, 140, 30)\nsani &lt;- rnorm(10000, 110, 30)\n\nps &lt;- data.frame(ps = c(malati, sani), ty = rep(c('malati', 'sani'), each = 10000))\n\nggplot(ps, aes(ps, fill = ty))+geom_density(alpha = .5)+ggthemes::theme_base()+labs(fill = '', x = 'PAS (mmHg)')\n\n\n\n\n\nCode\nlapply(seq(70,200, 1), function(t){\n  \n  TPR &lt;- sum(ps$ps&gt;=t & ps$ty == 'malati')/sum(ps$ty == 'malati')\n  FPR &lt;- sum(ps$ps&gt;=t & ps$ty == 'sani')/sum(ps$ty == 'sani')\n  \n  data.frame(TPR, FPR)\n  \n})%&gt;%do.call(rbind,.) -&gt; tmp2\n\nggplot(tmp2, aes(FPR, TPR))+geom_step()+\n  geom_abline(slope = 1, intercept = 0, linetype = 'dotted')+\n  scale_x_continuous(limits = c(0,1))+\n  ggthemes::theme_base()\n\n\n\n\n\nCode\ntmp2$var &lt;- 'PAS'\n\n\ncompare &lt;- rbind(tmp, tmp2)\n\nggplot(compare%&gt;%filter(FPR &lt;= 0.65), aes(FPR, TPR, col = var))+geom_step()+\n  geom_abline(slope = 1, intercept = 0, linetype = 'dotted')+\n  scale_x_continuous(limits = c(0,1))+\n  labs(col = '', fill = '')+\n  ggthemes::theme_base()+\n  coord_cartesian(xlim = c(0, .67))\n\n\n\n\n\nCode\nggplot(compare%&gt;%filter(FPR &lt;= 0.65), aes(FPR, TPR, col = var))+geom_step(lwd = 2)+\n  geom_abline(slope = 1, intercept = 0, linetype = 'dotted')+\n  scale_x_continuous(limits = c(0,1))+\n  labs(col = '', fill = '')+\n  ggthemes::theme_base()+\n  geom_ribbon(aes(ymin = 0, ymax = TPR, xmin = 0, fill = var), alpha = .2)+\n  coord_cartesian(xlim = c(0, .67))\n\n\n\n\n\nCode\n  #theme(legend.position = 'bottom')\n\n\n\nMisura intuitiva: L’AUC fornisce un’indicazione semplice e facilmente interpretabile della qualità del modello, o in questo caso, della variabile predittiva.\n\n\n\n9. Limiti della Curva ROC per Variabili Continue\n\nSquilibrio tra classi: Se i malati sono molto meno numerosi rispetto ai non malati, la curva ROC può risultare meno utile. In questi casi, la Precision-Recall Curve può essere più informativa.\nInterpretazione pratica della soglia: Sebbene la curva ROC e l’AUC siano utili per valutare la capacità di discriminazione, non forniscono una soglia ottimale per la classificazione. Determinare una soglia specifica richiede ulteriori considerazioni basate su altri parametri, come la prevalenza della malattia o il costo degli errori."
  },
  {
    "objectID": "Survival.html",
    "href": "Survival.html",
    "title": "Statistica Descrittiva - Survival Analysis",
    "section": "",
    "text": "Lo studio di Gehan condotto per confrontare il 6-mercaptopurina (6-MP) con il placebo nel trattamento della leucemia acuta è stato uno studio clinico pionieristico negli anni ’50. L’obiettivo era valutare l’efficacia del 6-MP, un nuovo farmaco, rispetto a un gruppo di controllo trattato con placebo rispetto al tempo alla ricaduta.\nIl disegno prevedeva una fase iniziale in cui un piccolo numero di pazienti affetti da leucemia acuta veniva trattato con 6-MP. In base ai risultati preliminari, lo studio proseguiva se almeno un paziente mostrava segni di miglioramento. Questo approccio rapido consentiva di risparmiare tempo e risorse, focalizzandosi su trattamenti promettenti. Lo studio dimostrò che il 6-MP portava a un miglioramento significativo nei pazienti, confermandone l’efficacia rispetto al placebo.\nQuesto studio è stato un modello per la conduzione di studi clinici successivi in campo oncologico.\n\n\nCode\nlibrary(survival)\nlibrary(MASS)\nlibrary(ggplot2)\n\ndata &lt;- gehan\n\ndata$id &lt;- rownames(data)\n\ndata$id &lt;- forcats::fct_reorder(as.factor(data$id), data$time)\n\nggplot(data, aes(time, id))+facet_grid(rows = vars(treat), scales = 'free')+geom_segment(aes(x = 0, xend = time, y = id, yend = id, col = treat) )+ggthemes::theme_clean()+scale_x_continuous(breaks = scales::pretty_breaks(n = 20))+\n  labs(x = 'Time (months) from the start of the FU', shape = 'status', col = 'Treatment')+\n  theme(panel.grid.major.y = element_blank(), \n        panel.grid.major.x = element_line(color = 'grey', linetype = 'dotted'))"
  },
  {
    "objectID": "Survival.html#il-gehan-study",
    "href": "Survival.html#il-gehan-study",
    "title": "Statistica Descrittiva - Survival Analysis",
    "section": "",
    "text": "Lo studio di Gehan condotto per confrontare il 6-mercaptopurina (6-MP) con il placebo nel trattamento della leucemia acuta è stato uno studio clinico pionieristico negli anni ’50. L’obiettivo era valutare l’efficacia del 6-MP, un nuovo farmaco, rispetto a un gruppo di controllo trattato con placebo rispetto al tempo alla ricaduta.\nIl disegno prevedeva una fase iniziale in cui un piccolo numero di pazienti affetti da leucemia acuta veniva trattato con 6-MP. In base ai risultati preliminari, lo studio proseguiva se almeno un paziente mostrava segni di miglioramento. Questo approccio rapido consentiva di risparmiare tempo e risorse, focalizzandosi su trattamenti promettenti. Lo studio dimostrò che il 6-MP portava a un miglioramento significativo nei pazienti, confermandone l’efficacia rispetto al placebo.\nQuesto studio è stato un modello per la conduzione di studi clinici successivi in campo oncologico.\n\n\nCode\nlibrary(survival)\nlibrary(MASS)\nlibrary(ggplot2)\n\ndata &lt;- gehan\n\ndata$id &lt;- rownames(data)\n\ndata$id &lt;- forcats::fct_reorder(as.factor(data$id), data$time)\n\nggplot(data, aes(time, id))+facet_grid(rows = vars(treat), scales = 'free')+geom_segment(aes(x = 0, xend = time, y = id, yend = id, col = treat) )+ggthemes::theme_clean()+scale_x_continuous(breaks = scales::pretty_breaks(n = 20))+\n  labs(x = 'Time (months) from the start of the FU', shape = 'status', col = 'Treatment')+\n  theme(panel.grid.major.y = element_blank(), \n        panel.grid.major.x = element_line(color = 'grey', linetype = 'dotted'))"
  },
  {
    "objectID": "Survival.html#descrivere-la-sopravvivenza-per-i-bambini-che-non-hanno-ricevuto-6-mp",
    "href": "Survival.html#descrivere-la-sopravvivenza-per-i-bambini-che-non-hanno-ricevuto-6-mp",
    "title": "Statistica Descrittiva - Survival Analysis",
    "section": "Descrivere la sopravvivenza per i bambini che non hanno ricevuto 6-MP",
    "text": "Descrivere la sopravvivenza per i bambini che non hanno ricevuto 6-MP\nSupponiamo di voler descrivere la durata di tempo libero da ricaduta dei bambini che non hanno ricevuto 6-MP. Consideriamo la variabile relativa al tempo di follow-up dei soggetti descritta in mesi raggiunti dall’inizio del follow-up. Questa è una variabile numerica discreta e possiamo quindi utilizzare gli strumenti di statistica descrittiva visti nella scorsa lezione per sintetizzare le informazioni essenziali. Possiamo utilizzare un grafico ‘a canne d’organo’, oppure un boxplot considerando (dato il numero esiguo di osservazioni) anche di rappresentare come punti i singoli tempi per ogni soggetto, ed infine la funzione di distribuzione cumulativa empirica.\n\n\nCode\ntmp &lt;- as.data.frame(table(data$time, data$treat))\ncolnames(tmp) &lt;- c('time', 'treat', 'freq')\nggplot(subset(tmp, treat != '6-MP'), aes(time, freq))+facet_grid(rows = vars(treat))+geom_segment(aes(x = time, xend = time, y = 0, yend = freq),  color = '#00BFC4')+\n  ggthemes::theme_clean()+\n  labs(x = 'Time (months) from the start of the FU',  col = 'Treatment')+\n  geom_vline(xintercept = median(data$time[data$treat != '6-MP']), alpha = .2)\n\n\n\n\n\nCode\nggplot(subset(data, treat != '6-MP'), aes(time))+geom_boxplot(alpha = .8)+\n  ggthemes::theme_clean()+\n  geom_dotplot(size = .5, alpha = .5)+scale_x_continuous(breaks = scales::pretty_breaks(n = 20))\n\n\nWarning in geom_dotplot(size = 0.5, alpha = 0.5): Ignoring unknown parameters:\n`size`\n\n\nBin width defaults to 1/30 of the range of the data. Pick better value with\n`binwidth`.\n\n\n\n\n\nCode\nggplot(subset(data, treat != '6-MP'), aes(time, col = treat))+stat_ecdf(col = '#00BFC4', lwd = 2)+\n  ggthemes::theme_clean()+\n  scale_x_continuous(breaks = scales::pretty_breaks(n = 20))+\n  scale_y_continuous(breaks = scales::pretty_breaks(n = 10), limits = c(0,1))\n\n\n\n\n\nNota bene: la funzione di distribuzione cumulativa mi descrive la probabilità di avere un tempo \\(T \\le t, P(T\\le t)\\). Pertanto rappresenta l’incidenza cumulativa di morte al tempo \\(t\\).\n\n\nCode\nlibrary(dplyr)\n\n\n\nAttaching package: 'dplyr'\n\n\nThe following object is masked from 'package:MASS':\n\n    select\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\n\nCode\nwith(subset(data, treat != '6-MP'), \n     mutate(as.data.frame(table(time)), cum.f = paste(cumsum(Freq), '/', sum(Freq)), cum.inc = round(cumsum(Freq)/sum(Freq),2)))\n\n\n   time Freq   cum.f cum.inc\n1     1    2  2 / 21    0.10\n2     2    2  4 / 21    0.19\n3     3    1  5 / 21    0.24\n4     4    2  7 / 21    0.33\n5     5    2  9 / 21    0.43\n6     8    4 13 / 21    0.62\n7    11    2 15 / 21    0.71\n8    12    2 17 / 21    0.81\n9    15    1 18 / 21    0.86\n10   17    1 19 / 21    0.90\n11   22    1 20 / 21    0.95\n12   23    1 21 / 21    1.00\n\n\n\n\nCode\nlibrary(survival)\n\nf &lt;- survfit(Surv(time, cens)~1, data = subset(data, treat != '6-MP'))\n\ndata.frame(\n  time = c(0,f$time),\n  ci = c(0,1-f$surv)\n  ) -&gt; ci\n\nggplot(subset(data, treat != '6-MP'), aes(time, col = treat))+stat_ecdf(col = '#00BFC4', lwd = 2)+\n  ggthemes::theme_clean()+\n  scale_x_continuous(breaks = scales::pretty_breaks(n = 20))+\n  scale_y_continuous(breaks = scales::pretty_breaks(n = 10), limits = c(0,1))+\n  labs(x = 'Time (months) from the start of the FU', y = 'P(T &lt;= t)')\n\n\n\n\n\nMa come definiamo la sopravvivenza libera da ricaduta ad un determinato tempo \\(t\\)? Semplice! Visto che sappiamo che l’incidenza cumulativa \\(F(t)\\) ad un tempo T (calcolata nel grafico sopra) è uguale a \\(P(T\\le t)\\), la sopravvivenza al tempo \\(t\\) non sarà altro che il complemento di quella probabilità, ovvero: \\(S(t) = 1 - F(t) = 1 - P(T\\le t) = P(T&gt;t)\\)\nNon ci resta allora che fare il complemento della funzione di distribuzione cumulativa ed ecco calcolata la sopravvivenza!\n\n\nCode\nx &lt;- data$time[data$treat != '6-MP']\necdfDIBIC &lt;- function(x, low){\n  \n  x &lt;- as.data.frame(table(x))\n  x$cum.freq &lt;- cumsum(x$Freq)\n  x$perc &lt;- round(x$cum.freq/sum(x$Freq),2)\n  colnames(x)[1] &lt;- 'val'\n  x$val &lt;- as.numeric(as.character(x$val))\n  \n  if(min(x$val, na.rm = T) &gt; low){\n    \n    val = c(low, x$val)\n    perc = c(0, x$perc)\n     data.frame(val, perc)\n  \n  }else{\n    \n    data.frame(x$val, x$perc)\n    \n  }\n  \n \n  \n  \n}\n\n\ne &lt;- ecdfDIBIC(data$time[data$treat != '6-MP'], low = 0)\n\n\nggplot(e, aes(val, 1-perc))+geom_step(col = '#00BFC4', lwd = 2)+\n  ggthemes::theme_clean()+\n  scale_x_continuous(breaks = scales::pretty_breaks(n = 20))+\n  scale_y_continuous(breaks = scales::pretty_breaks(n = 10), limits = c(0,1))+\n  geom_step(inherit.aes = F, data =ci , aes(time, 1-ci), linetype = 'dashed')+\n  labs(x = 'Time (months) from the start of the FU', y = 'P(T &gt; t)', caption = 'Tempo mediano calcolato da noi: 8 \\n tempo mediano riportato nel paper: 8')+\n  geom_segment(y = 0.50, yend = 0.50, x = 0, xend = 8, alpha = .5, col =  '#00BFC4', linetype = 'dashed')+\n  geom_segment(y = 0, yend = 0.50, x = 8, xend = 8, alpha = .5, col =  '#00BFC4', linetype = 'dashed')"
  },
  {
    "objectID": "Survival.html#descrivere-la-sopravvivenza-per-i-bambini-che-hanno-ricevuto-6-mp",
    "href": "Survival.html#descrivere-la-sopravvivenza-per-i-bambini-che-hanno-ricevuto-6-mp",
    "title": "Statistica Descrittiva - Survival Analysis",
    "section": "Descrivere la sopravvivenza per i bambini che hanno ricevuto 6-MP",
    "text": "Descrivere la sopravvivenza per i bambini che hanno ricevuto 6-MP\nProviamo ora a descrivere l’esperienza di sopravvivenza dalla ricaduta dei bambini trattati con 6-MP.\n\n\nCode\nlibrary(survival)\n\nf &lt;- survfit(Surv(time, cens)~1, data = subset(data, treat == '6-MP'))\n\ndata.frame(\n  time = c(0,f$time),\n  ci = c(0, 1-f$surv)\n\n  ) -&gt; ci\n\nggplot(subset(data, treat == '6-MP'), aes(time, col = treat))+stat_ecdf(col = '#F8766D', lwd = 2)+\n  ggthemes::theme_clean()+\n  scale_x_continuous(breaks = scales::pretty_breaks(n = 20))+\n  scale_y_continuous(breaks = scales::pretty_breaks(n = 10), limits = c(0,1))+\n  labs(x = 'Time (months) from the start of the FU', y = 'P(T &lt;= t)')\n\n\n\n\n\n\n\nCode\ne &lt;- ecdfDIBIC(data$time[data$treat == '6-MP'], low = 0)\n\n\nggplot(e, aes(val, 1-perc))+geom_step(col = '#F8766D', lwd = 2)+\n  ggthemes::theme_clean()+\n  scale_x_continuous(breaks = seq(0,36, 1), limits = c(0,36))+\n  scale_y_continuous(breaks = seq(0,1,.05), limits = c(0,1))+\n  geom_step(inherit.aes = F, data =ci , aes(time, 1-ci), linetype = 'dashed')+\n  labs(x = 'Time (months) from the start of the FU', y = 'P(T &gt; t)', caption = 'Tempo mediano calcolato da noi: 16 \\n tempo mediano riportato nel paper: 23')+\n  geom_segment(y = 0.50, yend = 0.50, x = 0, xend = 23, alpha = .5, col = 'grey', linetype = 'dashed')+\n  geom_segment(y = 0, yend = 0.50, x = 23, xend = 23, alpha = .5, col = 'grey', linetype = 'dashed')+\n  geom_segment(y = 0.50, yend = 0.50, x = 0, xend = 16, alpha = .5, col = '#F8766D', linetype = 'dashed')+\n  geom_segment(y = 0, yend = 0.50, x = 16, xend = 16, alpha = .5, col = '#F8766D', linetype = 'dashed')\n\n\n\n\n\nStiamo sottostimando la sopravvivenza (o sovrastimando l’inicidenza di ricaduta) nel gruppo di 6-MP. Come mai?\n\n\nCode\ndata$cens2 &lt;- ifelse(data$cens == 1, 'Ricade', 'Non ricade')\n\nggplot(data, aes(time, id))+facet_grid(rows = vars(treat), scales = 'free')+geom_segment(aes(x = 0, xend = time, y = id, yend = id, col = treat) )+\n  geom_point(aes(time, id, shape = factor(cens2)), size = 2)+\n  ggthemes::theme_clean()+\n  scale_x_continuous(breaks = scales::pretty_breaks(n = 20))+\n  labs(x = 'Time (months) from the start of the FU', shape = 'status', col = 'Treatment')+\n  scale_shape_manual(values = c(1,3))+\n  theme(panel.grid.major.y = element_blank(), \n        panel.grid.major.x = element_line(color = 'grey', linetype = 'dotted'))\n\n\n\n\n\nLa discrepanza si realizza perché non stiamo considerando lo stato dei soggetti ai tempi di follow-up. Mentre il gruppo placebo ha 21/21 eventi di ricaduta durante tutto il follow-up, il gruppo 6-MP ha 9 bambini che hanno ricaduta, mentre restanti i restanti 12 sono liberi da ricaduta ma escono dal follow-up a tempi variabili prima della fine dello studio. Questo fenomeno viene chiamato ‘censura a destra’ ed i soggetti sono definiti censorizzati. Una volta usciti dal follow-up, i soggetti censorizzati non possono essere più considerati a rischio dell’osservazione dell’evento di morte nel follow-up.\nLo stimatore della sopravvivenza di Kaplan e Meier (1958)\n\n\nCode\np &lt;- ggplot(subset(data, treat == '6-MP'), aes(time, id))+geom_segment(aes(x = 0, xend = time, y = id, yend = id, col = treat) )+\n  geom_point(aes(time, id, shape = factor(cens2)), size = 2)+\n  ggthemes::theme_clean()+\n  scale_x_continuous(breaks = scales::pretty_breaks(n = 20))+\n  labs(x = 'Time (months) from the start of the FU', shape = 'status', col = 'Treatment')+\n  scale_shape_manual(values = c(1,3))+\n  theme(panel.grid.major.y = element_blank(), \n        panel.grid.major.x = element_line(color = 'grey', linetype = 'dotted'))+\n  geom_vline(xintercept = data$time[data$treat == '6-MP' & data$cens2 == 'Dead'], alpha = .2, lwd = 2)\n\np\n\n\n\n\n\nCode\nf &lt;- survfit(Surv(time, cens)~1, data = subset(data, treat == '6-MP'))\n\nst &lt;- data.frame(\n  \n  time = c(0,f$time), \n  n.at.risk = c(f$n.risk[1],f$n.risk),\n  n.event = c(0,f$n.event),\n  n.cens = c(0, f$n.censor), \n  cum.hz = c(0,f$cumhaz),\n  ci = c(0, 1-f$surv)\n  \n)\n\n\nst &lt;- mutate(st, hz = cum.hz-lag(cum.hz))\nst$hz &lt;- ifelse(is.na(st$hz), st$cum.hz, st$hz)\nst &lt;- transmute(st, time, n.at.risk, n.event, n.cens, \"d/n\" = round(hz,3), \"1-d/n\" = round(1-hz,3), surv = round(cumprod(1-hz),3), surv.pap = round(1-ci,3) )\n\np+\n  geom_text(inherit.aes = F, data = filter(st), aes(time, y = 22, label = ifelse(n.event !=0,paste0(st$n.event, '/', st$n.at.risk), NA)), size = 2)+\n  coord_cartesian(ylim = c(1, 22))\n\n\nWarning: Use of `st$n.event` is discouraged.\nℹ Use `n.event` instead.\n\n\nWarning: Use of `st$n.at.risk` is discouraged.\nℹ Use `n.at.risk` instead.\n\n\nWarning: Removed 10 rows containing missing values or values outside the scale range\n(`geom_text()`).\n\n\n\n\n\nCode\ngt::gt(st)\n\n\n\n\n\n\n  \n    \n      time\n      n.at.risk\n      n.event\n      n.cens\n      d/n\n      1-d/n\n      surv\n      surv.pap\n    \n  \n  \n    0\n21\n0\n0\n0.000\n1.000\n1.000\n1.000\n    6\n21\n3\n1\n0.143\n0.857\n0.857\n0.857\n    7\n17\n1\n0\n0.059\n0.941\n0.807\n0.807\n    9\n16\n0\n1\n0.000\n1.000\n0.807\n0.807\n    10\n15\n1\n1\n0.067\n0.933\n0.753\n0.753\n    11\n13\n0\n1\n0.000\n1.000\n0.753\n0.753\n    13\n12\n1\n0\n0.083\n0.917\n0.690\n0.690\n    16\n11\n1\n0\n0.091\n0.909\n0.627\n0.627\n    17\n10\n0\n1\n0.000\n1.000\n0.627\n0.627\n    19\n9\n0\n1\n0.000\n1.000\n0.627\n0.627\n    20\n8\n0\n1\n0.000\n1.000\n0.627\n0.627\n    22\n7\n1\n0\n0.143\n0.857\n0.538\n0.538\n    23\n6\n1\n0\n0.167\n0.833\n0.448\n0.448\n    25\n5\n0\n1\n0.000\n1.000\n0.448\n0.448\n    32\n4\n0\n2\n0.000\n1.000\n0.448\n0.448\n    34\n2\n0\n1\n0.000\n1.000\n0.448\n0.448\n    35\n1\n0\n1\n0.000\n1.000\n0.448\n0.448\n  \n  \n  \n\n\n\n\nCode\nggplot(st, aes(time, surv))+geom_step(col = '#F8766D', lwd = 2)+\n  geom_step(aes(time, surv.pap), linetype = 'dashed')+\n  ggthemes::theme_clean()+\n  labs(x = 'Time (months) from the start of the FU', y = 'P(T &gt; t)', caption = 'Tempo mediano calcolato da noi: 23 \\n tempo mediano riportato nel paper: 23')+\n  scale_y_continuous(breaks = seq(0,1,.05), limits = c(0,1))+\n  scale_x_continuous(breaks = seq(0,36,1), limits = c(0,36))+\n   geom_segment(y = 0.50, yend = 0.50, x = 0, xend = 23, alpha = .5, col =  'grey', linetype = 'dashed')+\n  geom_segment(y = 0, yend = 0.50, x = 23, xend = 23, alpha = .5, col =  'grey', linetype = 'dashed')+\n  geom_segment(y = 0.50, yend = 0.50, x = 0, xend = 23, alpha = .5, col =  '#F8766D', linetype = 'dotted')+\n  geom_segment(y = 0, yend = 0.50, x = 23, xend = 23, alpha = .5, col =  '#F8766D', linetype = 'dotted')"
  },
  {
    "objectID": "Survival.html#descrivere-il-tempo-mediano-di-follow-up",
    "href": "Survival.html#descrivere-il-tempo-mediano-di-follow-up",
    "title": "Statistica Descrittiva - Survival Analysis",
    "section": "Descrivere il tempo mediano di follow-up",
    "text": "Descrivere il tempo mediano di follow-up\nPrima o poi vi capiterà, o vi sarà già capitato, di avere a che fare con uno studio che coinvolga la raccolta di dati durante un follow-up, in cui viene misurato il tempo ad un preciso evento e volete dare una misura di sintesi di quanto è durato il follow-up dei pazienti, ovvero per quanto tempo essi sono stati sotto osservazione prima di uscire dal follow-up.\nCome considerare i semplici tempi di evento dimenticandosi dello stato dei soggetti era sbagliato nell’analisi dei tempi all’evento, così lo è nel momento in cui si vuole descrivere il tempo di follow-up. In questo caso siamo interessati a dare una misura della proporzione di pazienti che rimangono sotto osservazione ad un determinato tempo (t) e non escono né per un evento avvenuto né perchè censorizzati a destra.\nN.B: gli indici di centralità non possono essere utilizzati! Dobbiamo utilizzare gli strumenti di analisi della sopravvivenza visti prima.\n\nIl metodo reverse Kaplan-Meier\nIl metodo consiste nel “invertire” lo stato dei soggetti: considerare come “eventi” un evento di censorizzazione (uscita dal follow-up) e come stato di censorizzazione gli eventi avvenuti durante il follow-up. In questo modo possiamo, con i metodi visti prima, la probabilità \\(P(T\\le t)\\) dove t rappresenta ora il tempo di uscita dal follow-up. Di conseguenza possiamo calcolare il complemento a questa probabilità che definisce la probabilità di sopravvivenza all’uscita dal follow-up dei soggetti \\(P(T&gt;t)\\)\nFocalizziamoci sul gruppo di bambini che ha ricevuto 6-MP. Come dicevamo, 9 di questi bambini hanno avuto una ricaduta mentre 12 di questi sono rimasti liberi da evento e sono usciti dal follow-up.\n“Invertendo” lo stato dei soggeti, 9 di questi risulteranno come nuovi soggetti censorizzati a destra, mentre 12 di questi come con evento di uscita dal follow-up.\n\n\nCode\np &lt;- ggplot(subset(data, treat == '6-MP'), aes(time, id))+geom_segment(aes(x = 0, xend = time, y = id, yend = id, col = treat) )+\n  geom_point(aes(time, id, shape = factor(cens2)), size = 2)+\n  ggthemes::theme_clean()+\n  scale_x_continuous(breaks = scales::pretty_breaks(n = 20))+\n  labs(x = 'Time (months) from the start of the FU', shape = 'status', col = 'Treatment')+\n  scale_shape_manual(values = c(1,3))+\n  theme(panel.grid.major.y = element_blank(), \n        panel.grid.major.x = element_line(color = 'grey', linetype = 'dotted'))+\n  geom_vline(xintercept = data$time[data$treat == '6-MP' & data$cens2 == 'Alive'], alpha = .2, lwd = 2)\n\n\nf &lt;- survfit(Surv(time, 1*(cens==0))~1, data = subset(data, treat == '6-MP'))\n\nst &lt;- data.frame(\n  \n  time = c(0,f$time), \n  n.at.risk = c(f$n.risk[1],f$n.risk),\n  n.event = c(0,f$n.event),\n  n.cens = c(0, f$n.censor), \n  cum.hz = c(0,f$cumhaz),\n  ci = c(0, 1-f$surv)\n  \n)\n\n\nst &lt;- mutate(st, hz = cum.hz-lag(cum.hz))\nst$hz &lt;- ifelse(is.na(st$hz), st$cum.hz, st$hz)\nst &lt;- transmute(st, time, n.at.risk, n.event, n.cens, \"d/n\" = round(hz,3), \"1-d/n\" = round(1-hz,3), surv = round(cumprod(1-hz),3), surv.pap = round(1-ci,3) )\n\np+\n  geom_text(inherit.aes = F, data = filter(st), aes(time, y = 22, label = ifelse(n.event !=0,paste0(st$n.event, '/', st$n.at.risk), NA)), size = 2)+\n  coord_cartesian(ylim = c(1, 22))\n\n\nWarning: Use of `st$n.event` is discouraged.\nℹ Use `n.event` instead.\n\n\nWarning: Use of `st$n.at.risk` is discouraged.\nℹ Use `n.at.risk` instead.\n\n\nWarning: Removed 6 rows containing missing values or values outside the scale range\n(`geom_text()`).\n\n\n\n\n\nCode\ngt::gt(st)\n\n\n\n\n\n\n  \n    \n      time\n      n.at.risk\n      n.event\n      n.cens\n      d/n\n      1-d/n\n      surv\n      surv.pap\n    \n  \n  \n    0\n21\n0\n0\n0.000\n1.000\n1.000\n1.000\n    6\n21\n1\n3\n0.048\n0.952\n0.952\n0.952\n    7\n17\n0\n1\n0.000\n1.000\n0.952\n0.952\n    9\n16\n1\n0\n0.062\n0.938\n0.893\n0.893\n    10\n15\n1\n1\n0.067\n0.933\n0.833\n0.833\n    11\n13\n1\n0\n0.077\n0.923\n0.769\n0.769\n    13\n12\n0\n1\n0.000\n1.000\n0.769\n0.769\n    16\n11\n0\n1\n0.000\n1.000\n0.769\n0.769\n    17\n10\n1\n0\n0.100\n0.900\n0.692\n0.692\n    19\n9\n1\n0\n0.111\n0.889\n0.615\n0.615\n    20\n8\n1\n0\n0.125\n0.875\n0.538\n0.538\n    22\n7\n0\n1\n0.000\n1.000\n0.538\n0.538\n    23\n6\n0\n1\n0.000\n1.000\n0.538\n0.538\n    25\n5\n1\n0\n0.200\n0.800\n0.431\n0.431\n    32\n4\n2\n0\n0.500\n0.500\n0.215\n0.215\n    34\n2\n1\n0\n0.500\n0.500\n0.108\n0.108\n    35\n1\n1\n0\n1.000\n0.000\n0.000\n0.000\n  \n  \n  \n\n\n\n\nCode\nggplot(st, aes(time, surv))+geom_step(col = '#F8766D', lwd = 2)+\n  geom_step(aes(time, surv.pap), linetype = 'dashed')+\n  ggthemes::theme_clean()+\n  labs(x = 'Time (months) from the start of the FU', y = 'P(T &gt; t)', caption = 'Tempo mediano calcolato da noi: 25 \\n tempo mediano riportato nel paper: 25')+\n  scale_y_continuous(breaks = seq(0,1,.05), limits = c(0,1))+\n  scale_x_continuous(breaks = seq(0,36,1), limits = c(0,36))+\n   geom_segment(y = 0.50, yend = 0.50, x = 0, xend = 23, alpha = .5, col =  'grey', linetype = 'dashed')+\n  geom_segment(y = 0, yend = 0.50, x = 25, xend = 25, alpha = .5, col =  'grey', linetype = 'dashed')+\n  geom_segment(y = 0.50, yend = 0.50, x = 0, xend = 25, alpha = .5, col =  '#F8766D', linetype = 'dotted')+\n  geom_segment(y = 0, yend = 0.50, x = 25, xend = 25, alpha = .5, col =  '#F8766D', linetype = 'dotted')\n\n\n\n\n\nPotremmo fare la stessa cosa per il gruppo placebo. Chiaramente, il tempo mediano di follow-up può e deve essere calcolato in modo tale che comprenda entrambi i bracci di trattamento. Però farlo separatamente potrebbe riportare informazioni utili. Perchè secondo voi?"
  },
  {
    "objectID": "Senza nome.html",
    "href": "Senza nome.html",
    "title": "Studi osservazionali e misure di associazione",
    "section": "",
    "text": "library(dplyr)\nlibrary(ggplot2)"
  },
  {
    "objectID": "Senza nome.html#introduzione-agli-studi-osservazionali",
    "href": "Senza nome.html#introduzione-agli-studi-osservazionali",
    "title": "Studi osservazionali e misure di associazione",
    "section": "Introduzione agli Studi Osservazionali",
    "text": "Introduzione agli Studi Osservazionali\n\n1. Cos’è uno studio osservazionale?\nUno studio osservazionale è un tipo di ricerca in cui il ricercatore osserva e registra eventi o comportamenti senza intervenire direttamente. A differenza degli studi sperimentali, dove il ricercatore manipola una variabile (ad esempio somministrando un farmaco o un trattamento), negli studi osservazionali non c’è alcun intervento attivo. Il ricercatore si limita a monitorare l’andamento naturale degli eventi.\nGli studi osservazionali sono particolarmente utili quando sarebbe non etico o impraticabile condurre uno studio sperimentale. Ad esempio, non possiamo chiedere a delle persone di iniziare a fumare per vedere se sviluppano il cancro ai polmoni; tuttavia, possiamo osservare i fumatori e i non fumatori e studiare il rischio di sviluppare la malattia nel corso del tempo.\n\n\n2. Tipologie di studi osservazionali\nEsistono tre principali tipi di studi osservazionali, ciascuno con caratteristiche specifiche:\n\n2.1. Studi di coorte\nNegli studi di coorte, un gruppo di individui (la coorte) viene seguito nel tempo per osservare chi sviluppa una determinata condizione o malattia. Questi individui vengono suddivisi in base alla loro esposizione a un determinato fattore di rischio (ad esempio il fumo), e poi vengono osservati per vedere chi sviluppa l’outcome di interesse (ad esempio il cancro).\n\nEsempio: Si può seguire un gruppo di 1.000 fumatori e non fumatori per 10 anni per determinare chi sviluppa il cancro ai polmoni.\n\nUn altro esempio famoso\nGli studi di coorte possono essere:\n\nProspettici: i partecipanti vengono seguiti nel futuro, dal momento dell'inizio dello studio in avanti.\nRetrospettivi: si utilizzano dati già raccolti in passato, andando a esaminare ciò che è accaduto nel tempo ai partecipanti.\n\nVantaggi:\n\nPossono fornire stime dirette del rischio di malattia associato all'esposizione.\nPermettono di studiare molteplici outcome per una singola esposizione.\n\nLimiti:\n\nSono costosi e richiedono molto tempo, soprattutto per malattie che si sviluppano lentamente.\nPossono soffrire di perdita di partecipanti (attrition) durante il follow-up.\n\n\n\n2.2. Studi caso-controllo\nNegli studi caso-controllo, si confrontano individui che hanno già sviluppato una malattia (i casi) con individui che non hanno la malattia (i controlli), per verificare se vi siano differenze nelle esposizioni passate a determinati fattori di rischio.\n\nEsempio: Si può confrontare un gruppo di persone con infarto (casi) e un gruppo di persone senza infarto (controlli), per verificare se esiste una differenza nell’esposizione a una dieta ricca di grassi tra i due gruppi.\n\nUn altro esempio famoso\nVantaggi:\n\nIdeali per studiare malattie rare o con lunghi periodi di latenza.\nPiù veloci ed economici rispetto agli studi di coorte.\n\nLimiti:\n\nRischio di bias di richiamo: i casi potrebbero ricordare meglio le esposizioni passate rispetto ai controlli.\nNon permettono di calcolare il rischio assoluto, ma solo la odds ratio (rapporto di probabilità).\n\n\n\n2.3. Studi trasversali (cross-sectional)\nGli studi trasversali misurano contemporaneamente l'esposizione e l'outcome in un determinato momento, fornendo una “fotografia” della popolazione in quel preciso istante. Questi studi sono particolarmente utili per stimare la prevalenza di una condizione in una popolazione.\n\nEsempio: Si può condurre uno studio trasversale per valutare la prevalenza dell'obesità tra adulti che praticano attività fisica rispetto a coloro che non lo fanno.\n\nUn altro esempio famoso\nVantaggi:\n\nSono rapidi e relativamente poco costosi.\nUtili per descrivere la distribuzione delle malattie in una popolazione.\n\nLimiti:\n\nNon possono stabilire relazioni causali poiché esposizione e outcome sono misurati contemporaneamente.\nNon permettono di determinare se l’esposizione precede o segue l'outcome.\n\n\n\n\n3. Vantaggi e Limiti degli Studi Osservazionali\nGli studi osservazionali sono essenziali nella ricerca epidemiologica e nella medicina, soprattutto quando esperimenti controllati non sono fattibili o etici. Tuttavia, presentano una serie di limiti che è importante comprendere.\nVantaggi:\n\nEticamente accettabili: Permettono di studiare situazioni in cui non sarebbe etico intervenire (es. esposizioni dannose come il fumo o l’inquinamento).\nFattibili: Sono generalmente più facili da condurre rispetto agli studi sperimentali, richiedono meno risorse e spesso utilizzano dati già disponibili.\nGenerano ipotesi: Forniscono indicazioni preliminari su relazioni tra fattori di rischio e malattie che possono essere successivamente testate in studi sperimentali.\n\nLimiti:\n\nCausalità incerta: Non possono stabilire con certezza un nesso causale tra esposizione e outcome. Ad esempio, se uno studio trasversale mostra che le persone che guardano molta televisione sono più obese, non possiamo dire se la televisione causi l’obesità o se le persone obese tendano a guardare più televisione.\nConfondenti: Spesso è difficile controllare per tutti i fattori confondenti, cioè variabili che potrebbero influenzare sia l'esposizione che l'outcome. Ad esempio, l’età, il sesso o il reddito possono influenzare sia il rischio di malattia che l’esposizione a determinati fattori di rischio.\nBias: Gli studi osservazionali sono particolarmente vulnerabili a diversi tipi di bias (distorsioni), come il bias di selezione (se i partecipanti selezionati non sono rappresentativi della popolazione) e il bias di richiamo (se i partecipanti non ricordano accuratamente le esposizioni passate).\n\n\n\n4. Conclusione\nGli studi osservazionali sono uno strumento fondamentale nella ricerca medica e sociale. Offrono importanti indicazioni sulle associazioni tra fattori di rischio ed esiti di salute, permettendo ai ricercatori di generare ipotesi e di identificare tendenze nella popolazione. Tuttavia, a causa della loro natura non sperimentale, è essenziale interpretare i risultati con cautela, tenendo sempre presente la possibilità di confondenti e bias."
  },
  {
    "objectID": "Senza nome.html#misure-di-associazione-e-loro-interpretazione",
    "href": "Senza nome.html#misure-di-associazione-e-loro-interpretazione",
    "title": "Studi osservazionali e misure di associazione",
    "section": "Misure di Associazione e loro Interpretazione",
    "text": "Misure di Associazione e loro Interpretazione\nQuando conduciamo uno studio epidemiologico per esplorare la relazione tra un'esposizione (ad esempio il fumo) e un outcome di salute (ad esempio il cancro ai polmoni), è fondamentale quantificare l’associazione tra i due. Le misure di associazione ci permettono di comprendere se e quanto un'esposizione aumenta o riduce la probabilità di un determinato esito.\n\n1. Risk Ratio (Rapporto di Rischio o RR)\nIl Risk Ratio (RR), o rapporto di rischio, è una misura di associazione comunemente utilizzata negli studi di coorte. Esprime il rapporto tra il rischio di sviluppare una malattia (o un outcome) nei soggetti esposti a un fattore di rischio e il rischio nei soggetti non esposti.\n\nFormula:\n\\[RR = \\frac{Rischio \\ nei\\ soggetti \\ esposti}{Rischio \\ nei \\ soggetti \\ non \\ esposti}\\]​\n\nRischio: La probabilità che un individuo sviluppi l'outcome (ad esempio una malattia) durante un certo periodo di tempo. Si calcola come:​\n\n\\[Rischio = \\frac{Numero \\ di \\ individui \\ che \\ sviluppano \\ malattia}{Numero \\ totale \\ di \\ individui \\ esposti}\\]\n\n\nInterpretazione:\n\nRR = 1: L'esposizione non modifica il rischio rispetto ai non esposti.\nRR &gt; 1: L'esposizione aumenta il rischio di sviluppare la malattia (es. RR = 2 significa che gli esposti hanno il doppio del rischio di sviluppare la malattia rispetto ai non esposti).\nRR &lt; 1: L'esposizione riduce il rischio di sviluppare la malattia (es. RR = 0.5 indica che gli esposti hanno la metà del rischio di ammalarsi rispetto ai non esposti).\n\n\n\nEsempio:\nIn uno studio di coorte sui fumatori e il cancro ai polmoni, se 10 su 100 fumatori sviluppano il cancro e solo 2 su 100 non fumatori lo sviluppano:\n\\[\nRR = \\frac{10/100}{2/100} = 5\n\\]\nQuesto significa che i fumatori hanno un rischio 5 volte maggiore di sviluppare il cancro ai polmoni rispetto ai non fumatori.\n\n\n\n2. Odds Ratio (OR)\nL'Odds Ratio (OR), o rapporto di probabilità, è la misura più comune negli studi caso-controllo, ma può essere utilizzata anche in studi di coorte. Esprime il rapporto tra le odds (probabilità) di esposizione tra i casi (quelli che hanno sviluppato l’outcome) rispetto ai controlli (quelli che non lo hanno sviluppato).\n\nFormula:\n\\[OR = \\frac{odds \\ di \\ esposizione \\ nei \\ casi }{odds \\ di \\ esposizione \\ nei \\ controlli}\\]​\n\nOdds: La probabilità che un evento si verifichi rispetto alla probabilità che non si verifichi. Si calcola come:\n\n\\[Odds = \\frac{Numero \\  di \\ eventi}{Numero \\  di  \\ non  \\ eventi}\\]​\n\n\nInterpretazione:\n\nOR = 1: Nessuna associazione tra esposizione e outcome.\nOR &gt; 1: L'esposizione è associata a un aumento delle probabilità di sviluppare l'outcome.\nOR &lt; 1: L'esposizione è associata a una riduzione delle probabilità di sviluppare l'outcome.\n\n\n\nEsempio:\nIn uno studio caso-controllo che esamina la relazione tra dieta ricca di grassi e infarto, supponiamo che 30 casi su 50 abbiano avuto una dieta ricca di grassi, mentre tra i controlli solo 10 su 50 lo abbiano fatto:\n\\[\nOR = \\frac{30/20}{10/40} = \\frac{1.5}{0.25} = 6\n\\]\nQuesto significa che coloro che hanno una dieta ricca di grassi hanno 6 volte più probabilità di avere un infarto rispetto a quelli con una dieta a basso contenuto di grassi.\n\n\n\n3. Prevalence Ratio (PR)\nIl Prevalence Ratio (PR) è utilizzato negli studi trasversali (cross-sectional) per confrontare la prevalenza di un outcome tra individui esposti e non esposti a un determinato fattore di rischio. Misura il rapporto tra la prevalenza della malattia negli esposti rispetto ai non esposti.\n\nFormula:\n\\[\nPR = \\frac{Prevalenza \\ negli \\ esposti}{Prevalenza \\  nei \\  non \\ esposti}\n\\]\n\nPrevalenza: La proporzione di individui con una condizione o malattia in un determinato momento. Si calcola come:\n\n\\[\nPrevalenza = \\frac{Numero \\ di \\ casi \\ di \\ malattia}{Numero \\ totale \\ di \\ individui \\ nella \\ popolazione}\n\\]​\n\n\nInterpretazione:\n\nPR = 1: Nessuna differenza nella prevalenza dell'outcome tra esposti e non esposti.\nPR &gt; 1: La prevalenza dell'outcome è maggiore tra gli esposti.\nPR &lt; 1: La prevalenza dell'outcome è minore tra gli esposti.\n\n\n\nEsempio:\nIn uno studio trasversale sulla prevalenza dell’asma tra persone esposte e non esposte a inquinamento, se la prevalenza di asma è del 15% tra gli esposti e del 5% tra i non esposti:\n\\[\nPR = \\frac{0.15}{0.05}= 3\n\\]\nQuesto significa che la prevalenza dell’asma è 3 volte maggiore tra coloro che sono esposti all'inquinamento rispetto a coloro che non lo sono.\n\n\n\n4. Differenze tra Risk Ratio, Odds Ratio e Prevalence Ratio\n\nIl Risk Ratio è utilizzato principalmente negli studi di coorte, dove seguiamo i partecipanti nel tempo e possiamo calcolare il rischio di sviluppare una malattia.\nL'Odds Ratio è comune negli studi caso-controllo, dove non possiamo calcolare il rischio perché la malattia è già presente al momento della raccolta dei dati, quindi usiamo le odds (probabilità) di esposizione.\nIl Prevalence Ratio è specifico degli studi trasversali, dove valutiamo la prevalenza di una condizione in un dato momento, ma non possiamo calcolare il rischio futuro.\n\n\n\n5. Tabelle di contingenza\nStudio caso-controllo\n\nset.seed(123)\nr = .6\nsim &lt;- rbind(\ndata.frame(outcome = rep(1, 30), exposure = rbinom(30, 1, r) ),\ndata.frame(outcome = rep(0, 60), exposure = rbinom(60, 1, r/2)))\n\ntoString(sim$outcome)\n\n[1] \"1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0\"\n\ntoString(sim$exposure)\n\n[1] \"1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 1, 0\"\n\ntab&lt;- addmargins(table(ESPOSIZIONE =  sim$exposure, OUTCOME = sim$outcome))\ntab\n\n           OUTCOME\nESPOSIZIONE  0  1 Sum\n        0   42 14  56\n        1   18 16  34\n        Sum 60 30  90\n\nOR = (tab[2,2]/tab[1,2])/(tab[2,1]/tab[1,1])\nOR\n\n[1] 2.666667\n\ntab&lt;- table(ESPOSIZIONE =  sim$exposure, OUTCOME = sim$outcome)\nptab &lt;- prop.table(tab, margin = 2)\n\nptab\n\n           OUTCOME\nESPOSIZIONE         0         1\n          0 0.7000000 0.4666667\n          1 0.3000000 0.5333333\n\nOR = (ptab[2,2]/(1-ptab[2,2]))/(ptab[2,1]/(1-ptab[2,1]))"
  },
  {
    "objectID": "Senza nome.html#curva-roc-e-auc-valutare-lassociazione-tra-una-variabile-continua-e-una-condizione-binaria",
    "href": "Senza nome.html#curva-roc-e-auc-valutare-lassociazione-tra-una-variabile-continua-e-una-condizione-binaria",
    "title": "Studi osservazionali e misure di associazione",
    "section": "Curva ROC e AUC: Valutare l’Associazione tra una Variabile Continua e una Condizione Binaria",
    "text": "Curva ROC e AUC: Valutare l’Associazione tra una Variabile Continua e una Condizione Binaria\n\n1. Introduzione\nQuando abbiamo una variabile numerica continua (ad esempio, livelli di colesterolo nel sangue) e vogliamo capire come questa variabile si associ a una condizione binaria (ad esempio, malato vs non malato), possiamo usare la curva ROC e l’Area Sotto la Curva (AUC) per misurare il potere discriminante della variabile continua. Questo ci permette di valutare quanto bene la variabile predice l'appartenenza a una delle due categorie.\n\nmalati &lt;- rnorm(10000,120,20 )\nsani &lt;-  rnorm(10000, 80, 20)\n\n\ndata.frame(col = c(malati, sani), ty = rep(c('malati', 'sani'), each = 10000)) -&gt; cc\n\n\n\nggplot(cc, aes(col, fill = ty))+geom_density(alpha = .5)+ggthemes::theme_base()+labs(fill = '', x = 'Colesterolo LDL (mg/dL)')\n\n\n\n\n\n\n2. Il Problema della Classificazione Basata su una Variabile Continua\nSupponiamo di avere una variabile continua come il livello di colesterolo e di voler capire quanto sia utile questo indicatore per predire la presenza di malattie cardiovascolari (CVD) in un gruppo di pazienti. I pazienti sono classificati come “malati” o “non malati” in base alla presenza o assenza di CVD.\nL'obiettivo è determinare se possiamo usare il livello di colesterolo per distinguere in modo efficace chi svilupperà malattie cardiovascolari e chi no. La curva ROC e l’AUC sono strumenti fondamentali per questo scopo.\n\n\n3. Concetto della Curva ROC per Variabili Continue\nLa curva ROC viene utilizzata per valutare un classificatore, ma in questo caso la variabile continua (ad esempio, il livello di colesterolo) viene trattata come un predittore che può assumere valori diversi. In pratica, impostiamo diverse soglie lungo la variabile continua e a ogni soglia decidiamo se classificare un individuo come “malato” o “non malato”. Per ciascuna soglia:\n\nSe il valore del colesterolo è sopra la soglia, classifichiamo il paziente come “malato”.\nSe il valore è sotto la soglia, il paziente viene classificato come “non malato”.\n\nModificando la soglia, otteniamo una serie di coppie di valori di True Positive Rate (TPR) e False Positive Rate (FPR)che tracciamo sulla curva ROC.\n\n\n4. Calcolo della Curva ROC\n\nModello senza soglia fissa: La variabile continua, come il colesterolo, non ha un valore netto che separa perfettamente i “malati” dai “non malati”. A ogni livello di colesterolo possiamo determinare una soglia diversa per decidere chi è malato.\nTPR e FPR: Per ciascuna soglia di colesterolo:\n\nIl True Positive Rate (TPR) (o sensibilità) è la proporzione di individui malati correttamente identificati come tali.\nIl False Positive Rate (FPR) è la proporzione di individui non malati erroneamente classificati come malati.\n\nCostruzione della curva ROC: Variando la soglia lungo l’intervallo di valori di colesterolo, possiamo tracciare la curva ROC, che rappresenta il compromesso tra TPR e FPR a diverse soglie.\n\n\nt = 80\nlapply(seq(70,200, 1), function(t){\n  \n  TPR &lt;- sum(cc$col&gt;=t & cc$ty == 'malati')/sum(cc$ty == 'malati')\n  FPR &lt;- sum(cc$col&gt;=t & cc$ty == 'sani')/sum(cc$ty == 'sani')\n  \n  data.frame(TPR, FPR)\n  \n})%&gt;%do.call(rbind,.) -&gt; tmp\n\nggplot(tmp, aes(FPR, TPR))+geom_step()+\n  geom_abline(slope = 1, intercept = 0, linetype = 'dotted')+\n  scale_x_continuous(limits = c(0,1))+\n  ggthemes::theme_base()\n\n\n\n\n\npar(mfrow = c(2,1))\n\nhist(cc$col[cc$ty == 'malati' & cc$col &gt; 0 & cc$col &lt;=200], breaks = seq(0,200, 10), xlab = 'Total Cholesterol (mg/dL)', main = paste0('Malati (N = ', sum(cc$ty == 'malati' & cc$col &gt; 0 & cc$col &lt;=200), ')'), axes = F)\naxis(1, at = seq(0, 200, 10))\naxis(2)\nabline(v = seq(70, 150, 10), lty = 3, col = 'purple', lwd = 2)\nabline(h = seq(0, 2000, 250), lty = 3, col = 'grey', lwd = 1)\n\n\nhist(cc$col[cc$ty == 'sani' & cc$col &gt; 0 & cc$col &lt;=200], breaks = seq(0,200, 10), xlab = 'Total Cholesterol (mg/dL)', main = paste0('Sani (N = ', sum(cc$ty == 'sani' & cc$col &gt; 0 & cc$col &lt;=200), ')'), axes = F)\naxis(1, at = seq(0, 200, 10))\naxis(2)\nabline(v = seq(70, 150, 10), lty = 3, col = 'purple', lwd = 2)\nabline(h = seq(0, 2000, 250), lty = 3, col = 'grey', lwd = 1)\n\n\n\n\n\n\n5. Interpretazione della Curva ROC per Variabili Continue\nLa forma della curva ROC ci dà un’indicazione del potere discriminante della variabile continua:\n\nSe la curva ROC si avvicina all'angolo in alto a sinistra, significa che esiste una soglia di colesterolo in grado di separare molto bene i malati dai non malati, con un TPR alto e un FPR basso.\nSe la curva ROC si avvicina alla diagonale (la linea 45° che va da (0,0) a (1,1)), significa che il colesterolo non è un buon indicatore per distinguere tra malati e non malati; il modello è poco utile perché non discrimina bene tra le due categorie.\n\n\n\n6. Area Sotto la Curva (AUC)\nL’AUC è una singola misura sintetica che quantifica la capacità discriminante della variabile continua rispetto alla condizione binaria.\n\nInterpretazione dell'AUC:\n\nAUC = 1: La variabile continua separa perfettamente malati e non malati, esiste una soglia perfetta.\nAUC = 0.5: La variabile continua è inutile per discriminare tra malati e non malati; il risultato sarebbe equivalente a indovinare a caso.\nAUC &gt; 0.8: La variabile ha una buona capacità di discriminazione.\nAUC = 0.7-0.8: Moderata capacità discriminante.\nAUC &lt; 0.7: Capacità discriminante scarsa.\n\n\n\n\n7. Esempio Pratico: Colesterolo e Malattie Cardiovascolari\nImmaginiamo uno studio che ha raccolto i livelli di colesterolo di 100 pazienti, di cui 50 hanno sviluppato malattie cardiovascolari e 50 no. Vogliamo vedere se i livelli di colesterolo sono un buon indicatore per identificare chi sviluppa malattie.\n\nStep 1: Modellazione della curva ROC: Utilizziamo diversi valori di soglia del colesterolo (ad esempio, 180 mg/dL, 200 mg/dL, 220 mg/dL) per classificare i pazienti. Per ogni soglia, calcoliamo il TPR e il FPR.\nStep 2: Tracciamento della curva ROC: Tracciamo la curva ROC in base ai valori di TPR e FPR per ciascuna soglia. Se la curva sale rapidamente verso l’alto e rimane vicina all’angolo superiore sinistro del grafico, significa che il colesterolo ha un buon potere discriminante.\nStep 3: Calcolo dell'AUC: Se l'AUC risultante è 0.85, possiamo concludere che i livelli di colesterolo hanno una buona capacità di distinguere tra pazienti malati e non malati. Se l'AUC fosse vicina a 0.5, il colesterolo non sarebbe un buon indicatore per prevedere le malattie cardiovascolari.\n\n\n\n8. Vantaggi dell’Uso della Curva ROC per Variabili Continue\n\nValutazione indipendente dalla soglia: La curva ROC permette di valutare il potere discriminante della variabile continua senza dover fissare una soglia specifica.\nConfronto tra variabili: È possibile confrontare diverse variabili (ad esempio, colesterolo vs pressione sanguigna) per vedere quale ha una migliore capacità di predizione, basandosi sull’AUC.\n\n\ntmp$var = 'T Chol'\n\nmalati &lt;- rnorm(10000, 140, 30)\nsani &lt;- rnorm(10000, 110, 30)\n\nps &lt;- data.frame(ps = c(malati, sani), ty = rep(c('malati', 'sani'), each = 10000))\n\nggplot(ps, aes(ps, fill = ty))+geom_density(alpha = .5)+ggthemes::theme_base()+labs(fill = '', x = 'PAS (mmHg)')\n\n\n\nlapply(seq(70,200, 1), function(t){\n  \n  TPR &lt;- sum(ps$ps&gt;=t & ps$ty == 'malati')/sum(ps$ty == 'malati')\n  FPR &lt;- sum(ps$ps&gt;=t & ps$ty == 'sani')/sum(ps$ty == 'sani')\n  \n  data.frame(TPR, FPR)\n  \n})%&gt;%do.call(rbind,.) -&gt; tmp2\n\nggplot(tmp2, aes(FPR, TPR))+geom_step()+\n  geom_abline(slope = 1, intercept = 0, linetype = 'dotted')+\n  scale_x_continuous(limits = c(0,1))+\n  ggthemes::theme_base()\n\n\n\ntmp2$var &lt;- 'PAS'\n\n\ncompare &lt;- rbind(tmp, tmp2)\n\nggplot(compare%&gt;%filter(FPR &lt;= 0.65), aes(FPR, TPR, col = var))+geom_step()+\n  geom_abline(slope = 1, intercept = 0, linetype = 'dotted')+\n  scale_x_continuous(limits = c(0,1))+\n  labs(col = '', fill = '')+\n  ggthemes::theme_base()+\n  coord_cartesian(xlim = c(0, .67))\n\n\n\nggplot(compare%&gt;%filter(FPR &lt;= 0.65), aes(FPR, TPR, col = var))+geom_step(lwd = 2)+\n  geom_abline(slope = 1, intercept = 0, linetype = 'dotted')+\n  scale_x_continuous(limits = c(0,1))+\n  labs(col = '', fill = '')+\n  ggthemes::theme_base()+\n  geom_ribbon(aes(ymin = 0, ymax = TPR, xmin = 0, fill = var), alpha = .2)+\n  coord_cartesian(xlim = c(0, .67))\n\n\n\n  #theme(legend.position = 'bottom')\n\n\nMisura intuitiva: L’AUC fornisce un’indicazione semplice e facilmente interpretabile della qualità del modello, o in questo caso, della variabile predittiva.\n\n\n\n9. Limiti della Curva ROC per Variabili Continue\n\nSquilibrio tra classi: Se i malati sono molto meno numerosi rispetto ai non malati, la curva ROC può risultare meno utile. In questi casi, la Precision-Recall Curve può essere più informativa.\nInterpretazione pratica della soglia: Sebbene la curva ROC e l'AUC siano utili per valutare la capacità di discriminazione, non forniscono una soglia ottimale per la classificazione. Determinare una soglia specifica richiede ulteriori considerazioni basate su altri parametri, come la prevalenza della malattia o il costo degli errori.\n\n\n\n10. Conclusione\nLa curva ROC e l'AUC sono strumenti preziosi per valutare il grado di associazione tra una variabile continua e una condizione binaria. Permettono di vedere quanto bene una variabile (come il colesterolo) possa predire un outcome binario (come lo sviluppo di malattie cardiovascolari), fornendo una rappresentazione visiva delle prestazioni a diverse soglie e una misura sintetica dell’efficacia del predittore. Tuttavia, devono essere interpretati con cautela, specialmente in contesti con classi squilibrate o in cui è necessario identificare una soglia ottimale di classificazione."
  },
  {
    "objectID": "Studi osservazionali.html#esercizio-in-r",
    "href": "Studi osservazionali.html#esercizio-in-r",
    "title": "Studi osservazionali e misure di associazione",
    "section": "ESERCIZIO IN R",
    "text": "ESERCIZIO IN R\nProviamo a calcolare una curva roc con il pacchetto R pROC\n\n\nCode\nlibrary(pROC)\n\n\nType 'citation(\"pROC\")' for a citation.\n\n\n\nAttaching package: 'pROC'\n\n\nThe following objects are masked from 'package:stats':\n\n    cov, smooth, var\n\n\nNel data.frame cc e nel dataset ps troverete i dati relativi al colesterolo totale e alla pressione arteriosa sistolica dei soggetti sani e dei soggetti malati\n\n\nCode\nhead(cc)\n\n\n        col     ty\n1  97.53783 malati\n2 111.94230 malati\n3 110.66689 malati\n4 135.59930 malati\n5 118.33262 malati\n6 125.06637 malati\n\n\nCode\nhead(ps)\n\n\n        ps     ty\n1 159.6206 malati\n2 143.8481 malati\n3 146.2651 malati\n4 146.9330 malati\n5 148.5179 malati\n6 156.0866 malati\n\n\nPer calcolare la curva ROC del colesterolo totale, non faremo altro che utilizzare la funzione roc, inserendo come primo argomento la variabile relativa allo stato dei soggetti, inserita in cc$ty e come secondo argomento la variabile relativa al colesterolo totale cc$col.\n\n\nCode\nr &lt;- roc(cc$ty, cc$col)\n\n\nSetting levels: control = malati, case = sani\n\n\nSetting direction: controls &gt; cases\n\n\nCode\nroc &lt;- data.frame(TPR = r$sensitivities, FPR = 1 - r$specificities )\n\nplot(roc$FPR, roc$TPR, type = 's', lwd = 2, \n     xlab = 'False Positive Rate (FPR)', ylab = 'True Positive Rate (TPR)', \n     main = 'Curva ROC per Colesterolo Totale', \n     sub = paste0('AUC: ', round(r$auc,2)))\nabline(a = 0, b = 1, lty = 3)\n\n\n\n\n\nCode\nr &lt;- roc(ps$ty, ps$ps)\n\n\nSetting levels: control = malati, case = sani\nSetting direction: controls &gt; cases\n\n\nCode\nroc &lt;- data.frame(TPR = r$sensitivities, FPR = 1 - r$specificities )\n\nplot(roc$FPR, roc$TPR, type = 's', lwd = 2, \n     xlab = 'False Positive Rate (FPR)', ylab = 'True Positive Rate (TPR)', \n     main = 'Curva ROC per Pressione Arteriosa Sistolica', \n     sub = paste0('AUC: ', round(r$auc,2)))\nabline(a = 0, b = 1, lty = 3)\n\n\n\n\n\n\n10. Conclusione\nLa curva ROC e l’AUC sono strumenti preziosi per valutare il grado di associazione tra una variabile continua e una condizione binaria. Permettono di vedere quanto bene una variabile (come il colesterolo) possa predire un outcome binario (come lo sviluppo di malattie cardiovascolari), fornendo una rappresentazione visiva delle prestazioni a diverse soglie e una misura sintetica dell’efficacia del predittore. Tuttavia, devono essere interpretati con cautela, specialmente in contesti con classi squilibrate o in cui è necessario identificare una soglia ottimale di classificazione."
  }
]